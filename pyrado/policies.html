

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>policies &mdash; Pyrado 0.2 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="sampling" href="sampling.html" />
    <link rel="prev" title="plotting" href="plotting.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Pyrado
          

          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/1_experiment.html">How to run an experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/2_environment_wrappers.html">How to wrap an environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/3_algorithm.html">How to create an algorithm</a></li>
</ul>
<p class="caption"><span class="caption-text">Package Overview:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="algorithms.html">algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="domain_randomization.html">domain_randomization</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.html">environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.pysim.html">pysim</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.mujoco.html">mujoco</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.rcspysim.html">rcspysim</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.quanser.html">quanser</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment_wrappers.html">environment_wrappers</a></li>
<li class="toctree-l1"><a class="reference internal" href="exploration.html">exploration</a></li>
<li class="toctree-l1"><a class="reference internal" href="logger.html">logger</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">plotting</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">policies</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.adn">adn</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.base">base</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.base_recurrent">base_recurrent</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.domain_distribution">domain_distribution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.dummy">dummy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.environment_specific">environment_specific</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.features">features</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.fnn">fnn</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.initialization">initialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.linear">linear</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.neural_fields">neural_fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.rnn">rnn</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.time">time</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies.two_headed">two_headed</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.policies">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="sampling.html">sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="spaces.html">spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">tests</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Pyrado</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>policies</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/policies.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="policies">
<h1>policies<a class="headerlink" href="#policies" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-pyrado.policies.adn">
<span id="adn"></span><h2>adn<a class="headerlink" href="#module-pyrado.policies.adn" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.policies.adn.ADNPolicy">
<em class="property">class </em><code class="sig-name descname">ADNPolicy</code><span class="sig-paren">(</span><em class="sig-param">spec: pyrado.utils.data_types.EnvSpec, dt: float, activation_nonlin: [typing.Callable, typing.Sequence[typing.Callable]], potentials_dyn_fcn: Callable, obs_layer: [&lt;class 'torch.nn.modules.module.Module'&gt;, &lt;class 'pyrado.policies.base.Policy'&gt;] = None, tau_init: float = 0.1, tau_learnable: bool = True, kappa_init: float = 0.001, kappa_learnable: bool = True, capacity_learnable: bool = True, potential_init_learnable: bool = False, init_param_kwargs: dict = None, use_cuda: bool = False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/adn.html#ADNPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.adn.ADNPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.policies.base_recurrent.RecurrentPolicy" title="pyrado.policies.base_recurrent.RecurrentPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base_recurrent.RecurrentPolicy</span></code></a></p>
<p>Activation Dynamic Network (ADN)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] T. Luksch, M. Gineger, M. Mühlig, T. Yoshiike, “Adaptive Movement Sequences and Predictive Decisions based
on Hierarchical Dynamical Systems”, IROS, 2012</p>
</div>
<dl class="py method">
<dt id="pyrado.policies.adn.ADNPolicy.capacity">
<em class="property">property </em><code class="sig-name descname">capacity</code><a class="headerlink" href="#pyrado.policies.adn.ADNPolicy.capacity" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the capacity parameter (exists for capacity-based dynamics functions), else return <cite>None</cite>.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.adn.ADNPolicy.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rollout</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em>, <em class="sig-param"><span class="n">hidden_states_name</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'hidden_states'</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/adn.html#ADNPolicy.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.adn.ADNPolicy.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-evaluate the given rollout and return a derivable action tensor.
This method makes sure that the gradient is propagated through the hidden state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollout</strong> – complete rollout</p></li>
<li><p><strong>hidden_states_name</strong> – name of hidden states rollout entry, used for recurrent networks.
Change this string for value functions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>actions with gradient data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.adn.ADNPolicy.extra_repr">
<code class="sig-name descname">extra_repr</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="_modules/pyrado/policies/adn.html#ADNPolicy.extra_repr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.adn.ADNPolicy.extra_repr" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the extra representation of the module</p>
<p>To print customized extra information, you should reimplement
this method in your own modules. Both single-line and multi-line
strings are acceptable.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.adn.ADNPolicy.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">obs: torch.Tensor</em>, <em class="sig-param">hidden: torch.Tensor = None) -&gt; (&lt;class 'torch.Tensor'&gt;</em>, <em class="sig-param">&lt;class 'torch.Tensor'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/adn.html#ADNPolicy.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.adn.ADNPolicy.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the goal distance, prediction error, and predicted cost.
Then pass it to the wrapped RNN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> – observations coming from the environment i.e. noisy</p></li>
<li><p><strong>hidden</strong> – current hidden states, in this case action and potentials of the last time step</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>current action and new hidden states</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.adn.ADNPolicy.hidden_size">
<em class="property">property </em><code class="sig-name descname">hidden_size</code><a class="headerlink" href="#pyrado.policies.adn.ADNPolicy.hidden_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of hidden state variables.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.adn.ADNPolicy.init_hidden">
<code class="sig-name descname">init_hidden</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/adn.html#ADNPolicy.init_hidden"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.adn.ADNPolicy.init_hidden" title="Permalink to this definition">¶</a></dt>
<dd><p>Provide initial values for the hidden parameters. This should usually be a zero tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batch_size</strong> – number of states to track in parallel</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tensor of batch_size x hidden_size</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.adn.ADNPolicy.init_param">
<code class="sig-name descname">init_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_values</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/adn.html#ADNPolicy.init_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.adn.ADNPolicy.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.adn.ADNPolicy.kappa">
<em class="property">property </em><code class="sig-name descname">kappa</code><a class="headerlink" href="#pyrado.policies.adn.ADNPolicy.kappa" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the cubic decay parameter (exists for cubic decay-based dynamics functions), else return <cite>None</cite>.</p>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.adn.ADNPolicy.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'adn'</em><a class="headerlink" href="#pyrado.policies.adn.ADNPolicy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.policies.adn.ADNPolicy.potentials">
<em class="property">property </em><code class="sig-name descname">potentials</code><a class="headerlink" href="#pyrado.policies.adn.ADNPolicy.potentials" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the neurons’ potentials.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.adn.ADNPolicy.potentials_dot">
<code class="sig-name descname">potentials_dot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stimuli</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/adn.html#ADNPolicy.potentials_dot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.adn.ADNPolicy.potentials_dot" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the derivative of the neurons’ potentials per time step.
<span class="math notranslate nohighlight">\(/tau /dot{u} = f(u, s, h)\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>stimuli</strong> – sum of external and internal stimuli at the current point in time</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>time derivative of the potentials</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.adn.ADNPolicy.stimuli_external">
<em class="property">property </em><code class="sig-name descname">stimuli_external</code><a class="headerlink" href="#pyrado.policies.adn.ADNPolicy.stimuli_external" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the neurons’ external stimuli, resulting from the current observations.
This is used for recording during a rollout.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.adn.ADNPolicy.stimuli_internal">
<em class="property">property </em><code class="sig-name descname">stimuli_internal</code><a class="headerlink" href="#pyrado.policies.adn.ADNPolicy.stimuli_internal" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the neurons’ internal stimuli, resulting from the previous activations of the neurons.
This is used for recording during a rollout.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.adn.ADNPolicy.tau">
<em class="property">property </em><code class="sig-name descname">tau</code><a class="headerlink" href="#pyrado.policies.adn.ADNPolicy.tau" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the time scale parameter (exists for all potential dynamics functions).</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyrado.policies.adn.pd_capacity_21">
<code class="sig-name descname">pd_capacity_21</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">s</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">h</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">tau</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/adn.html#pd_capacity_21"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.adn.pd_capacity_21" title="Permalink to this definition">¶</a></dt>
<dd><p>Capacity-based dynamics with 2 stable (<span class="math notranslate nohighlight">\(p=-C\)</span>, <span class="math notranslate nohighlight">\(p=C\)</span>) and 1 unstable fix points (<span class="math notranslate nohighlight">\(p=0\)</span>) for <span class="math notranslate nohighlight">\(s=0\)</span></p>
<p><span class="math notranslate nohighlight">\(\tau \dot{p} =  s - (h - p) (1 - \frac{(h - p)^2}{C^2})\)</span></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Intended to be used with sigmoid activation function, e.g. for the position tasks in RcsPySim.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> – potential, higher values lead to higher activations</p></li>
<li><p><strong>s</strong> – stimulus, higher values lead to larger changes of the potentials (depends on the dynamics function)</p></li>
<li><p><strong>h</strong> – resting level, a.k.a. constant offset</p></li>
<li><p><strong>tau</strong> – time scaling factor, higher values lead to slower changes of the potentials (linear dependency)</p></li>
<li><p><strong>kwargs</strong> – additional parameters to the potential dynamics</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.policies.adn.pd_capacity_21_abs">
<code class="sig-name descname">pd_capacity_21_abs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">s</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">h</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">tau</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/adn.html#pd_capacity_21_abs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.adn.pd_capacity_21_abs" title="Permalink to this definition">¶</a></dt>
<dd><p>Capacity-based dynamics with 2 stable (<span class="math notranslate nohighlight">\(p=-C\)</span>, <span class="math notranslate nohighlight">\(p=C\)</span>) and 1 unstable fix points (<span class="math notranslate nohighlight">\(p=0\)</span>) for <span class="math notranslate nohighlight">\(s=0\)</span></p>
<p><span class="math notranslate nohighlight">\(\tau \dot{p} =  s - (h - p) (1 - \frac{\left| h - p \right|}{C})\)</span></p>
<p>The “absolute version” of <cite>pd_capacity_21</cite> has a lower magnitude and a lower oder of the resulting polynomial.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Intended to be used with sigmoid activation function, e.g. for the position tasks in RcsPySim.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> – potential, higher values lead to higher activations</p></li>
<li><p><strong>s</strong> – stimulus, higher values lead to larger changes of the potentials (depends on the dynamics function)</p></li>
<li><p><strong>h</strong> – resting level, a.k.a. constant offset</p></li>
<li><p><strong>tau</strong> – time scaling factor, higher values lead to slower changes of the potentials (linear dependency)</p></li>
<li><p><strong>kwargs</strong> – additional parameters to the potential dynamics</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.policies.adn.pd_capacity_32">
<code class="sig-name descname">pd_capacity_32</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">s</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">h</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">tau</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/adn.html#pd_capacity_32"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.adn.pd_capacity_32" title="Permalink to this definition">¶</a></dt>
<dd><p>Capacity-based dynamics with 3 stable (<span class="math notranslate nohighlight">\(p=-C\)</span>, <span class="math notranslate nohighlight">\(p=0\)</span>, <span class="math notranslate nohighlight">\(p=C\)</span>) and 2 unstable fix points (<span class="math notranslate nohighlight">\(p=-C/2\)</span>, <span class="math notranslate nohighlight">\(p=C/2\)</span>) for <span class="math notranslate nohighlight">\(s=0\)</span></p>
<p><span class="math notranslate nohighlight">\(\tau \dot{p} =  s - (h - p) (1 - \frac{(h - p)^2}{C^2}) (1 - \frac{(2(h - p))^2}{C^2})\)</span></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Intended to be used with tanh activation function, e.g. for the velocity tasks in RcsPySim.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> – potential, higher values lead to higher activations</p></li>
<li><p><strong>s</strong> – stimulus, higher values lead to larger changes of the potentials (depends on the dynamics function)</p></li>
<li><p><strong>h</strong> – resting level, a.k.a. constant offset</p></li>
<li><p><strong>tau</strong> – time scaling factor, higher values lead to slower changes of the potentials (linear dependency)</p></li>
<li><p><strong>kwargs</strong> – additional parameters to the potential dynamics</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.policies.adn.pd_capacity_32_abs">
<code class="sig-name descname">pd_capacity_32_abs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">s</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">h</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">tau</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/adn.html#pd_capacity_32_abs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.adn.pd_capacity_32_abs" title="Permalink to this definition">¶</a></dt>
<dd><p>Capacity-based dynamics with 3 stable (<span class="math notranslate nohighlight">\(p=-C\)</span>, <span class="math notranslate nohighlight">\(p=0\)</span>, <span class="math notranslate nohighlight">\(p=C\)</span>) and 2 unstable fix points (<span class="math notranslate nohighlight">\(p=-C/2\)</span>, <span class="math notranslate nohighlight">\(p=C/2\)</span>) for <span class="math notranslate nohighlight">\(s=0\)</span></p>
<p><span class="math notranslate nohighlight">\(\tau \dot{p} =  \left( s + (h - p) (1 - \frac{\left| (h - p) \right|}{C})
(1 - \frac{2 \left| (h - p) \right|}{C}) \right)\)</span></p>
<p>The “absolute version” of <cite>pd_capacity_32</cite> is less skewed due to a lower oder of the resulting polynomial.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Intended to be used with tanh activation function, e.g. for the velocity tasks in RcsPySim.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> – potential, higher values lead to higher activations</p></li>
<li><p><strong>s</strong> – stimulus, higher values lead to larger changes of the potentials (depends on the dynamics function)</p></li>
<li><p><strong>h</strong> – resting level, a.k.a. constant offset</p></li>
<li><p><strong>tau</strong> – time scaling factor, higher values lead to slower changes of the potentials (linear dependency)</p></li>
<li><p><strong>kwargs</strong> – additional parameters to the potential dynamics</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.policies.adn.pd_cubic">
<code class="sig-name descname">pd_cubic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">s</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">h</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">tau</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/adn.html#pd_cubic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.adn.pd_cubic" title="Permalink to this definition">¶</a></dt>
<dd><p>Basic proportional dynamics with additional cubic decay</p>
<p><span class="math notranslate nohighlight">\(\tau \dot{p} = s + h - p + \kappa (h - p)^3\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> – potential, higher values lead to higher activations</p></li>
<li><p><strong>s</strong> – stimulus, higher values lead to larger changes of the potentials (depends on the dynamics function)</p></li>
<li><p><strong>h</strong> – resting level, a.k.a. constant offset</p></li>
<li><p><strong>tau</strong> – time scaling factor, higher values lead to slower changes of the potentials (linear dependency)</p></li>
<li><p><strong>kwargs</strong> – additional parameters to the potential dynamics</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.policies.adn.pd_linear">
<code class="sig-name descname">pd_linear</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">p</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">s</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">h</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">tau</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/adn.html#pd_linear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.adn.pd_linear" title="Permalink to this definition">¶</a></dt>
<dd><p>Basic proportional dynamics</p>
<p><span class="math notranslate nohighlight">\(\tau \dot{p} = s - p\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p</strong> – potential, higher values lead to higher activations</p></li>
<li><p><strong>s</strong> – stimulus, higher values lead to larger changes of the potentials (depends on the dynamics function)</p></li>
<li><p><strong>h</strong> – resting level, a.k.a. constant offset</p></li>
<li><p><strong>tau</strong> – time scaling factor, higher values lead to slower changes of the potentials (linear dependency)</p></li>
<li><p><strong>kwargs</strong> – additional parameters to the potential dynamics</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrado.policies.base">
<span id="base"></span><h2>base<a class="headerlink" href="#module-pyrado.policies.base" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.policies.base.Policy">
<em class="property">class </em><code class="sig-name descname">Policy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/base.html#Policy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base.Policy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Base class for all policies in Pyrado</p>
<dl class="py method">
<dt id="pyrado.policies.base.Policy.device">
<em class="property">property </em><code class="sig-name descname">device</code><a class="headerlink" href="#pyrado.policies.base.Policy.device" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the device (CPU or GPU) on which the policy is stored.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base.Policy.env_spec">
<em class="property">property </em><code class="sig-name descname">env_spec</code><a class="headerlink" href="#pyrado.policies.base.Policy.env_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the specification of environment the policy acts in.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base.Policy.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rollout</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em>, <em class="sig-param"><span class="n">hidden_states_name</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'hidden_states'</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/base.html#Policy.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base.Policy.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-evaluate the given rollout and return a derivable action tensor.
The default implementation simply calls <cite>forward()</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollout</strong> – complete rollout</p></li>
<li><p><strong>hidden_states_name</strong> – name of hidden states rollout entry, used for recurrent networks.
Defaults to ‘hidden_states’. Change for value functions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>actions with gradient data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base.Policy.forward">
<em class="property">abstract </em><code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; [&lt;class ‘torch.Tensor’&gt;, (&lt;class ‘torch.Tensor’&gt;, &lt;class ‘torch.Tensor’&gt;)]<a class="reference internal" href="_modules/pyrado/policies/base.html#Policy.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base.Policy.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action according to the policy and the observations (forward pass).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – observation from the environment</p>
</dd>
<dt class="field-even">Return act</dt>
<dd class="field-even"><p>action to be taken</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base.Policy.init_hidden">
<code class="sig-name descname">init_hidden</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/base.html#Policy.init_hidden"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base.Policy.init_hidden" title="Permalink to this definition">¶</a></dt>
<dd><p>Provide initial values for the hidden parameters. This should usually be a zero tensor.
The default implementation will raise an error, to enforce override this function for recurrent policies.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batch_size</strong> – number of states to track in parallel</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tensor of batch_size x hidden_size</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base.Policy.init_param">
<em class="property">abstract </em><code class="sig-name descname">init_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_values</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/base.html#Policy.init_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base.Policy.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base.Policy.is_recurrent">
<em class="property">property </em><code class="sig-name descname">is_recurrent</code><a class="headerlink" href="#pyrado.policies.base.Policy.is_recurrent" title="Permalink to this definition">¶</a></dt>
<dd><p>Bool to signalise it the policy has a recurrent architecture.</p>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.base.Policy.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = None</em><a class="headerlink" href="#pyrado.policies.base.Policy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base.Policy.num_param">
<em class="property">property </em><code class="sig-name descname">num_param</code><a class="headerlink" href="#pyrado.policies.base.Policy.num_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of policy parameters.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base.Policy.param_grad">
<em class="property">property </em><code class="sig-name descname">param_grad</code><a class="headerlink" href="#pyrado.policies.base.Policy.param_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the gradient of the parameters as 1d array.
The values are copied, modifying the return value does not propagate to the actual policy parameters.
However, setting this variable will change the gradient.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base.Policy.param_values">
<em class="property">property </em><code class="sig-name descname">param_values</code><a class="headerlink" href="#pyrado.policies.base.Policy.param_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the parameters of the policy as 1d array.
The values are copied, modifying the return value does not propagate to the actual policy parameters.
However, setting this variable will change the parameters.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base.Policy.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/base.html#Policy.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base.Policy.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the policy to it’s initial state.
This should be called at the start of a rollout. Stateful policies should use it to reset the state variables.
The default implementation does nothing.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base.Policy.script">
<code class="sig-name descname">script</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; torch.jit.ScriptModule<a class="reference internal" href="_modules/pyrado/policies/base.html#Policy.script"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base.Policy.script" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a ScriptModule from this policy.
The returned module will always have the signature <cite>action = tm(observation)</cite>.
For recurrent networks, it returns a stateful module that keeps the hidden states internally.
Such modules have a reset() method to reset the hidden states.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.base.TracedPolicyWrapper">
<em class="property">class </em><code class="sig-name descname">TracedPolicyWrapper</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">module</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/base.html#TracedPolicyWrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base.TracedPolicyWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Wrapper for a traced policy. Mainly used to add <cite>input_size</cite> and <cite>output_size</cite> attributes.</p>
<dl class="py method">
<dt id="pyrado.policies.base.TracedPolicyWrapper.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/base.html#TracedPolicyWrapper.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base.TracedPolicyWrapper.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.base.TracedPolicyWrapper.input_size">
<code class="sig-name descname">input_size</code><em class="property">: int</em><a class="headerlink" href="#pyrado.policies.base.TracedPolicyWrapper.input_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.base.TracedPolicyWrapper.output_size">
<code class="sig-name descname">output_size</code><em class="property">: int</em><a class="headerlink" href="#pyrado.policies.base.TracedPolicyWrapper.output_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.policies.base_recurrent">
<span id="base-recurrent"></span><h2>base_recurrent<a class="headerlink" href="#module-pyrado.policies.base_recurrent" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.policies.base_recurrent.RecurrentPolicy">
<em class="property">class </em><code class="sig-name descname">RecurrentPolicy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/base_recurrent.html#RecurrentPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base_recurrent.RecurrentPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Base class for recurrent policies.
The policy does not store the hidden state on it’s own, so it requires two arguments: (observation, hidden) and
returns two values: (action, new_hidden).
The hidden tensor is an 1-dim vector of state variables with unspecified meaning. In the batching case,
it should be a 2-dim array, where the first dimension is the batch size matching that of the observations.</p>
<dl class="py method">
<dt id="pyrado.policies.base_recurrent.RecurrentPolicy.evaluate">
<em class="property">abstract </em><code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rollout</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em>, <em class="sig-param"><span class="n">hidden_states_name</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'hidden_states'</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/base_recurrent.html#RecurrentPolicy.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base_recurrent.RecurrentPolicy.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-evaluate the given rollout and return a derivable action tensor.
This method makes sure that the gradient is propagated through the hidden state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollout</strong> – complete rollout</p></li>
<li><p><strong>hidden_states_name</strong> – name of hidden states rollout entry, used for recurrent networks.
Change this string for value functions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>actions with gradient data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base_recurrent.RecurrentPolicy.forward">
<em class="property">abstract </em><code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">obs: torch.Tensor</em>, <em class="sig-param">hidden: torch.Tensor = None) -&gt; (&lt;class 'torch.Tensor'&gt;</em>, <em class="sig-param">&lt;class 'torch.Tensor'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/base_recurrent.html#RecurrentPolicy.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base_recurrent.RecurrentPolicy.forward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> – observation from the environment</p></li>
<li><p><strong>hidden</strong> – the network’s hidden state. If None, use init_hidden()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>action to be taken and new hidden state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base_recurrent.RecurrentPolicy.hidden_size">
<em class="property">abstract property </em><code class="sig-name descname">hidden_size</code><a class="headerlink" href="#pyrado.policies.base_recurrent.RecurrentPolicy.hidden_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of hidden state variables.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base_recurrent.RecurrentPolicy.init_hidden">
<code class="sig-name descname">init_hidden</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/base_recurrent.html#RecurrentPolicy.init_hidden"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base_recurrent.RecurrentPolicy.init_hidden" title="Permalink to this definition">¶</a></dt>
<dd><p>Provide initial values for the hidden parameters. This should usually be a zero tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batch_size</strong> – number of states to track in parallel</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tensor of batch_size x hidden_size</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base_recurrent.RecurrentPolicy.is_recurrent">
<em class="property">property </em><code class="sig-name descname">is_recurrent</code><a class="headerlink" href="#pyrado.policies.base_recurrent.RecurrentPolicy.is_recurrent" title="Permalink to this definition">¶</a></dt>
<dd><p>Bool to signalise it the policy has a recurrent architecture.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base_recurrent.RecurrentPolicy.script">
<code class="sig-name descname">script</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; torch.jit.ScriptModule<a class="reference internal" href="_modules/pyrado/policies/base_recurrent.html#RecurrentPolicy.script"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base_recurrent.RecurrentPolicy.script" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a ScriptModule from this policy.
The returned module will always have the signature <cite>action = tm(observation, hidden)</cite>.
For recurrent networks, it returns a stateful module that keeps the hidden states internally.
Such modules have a <cite>reset()</cite> method to reset the hidden states.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.base_recurrent.StatefulRecurrentNetwork">
<em class="property">class </em><code class="sig-name descname">StatefulRecurrentNetwork</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">net</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#pyrado.policies.base_recurrent.RecurrentPolicy" title="pyrado.policies.base_recurrent.RecurrentPolicy">pyrado.policies.base_recurrent.RecurrentPolicy</a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/base_recurrent.html#StatefulRecurrentNetwork"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base_recurrent.StatefulRecurrentNetwork" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>A scripted wrapper for a recurrent neural network that stores the hidden state.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Use this for transfer to C++.</p>
</div>
<dl class="py method">
<dt id="pyrado.policies.base_recurrent.StatefulRecurrentNetwork.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/base_recurrent.html#StatefulRecurrentNetwork.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base_recurrent.StatefulRecurrentNetwork.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.base_recurrent.StatefulRecurrentNetwork.input_size">
<code class="sig-name descname">input_size</code><em class="property">: int</em><a class="headerlink" href="#pyrado.policies.base_recurrent.StatefulRecurrentNetwork.input_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.base_recurrent.StatefulRecurrentNetwork.output_size">
<code class="sig-name descname">output_size</code><em class="property">: int</em><a class="headerlink" href="#pyrado.policies.base_recurrent.StatefulRecurrentNetwork.output_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.policies.base_recurrent.StatefulRecurrentNetwork.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/base_recurrent.html#StatefulRecurrentNetwork.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.base_recurrent.StatefulRecurrentNetwork.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the hidden states.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.policies.domain_distribution">
<span id="domain-distribution"></span><h2>domain_distribution<a class="headerlink" href="#module-pyrado.policies.domain_distribution" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.policies.domain_distribution.DomainDistrParamPolicy">
<em class="property">class </em><code class="sig-name descname">DomainDistrParamPolicy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mapping</span><span class="p">:</span> <span class="n">Dict<span class="p">[</span>int<span class="p">, </span>Tuple<span class="p">[</span>str<span class="p">, </span>str<span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">trafo_mask</span><span class="p">:</span> <span class="n">list</span></em>, <em class="sig-param"><span class="n">prior</span><span class="p">:</span> <span class="n"><a class="reference internal" href="domain_randomization.html#pyrado.domain_randomization.domain_randomizer.DomainRandomizer" title="pyrado.domain_randomization.domain_randomizer.DomainRandomizer">pyrado.domain_randomization.domain_randomizer.DomainRandomizer</a></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">scale_params</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/domain_distribution.html#DomainDistrParamPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.domain_distribution.DomainDistrParamPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a></p>
<p>A proxy to the Policy class in order to use the policy’s parameters as domain distribution parameters</p>
<dl class="py method">
<dt id="pyrado.policies.domain_distribution.DomainDistrParamPolicy.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/domain_distribution.html#DomainDistrParamPolicy.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.domain_distribution.DomainDistrParamPolicy.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action according to the policy and the observations (forward pass).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – observation from the environment</p>
</dd>
<dt class="field-even">Return act</dt>
<dd class="field-even"><p>action to be taken</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.domain_distribution.DomainDistrParamPolicy.init_param">
<code class="sig-name descname">init_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_values</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/domain_distribution.html#DomainDistrParamPolicy.init_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.domain_distribution.DomainDistrParamPolicy.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.domain_distribution.DomainDistrParamPolicy.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'ddp'</em><a class="headerlink" href="#pyrado.policies.domain_distribution.DomainDistrParamPolicy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.policies.domain_distribution.DomainDistrParamPolicy.transform_to_ddp_space">
<code class="sig-name descname">transform_to_ddp_space</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/domain_distribution.html#DomainDistrParamPolicy.transform_to_ddp_space"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.domain_distribution.DomainDistrParamPolicy.transform_to_ddp_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the transformed domain distribution parameters. The policy’s parameters are in log space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> – policy parameters (can be the log of the actual domain distribution parameter value)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>policy parameters transformed according to the mask</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.policies.dummy">
<span id="dummy"></span><h2>dummy<a class="headerlink" href="#module-pyrado.policies.dummy" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.policies.dummy.DummyPolicy">
<em class="property">class </em><code class="sig-name descname">DummyPolicy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/dummy.html#DummyPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.dummy.DummyPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a></p>
<p>Simple policy which samples random values form the action space</p>
<dl class="py method">
<dt id="pyrado.policies.dummy.DummyPolicy.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/dummy.html#DummyPolicy.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.dummy.DummyPolicy.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action according to the policy and the observations (forward pass).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – observation from the environment</p>
</dd>
<dt class="field-even">Return act</dt>
<dd class="field-even"><p>action to be taken</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.dummy.DummyPolicy.init_param">
<code class="sig-name descname">init_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_values</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/dummy.html#DummyPolicy.init_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.dummy.DummyPolicy.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.dummy.DummyPolicy.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'dummy'</em><a class="headerlink" href="#pyrado.policies.dummy.DummyPolicy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.dummy.IdlePolicy">
<em class="property">class </em><code class="sig-name descname">IdlePolicy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/dummy.html#IdlePolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.dummy.IdlePolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a></p>
<p>The most simple policy which simply does nothing</p>
<dl class="py method">
<dt id="pyrado.policies.dummy.IdlePolicy.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/dummy.html#IdlePolicy.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.dummy.IdlePolicy.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action according to the policy and the observations (forward pass).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – observation from the environment</p>
</dd>
<dt class="field-even">Return act</dt>
<dd class="field-even"><p>action to be taken</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.dummy.IdlePolicy.init_param">
<code class="sig-name descname">init_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_values</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/dummy.html#IdlePolicy.init_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.dummy.IdlePolicy.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.dummy.IdlePolicy.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'idle'</em><a class="headerlink" href="#pyrado.policies.dummy.IdlePolicy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.dummy.RecurrentDummyPolicy">
<em class="property">class </em><code class="sig-name descname">RecurrentDummyPolicy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">hidden_size</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/dummy.html#RecurrentDummyPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.dummy.RecurrentDummyPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.policies.base_recurrent.RecurrentPolicy" title="pyrado.policies.base_recurrent.RecurrentPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base_recurrent.RecurrentPolicy</span></code></a></p>
<p>Simple recurrent policy which samples random values form the action space and
always returns hidden states with value zero</p>
<dl class="py method">
<dt id="pyrado.policies.dummy.RecurrentDummyPolicy.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rollout</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em>, <em class="sig-param"><span class="n">hidden_states_name</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'hidden_states'</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/dummy.html#RecurrentDummyPolicy.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.dummy.RecurrentDummyPolicy.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-evaluate the given rollout and return a derivable action tensor.
This method makes sure that the gradient is propagated through the hidden state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollout</strong> – complete rollout</p></li>
<li><p><strong>hidden_states_name</strong> – name of hidden states rollout entry, used for recurrent networks.
Change this string for value functions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>actions with gradient data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.dummy.RecurrentDummyPolicy.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">obs: torch.Tensor = None</em>, <em class="sig-param">hidden: torch.Tensor = None) -&gt; (&lt;class 'torch.Tensor'&gt;</em>, <em class="sig-param">&lt;class 'torch.Tensor'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/dummy.html#RecurrentDummyPolicy.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.dummy.RecurrentDummyPolicy.forward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> – observation from the environment</p></li>
<li><p><strong>hidden</strong> – the network’s hidden state. If None, use init_hidden()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>action to be taken and new hidden state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.dummy.RecurrentDummyPolicy.hidden_size">
<em class="property">property </em><code class="sig-name descname">hidden_size</code><a class="headerlink" href="#pyrado.policies.dummy.RecurrentDummyPolicy.hidden_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of hidden state variables.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.dummy.RecurrentDummyPolicy.init_param">
<code class="sig-name descname">init_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_values</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/dummy.html#RecurrentDummyPolicy.init_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.dummy.RecurrentDummyPolicy.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.dummy.RecurrentDummyPolicy.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'rec_cummy'</em><a class="headerlink" href="#pyrado.policies.dummy.RecurrentDummyPolicy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.policies.environment_specific">
<span id="environment-specific"></span><h2>environment_specific<a class="headerlink" href="#module-pyrado.policies.environment_specific" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.policies.environment_specific.DualRBFLinearPolicy">
<em class="property">class </em><code class="sig-name descname">DualRBFLinearPolicy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">rbf_hparam</span><span class="p">:</span> <span class="n">dict</span></em>, <em class="sig-param"><span class="n">dim_mask</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">2</span></em>, <em class="sig-param"><span class="n">init_param_kwargs</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/environment_specific.html#DualRBFLinearPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.environment_specific.DualRBFLinearPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.policies.linear.LinearPolicy" title="pyrado.policies.linear.LinearPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.linear.LinearPolicy</span></code></a></p>
<p>A linear policy with RBF features which are also used to get the derivative of the features. The use-case in mind
is a simple policy which generates the joint position and joint velocity commands for the internal PD-controller
of a robot (e.g. Barrett WAM). By re-using the RBF, we reduce the number of parameters, while we can at the same
time get the velocity information from the features, i.e. the derivative of the normalized Gaussians.</p>
<dl class="py method">
<dt id="pyrado.policies.environment_specific.DualRBFLinearPolicy.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/environment_specific.html#DualRBFLinearPolicy.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.environment_specific.DualRBFLinearPolicy.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the features at the given observation or use given feature values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – observations from the environment</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>actions</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.environment_specific.DualRBFLinearPolicy.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'dualrbf'</em><a class="headerlink" href="#pyrado.policies.environment_specific.DualRBFLinearPolicy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.environment_specific.QBallBalancerPDCtrl">
<em class="property">class </em><code class="sig-name descname">QBallBalancerPDCtrl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env_spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">state_des</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">tensor([0.0, 0.0])</span></em>, <em class="sig-param"><span class="n">kp</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">kd</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/environment_specific.html#QBallBalancerPDCtrl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.environment_specific.QBallBalancerPDCtrl" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a></p>
<p>PD-controller for the Quanser Ball Balancer.
The only but significant difference of this controller to the other PD controller is the clipping of the actions.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This class’s desired state specification deviates from the Pyrado policies which interact with a <cite>Task</cite>.</p>
</div>
<dl class="py method">
<dt id="pyrado.policies.environment_specific.QBallBalancerPDCtrl.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/environment_specific.html#QBallBalancerPDCtrl.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.environment_specific.QBallBalancerPDCtrl.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the controller output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – observation from the environment</p>
</dd>
<dt class="field-even">Return act</dt>
<dd class="field-even"><p>controller output [V]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.environment_specific.QBallBalancerPDCtrl.init_param">
<code class="sig-name descname">init_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">kp</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">kd</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/environment_specific.html#QBallBalancerPDCtrl.init_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.environment_specific.QBallBalancerPDCtrl.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize controller parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>kp</strong> – 2x2 tensor of constant controller feedback coefficients for error [V/m]</p></li>
<li><p><strong>kd</strong> – 2x2 tensor of constant controller feedback coefficients for error time derivative [Vs/m]</p></li>
<li><p><strong>verbose</strong> – print the controller’s gains</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.environment_specific.QBallBalancerPDCtrl.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'qbb_pd'</em><a class="headerlink" href="#pyrado.policies.environment_specific.QBallBalancerPDCtrl.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.policies.environment_specific.QBallBalancerPDCtrl.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">state_des</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>numpy.ndarray<span class="p">, </span>torch.Tensor<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/environment_specific.html#QBallBalancerPDCtrl.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.environment_specific.QBallBalancerPDCtrl.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the controller’s desired state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state_des</strong> – tensor of desired x and y ball position [m], or None to keep the current desired state</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.environment_specific.QCartPoleGoToLimCtrl">
<em class="property">class </em><code class="sig-name descname">QCartPoleGoToLimCtrl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_state</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">positive</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/environment_specific.html#QCartPoleGoToLimCtrl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.environment_specific.QCartPoleGoToLimCtrl" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Controller for going to one of the joint limits (part of the calibration routine)</p>
</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.environment_specific.QCartPoleSwingUpAndBalanceCtrl">
<em class="property">class </em><code class="sig-name descname">QCartPoleSwingUpAndBalanceCtrl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env_spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">u_max</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">18.0</span></em>, <em class="sig-param"><span class="n">v_max</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">12.0</span></em>, <em class="sig-param"><span class="n">long</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/environment_specific.html#QCartPoleSwingUpAndBalanceCtrl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.environment_specific.QCartPoleSwingUpAndBalanceCtrl" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a></p>
<p>Swing-up and balancing controller for the Quanser Cart-Pole</p>
<dl class="py method">
<dt id="pyrado.policies.environment_specific.QCartPoleSwingUpAndBalanceCtrl.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/environment_specific.html#QCartPoleSwingUpAndBalanceCtrl.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.environment_specific.QCartPoleSwingUpAndBalanceCtrl.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the controller output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – observation from the environment</p>
</dd>
<dt class="field-even">Return act</dt>
<dd class="field-even"><p>controller output [V]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.environment_specific.QCartPoleSwingUpAndBalanceCtrl.init_param">
<code class="sig-name descname">init_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_values</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/environment_specific.html#QCartPoleSwingUpAndBalanceCtrl.init_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.environment_specific.QCartPoleSwingUpAndBalanceCtrl.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.environment_specific.QCartPoleSwingUpAndBalanceCtrl.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'qcp-sub'</em><a class="headerlink" href="#pyrado.policies.environment_specific.QCartPoleSwingUpAndBalanceCtrl.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.environment_specific.QQubeEnergyCtrl">
<em class="property">class </em><code class="sig-name descname">QQubeEnergyCtrl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env_spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">ref_energy</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">energy_gain</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">th_gain</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">acc_max</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/environment_specific.html#QQubeEnergyCtrl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.environment_specific.QQubeEnergyCtrl" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a></p>
<p>Energy-based controller used to swing the pendulum up</p>
<dl class="py method">
<dt id="pyrado.policies.environment_specific.QQubeEnergyCtrl.E_gain">
<em class="property">property </em><code class="sig-name descname">E_gain</code><a class="headerlink" href="#pyrado.policies.environment_specific.QQubeEnergyCtrl.E_gain" title="Permalink to this definition">¶</a></dt>
<dd><p>Called <span class="math notranslate nohighlight">\(\mu\)</span> by Quanser.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.environment_specific.QQubeEnergyCtrl.E_ref">
<em class="property">property </em><code class="sig-name descname">E_ref</code><a class="headerlink" href="#pyrado.policies.environment_specific.QQubeEnergyCtrl.E_ref" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.policies.environment_specific.QQubeEnergyCtrl.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/environment_specific.html#QQubeEnergyCtrl.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.environment_specific.QQubeEnergyCtrl.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Control step of energy-based controller which is used in the swing-up controller</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – observations pre-processed in the <cite>forward</cite> method of <cite>QQubeSwingUpAndBalanceCtrl</cite></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>action</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.environment_specific.QQubeEnergyCtrl.init_param">
<code class="sig-name descname">init_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_values</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/environment_specific.html#QQubeEnergyCtrl.init_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.environment_specific.QQubeEnergyCtrl.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.environment_specific.QQubeGoToLimCtrl">
<em class="property">class </em><code class="sig-name descname">QQubeGoToLimCtrl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">positive</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">cnt_done</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">250</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/environment_specific.html#QQubeGoToLimCtrl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.environment_specific.QQubeGoToLimCtrl" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Controller for going to one of the joint limits (part of the calibration routine)</p>
</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.environment_specific.QQubePDCtrl">
<em class="property">class </em><code class="sig-name descname">QQubePDCtrl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env_spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">k</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">tensor([4.0, 0.0, 0.5, 0.0])</span></em>, <em class="sig-param"><span class="n">th_des</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">al_des</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">tols</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">tensor([0.0262, 0.0087, 0.0017, 0.0017])</span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/environment_specific.html#QQubePDCtrl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.environment_specific.QQubePDCtrl" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a></p>
<p>PD-controller for the Qunaser Qube.
Drives Qube to <span class="math notranslate nohighlight">\(x_{des} = [\theta_{des}, \alpha_{des}, 0.0, 0.0]\)</span>.
Flag done is set when <span class="math notranslate nohighlight">\(|x_des - x| &lt; tol\)</span>.</p>
<dl class="py method">
<dt id="pyrado.policies.environment_specific.QQubePDCtrl.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meas</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/environment_specific.html#QQubePDCtrl.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.environment_specific.QQubePDCtrl.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action according to the policy and the observations (forward pass).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – observation from the environment</p>
</dd>
<dt class="field-even">Return act</dt>
<dd class="field-even"><p>action to be taken</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.environment_specific.QQubePDCtrl.init_param">
<code class="sig-name descname">init_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_values</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/environment_specific.html#QQubePDCtrl.init_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.environment_specific.QQubePDCtrl.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.environment_specific.QQubeSwingUpAndBalanceCtrl">
<em class="property">class </em><code class="sig-name descname">QQubeSwingUpAndBalanceCtrl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env_spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">ref_energy</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.025</span></em>, <em class="sig-param"><span class="n">energy_gain</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">50.0</span></em>, <em class="sig-param"><span class="n">energy_th_gain</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.4</span></em>, <em class="sig-param"><span class="n">acc_max</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">5.0</span></em>, <em class="sig-param"><span class="n">alpha_max_pd_enable</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">20.0</span></em>, <em class="sig-param"><span class="n">pd_gains</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">tensor([- 2.0, 35.0, - 1.5, 3.0])</span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/environment_specific.html#QQubeSwingUpAndBalanceCtrl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.environment_specific.QQubeSwingUpAndBalanceCtrl" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a></p>
<p>Hybrid controller (QQubeEnergyCtrl, QQubePDCtrl) switching based on the pendulum pole angle alpha</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Extracted Quanser’s values from q_qube2_swingup.mdl</p>
</div>
<dl class="py method">
<dt id="pyrado.policies.environment_specific.QQubeSwingUpAndBalanceCtrl.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span><span class="p">:</span> <span class="n">None._VariableFunctions.tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/environment_specific.html#QQubeSwingUpAndBalanceCtrl.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.environment_specific.QQubeSwingUpAndBalanceCtrl.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action according to the policy and the observations (forward pass).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – observation from the environment</p>
</dd>
<dt class="field-even">Return act</dt>
<dd class="field-even"><p>action to be taken</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.environment_specific.QQubeSwingUpAndBalanceCtrl.init_param">
<code class="sig-name descname">init_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_values</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/environment_specific.html#QQubeSwingUpAndBalanceCtrl.init_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.environment_specific.QQubeSwingUpAndBalanceCtrl.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.environment_specific.QQubeSwingUpAndBalanceCtrl.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'qq-sub'</em><a class="headerlink" href="#pyrado.policies.environment_specific.QQubeSwingUpAndBalanceCtrl.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.policies.environment_specific.QQubeSwingUpAndBalanceCtrl.pd_enabled">
<code class="sig-name descname">pd_enabled</code><span class="sig-paren">(</span><em class="sig-param">cos_al: [&lt;class 'float'&gt;, &lt;class 'torch.Tensor'&gt;]</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/pyrado/policies/environment_specific.html#QQubeSwingUpAndBalanceCtrl.pd_enabled"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.environment_specific.QQubeSwingUpAndBalanceCtrl.pd_enabled" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the PD-controller should be enabled based oin a predefined threshold on the alpha angle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>cos_al</strong> – cosine of the pendulum pole angle</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool if condition is met</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyrado.policies.environment_specific.get_lin_ctrl">
<code class="sig-name descname">get_lin_ctrl</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environments.html#pyrado.environments.sim_base.SimEnv" title="pyrado.environments.sim_base.SimEnv">pyrado.environments.sim_base.SimEnv</a></span></em>, <em class="sig-param"><span class="n">ctrl_type</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">ball_z_dim_mismatch</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#pyrado.policies.linear.LinearPolicy" title="pyrado.policies.linear.LinearPolicy">pyrado.policies.linear.LinearPolicy</a><a class="reference internal" href="_modules/pyrado/policies/environment_specific.html#get_lin_ctrl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.environment_specific.get_lin_ctrl" title="Permalink to this definition">¶</a></dt>
<dd><p>Construct a linear controller specified by its controller gains.
Parameters for BallOnPlate5DSim by Markus Lamprecht (clipped gains &lt; 1e-5 to 0).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> – environment</p></li>
<li><p><strong>ctrl_type</strong> – type of the controller: ‘lqr’, or ‘h2’</p></li>
<li><p><strong>ball_z_dim_mismatch</strong> – only useful for BallOnPlate5DSim
set to True if the given controller dos not have the z component (relative position)
of the ball in the state vector, i.e. state is 14-dim instead of 16-dim</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>controller compatible with Pyrado Policy</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrado.policies.features">
<span id="features"></span><h2>features<a class="headerlink" href="#module-pyrado.policies.features" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.policies.features.ATan2Feat">
<em class="property">class </em><code class="sig-name descname">ATan2Feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">idx_sin</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">idx_cos</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#ATan2Feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.ATan2Feat" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Feature that computes the atan2 from two dimensions of the given input / observation.</p>
</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.features.FeatureStack">
<em class="property">class </em><code class="sig-name descname">FeatureStack</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">feat_fcns</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>Callable<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#FeatureStack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.FeatureStack" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Features are nonlinear transformations of the inputs.
.. note:: We only consider 1-dim measurements, i.e. no images.</p>
<dl class="py method">
<dt id="pyrado.policies.features.FeatureStack.get_num_feat">
<code class="sig-name descname">get_num_feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp_flat_dim</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span> &#x2192; int<a class="reference internal" href="_modules/pyrado/policies/features.html#FeatureStack.get_num_feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.FeatureStack.get_num_feat" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the number of features which depends on the dimension of the input and the selected feature functions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inp_flat_dim</strong> – flattened dimension input to the feature functions</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>number of feature values</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.features.MultFeat">
<em class="property">class </em><code class="sig-name descname">MultFeat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">idcs</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>int<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#MultFeat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.MultFeat" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Feature that multiplies two dimensions of the given input / observation</p>
</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.features.RBFFeat">
<em class="property">class </em><code class="sig-name descname">RBFFeat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">num_feat_per_dim</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">bounds</span><span class="p">:</span> <span class="n"><span class="p">[</span>typing.Sequence<span class="p">[</span>numpy.ndarray<span class="p">]</span><span class="p">, </span>typing.Sequence<span class="p">[</span>torch.Tensor<span class="p">]</span><span class="p">, </span>typing.Sequence<span class="p">[</span>float<span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">scale</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">state_wise_norm</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#RBFFeat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.RBFFeat" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Normalized Gaussian radial basis function features</p>
<dl class="py method">
<dt id="pyrado.policies.features.RBFFeat.derivative">
<code class="sig-name descname">derivative</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/features.html#RBFFeat.derivative"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.RBFFeat.derivative" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the drivative of the features w.r.t. the inputs.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only processing of 1-dim input (e.g., no images)! The input can be batched along the first dimension.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inp</strong> – input i.e. observations in the RL setting</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>value of all features derivatives given the observations</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.features.RandFourierFeat">
<em class="property">class </em><code class="sig-name descname">RandFourierFeat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp_dim</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">num_feat_per_dim</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">bandwidth</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>float<span class="p">, </span>numpy.ndarray<span class="p">, </span>torch.Tensor<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#RandFourierFeat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.RandFourierFeat" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Random Fourier features</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] A. Rahimi and B. Recht “Random Features for Large-Scale Kernel Machines”, NIPS, 2007</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="pyrado.policies.features.abs_feat">
<code class="sig-name descname">abs_feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#abs_feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.abs_feat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyrado.policies.features.bell_feat">
<code class="sig-name descname">bell_feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">scale</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#bell_feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.bell_feat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyrado.policies.features.const_feat">
<code class="sig-name descname">const_feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#const_feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.const_feat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyrado.policies.features.cos_feat">
<code class="sig-name descname">cos_feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#cos_feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.cos_feat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyrado.policies.features.identity_feat">
<code class="sig-name descname">identity_feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#identity_feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.identity_feat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyrado.policies.features.qubic_feat">
<code class="sig-name descname">qubic_feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#qubic_feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.qubic_feat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyrado.policies.features.sig_feat">
<code class="sig-name descname">sig_feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">scale</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#sig_feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.sig_feat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyrado.policies.features.sign_feat">
<code class="sig-name descname">sign_feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#sign_feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.sign_feat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyrado.policies.features.sin_feat">
<code class="sig-name descname">sin_feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#sin_feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.sin_feat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyrado.policies.features.sincos_feat">
<code class="sig-name descname">sincos_feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#sincos_feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.sincos_feat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyrado.policies.features.sinsin_feat">
<code class="sig-name descname">sinsin_feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#sinsin_feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.sinsin_feat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt id="pyrado.policies.features.squared_feat">
<code class="sig-name descname">squared_feat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/features.html#squared_feat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.features.squared_feat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-pyrado.policies.fnn">
<span id="fnn"></span><h2>fnn<a class="headerlink" href="#module-pyrado.policies.fnn" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.policies.fnn.DiscrActQValFNNPolicy">
<em class="property">class </em><code class="sig-name descname">DiscrActQValFNNPolicy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">hidden_sizes</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>int<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">hidden_nonlin</span><span class="p">:</span> <span class="n"><span class="p">[</span>typing.Callable<span class="p">, </span>typing.Sequence<span class="p">[</span>typing.Callable<span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">dropout</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">output_nonlin</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">init_param_kwargs</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/fnn.html#DiscrActQValFNNPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.fnn.DiscrActQValFNNPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a></p>
<p>State-action value (Q-value) feed-forward neural network policy for discrete actions</p>
<dl class="py method">
<dt id="pyrado.policies.fnn.DiscrActQValFNNPolicy.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/fnn.html#DiscrActQValFNNPolicy.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.fnn.DiscrActQValFNNPolicy.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action according to the policy and the observations (forward pass).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – observation from the environment</p>
</dd>
<dt class="field-even">Return act</dt>
<dd class="field-even"><p>action to be taken</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.fnn.DiscrActQValFNNPolicy.init_param">
<code class="sig-name descname">init_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_values</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/fnn.html#DiscrActQValFNNPolicy.init_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.fnn.DiscrActQValFNNPolicy.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.fnn.DiscrActQValFNNPolicy.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'd_fnn'</em><a class="headerlink" href="#pyrado.policies.fnn.DiscrActQValFNNPolicy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.policies.fnn.DiscrActQValFNNPolicy.q_values">
<code class="sig-name descname">q_values</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/fnn.html#DiscrActQValFNNPolicy.q_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.fnn.DiscrActQValFNNPolicy.q_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the state-action values for the given observations and all possible actions.
Since we operate on a discrete ation space, we can construct a table
o1 a1
o1 a2</p>
<blockquote>
<div><p>…</p>
</div></blockquote>
<p>oN a1
oN a2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – obersvations</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Q-values for all state-action combinations, dim = batch_size x act_space_flat_sim</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.fnn.DiscrActQValFNNPolicy.q_values_chosen">
<code class="sig-name descname">q_values_chosen</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/fnn.html#DiscrActQValFNNPolicy.q_values_chosen"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.fnn.DiscrActQValFNNPolicy.q_values_chosen" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the state-action values for the given observations and all possible actions.
Since we operate on a discrete ation space, we can construct a table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – obersvations</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Q-values for all state-action combinations, dimension equals flat action space dimension</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.fnn.FNN">
<em class="property">class </em><code class="sig-name descname">FNN</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input_size</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">output_size</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">hidden_sizes</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>int<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">hidden_nonlin</span><span class="p">:</span> <span class="n"><span class="p">[</span>typing.Callable<span class="p">, </span>typing.Sequence<span class="p">[</span>typing.Callable<span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">dropout</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">output_nonlin</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">init_param_kwargs</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/fnn.html#FNN"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.fnn.FNN" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Feed-forward neural network</p>
<dl class="py method">
<dt id="pyrado.policies.fnn.FNN.device">
<em class="property">property </em><code class="sig-name descname">device</code><a class="headerlink" href="#pyrado.policies.fnn.FNN.device" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the device (CPU or GPU) on which the FNN is stored.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.fnn.FNN.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">input</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/fnn.html#FNN.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.fnn.FNN.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.fnn.FNN.init_param">
<code class="sig-name descname">init_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_values</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/fnn.html#FNN.init_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.fnn.FNN.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the network’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>init_values</strong> – Tensor of fixed initial network parameter values</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.fnn.FNN.param_values">
<em class="property">property </em><code class="sig-name descname">param_values</code><a class="headerlink" href="#pyrado.policies.fnn.FNN.param_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the parameters of the policy as 1d array.
The values are copied, modifying the return value does not propagate to the actual policy parameters.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.fnn.FNNPolicy">
<em class="property">class </em><code class="sig-name descname">FNNPolicy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">hidden_sizes</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>int<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">hidden_nonlin</span><span class="p">:</span> <span class="n"><span class="p">[</span>typing.Callable<span class="p">, </span>typing.Sequence<span class="p">[</span>typing.Callable<span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">dropout</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">output_nonlin</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">init_param_kwargs</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/fnn.html#FNNPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.fnn.FNNPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a></p>
<p>Feed-forward neural network policy</p>
<dl class="py method">
<dt id="pyrado.policies.fnn.FNNPolicy.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/fnn.html#FNNPolicy.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.fnn.FNNPolicy.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action according to the policy and the observations (forward pass).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – observation from the environment</p>
</dd>
<dt class="field-even">Return act</dt>
<dd class="field-even"><p>action to be taken</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.fnn.FNNPolicy.init_param">
<code class="sig-name descname">init_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_values</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/fnn.html#FNNPolicy.init_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.fnn.FNNPolicy.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.fnn.FNNPolicy.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'fnn'</em><a class="headerlink" href="#pyrado.policies.fnn.FNNPolicy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.policies.initialization">
<span id="initialization"></span><h2>initialization<a class="headerlink" href="#module-pyrado.policies.initialization" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyrado.policies.initialization.init_param">
<code class="sig-name descname">init_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">m</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/initialization.html#init_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.initialization.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the parameters of the PyTorch Module / layer / network / cell according to its type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>m</strong> – PyTorch Module / layer / network / cell to initialize</p></li>
<li><p><strong>kwargs</strong> – optional keyword arguments, e.g. <cite>t_max</cite> for LSTM’s chrono initialization [2], or <cite>uniform_bias</cite></p></li>
</ul>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] A.M. Sachse, J. L. McClelland, S. Ganguli, “Exact solutions to the nonlinear dynamics of learning in
deep linear neural networks”, 2014</p>
<p>[2] C. Tallec, Y. Ollivier, “Can recurrent neural networks warp time?”, 2018, ICLR</p>
</div>
</dd></dl>

</div>
<div class="section" id="module-pyrado.policies.linear">
<span id="linear"></span><h2>linear<a class="headerlink" href="#module-pyrado.policies.linear" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.policies.linear.LinearPolicy">
<em class="property">class </em><code class="sig-name descname">LinearPolicy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">feats</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#pyrado.policies.features.FeatureStack" title="pyrado.policies.features.FeatureStack">pyrado.policies.features.FeatureStack</a></span></em>, <em class="sig-param"><span class="n">init_param_kwargs</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/linear.html#LinearPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.linear.LinearPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a></p>
<p>A linear policy defined by the inner product of nonlinear features of the observations with the policy parameters</p>
<dl class="py method">
<dt id="pyrado.policies.linear.LinearPolicy.eval_feats">
<code class="sig-name descname">eval_feats</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/linear.html#LinearPolicy.eval_feats"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.linear.LinearPolicy.eval_feats" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the features for the given observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – observation from the environment</p>
</dd>
<dt class="field-even">Return feats_val</dt>
<dd class="field-even"><p>the features’ values</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.linear.LinearPolicy.features">
<em class="property">property </em><code class="sig-name descname">features</code><a class="headerlink" href="#pyrado.policies.linear.LinearPolicy.features" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the (nonlinear) feature transformations.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.linear.LinearPolicy.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/linear.html#LinearPolicy.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.linear.LinearPolicy.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the features at the given observation or use given feature values</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – observations from the environment</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>actions</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.linear.LinearPolicy.init_param">
<code class="sig-name descname">init_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_values</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/linear.html#LinearPolicy.init_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.linear.LinearPolicy.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.linear.LinearPolicy.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'lin'</em><a class="headerlink" href="#pyrado.policies.linear.LinearPolicy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.policies.neural_fields">
<span id="neural-fields"></span><h2>neural_fields<a class="headerlink" href="#module-pyrado.policies.neural_fields" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.policies.neural_fields.NFPolicy">
<em class="property">class </em><code class="sig-name descname">NFPolicy</code><span class="sig-paren">(</span><em class="sig-param">spec: pyrado.utils.data_types.EnvSpec</em>, <em class="sig-param">dt: float</em>, <em class="sig-param">hidden_size: int</em>, <em class="sig-param">obs_layer: [&lt;class 'torch.nn.modules.module.Module'&gt;</em>, <em class="sig-param">&lt;class 'pyrado.policies.base.Policy'&gt;] = None</em>, <em class="sig-param">activation_nonlin: Callable = &lt;built-in method sigmoid of type object&gt;</em>, <em class="sig-param">mirrored_conv_weights: bool = True</em>, <em class="sig-param">conv_out_channels: int = 1</em>, <em class="sig-param">conv_kernel_size: int = None</em>, <em class="sig-param">conv_padding_mode: str = 'circular'</em>, <em class="sig-param">tau_init: float = 1.0</em>, <em class="sig-param">tau_learnable: bool = True</em>, <em class="sig-param">kappa_init: float = None</em>, <em class="sig-param">kappa_learnable: bool = True</em>, <em class="sig-param">potential_init_learnable: bool = False</em>, <em class="sig-param">init_param_kwargs: dict = None</em>, <em class="sig-param">use_cuda: bool = False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/neural_fields.html#NFPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.neural_fields.NFPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.policies.base_recurrent.RecurrentPolicy" title="pyrado.policies.base_recurrent.RecurrentPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base_recurrent.RecurrentPolicy</span></code></a></p>
<p>Neural Fields (NF)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] S.-I. Amari “Dynamics of Pattern Formation in Lateral-Inhibition Type Neural Fields”,
Biological Cybernetics, 1977</p>
</div>
<dl class="py method">
<dt id="pyrado.policies.neural_fields.NFPolicy.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rollout</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em>, <em class="sig-param"><span class="n">hidden_states_name</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'hidden_states'</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/neural_fields.html#NFPolicy.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.neural_fields.NFPolicy.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-evaluate the given rollout and return a derivable action tensor.
This method makes sure that the gradient is propagated through the hidden state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollout</strong> – complete rollout</p></li>
<li><p><strong>hidden_states_name</strong> – name of hidden states rollout entry, used for recurrent networks.
Change this string for value functions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>actions with gradient data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.neural_fields.NFPolicy.extra_repr">
<code class="sig-name descname">extra_repr</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="_modules/pyrado/policies/neural_fields.html#NFPolicy.extra_repr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.neural_fields.NFPolicy.extra_repr" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the extra representation of the module</p>
<p>To print customized extra information, you should reimplement
this method in your own modules. Both single-line and multi-line
strings are acceptable.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.neural_fields.NFPolicy.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">obs: torch.Tensor</em>, <em class="sig-param">hidden: torch.Tensor = None) -&gt; (&lt;class 'torch.Tensor'&gt;</em>, <em class="sig-param">&lt;class 'torch.Tensor'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/neural_fields.html#NFPolicy.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.neural_fields.NFPolicy.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the goal distance, prediction error, and predicted cost.
Then pass it to the wrapped RNN.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> – observations coming from the environment i.e. noisy</p></li>
<li><p><strong>hidden</strong> – current hidden states, in this case action and potentials of the last time step</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>current action and new hidden states</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.neural_fields.NFPolicy.hidden_size">
<em class="property">property </em><code class="sig-name descname">hidden_size</code><a class="headerlink" href="#pyrado.policies.neural_fields.NFPolicy.hidden_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of hidden state variables.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.neural_fields.NFPolicy.init_hidden">
<code class="sig-name descname">init_hidden</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/neural_fields.html#NFPolicy.init_hidden"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.neural_fields.NFPolicy.init_hidden" title="Permalink to this definition">¶</a></dt>
<dd><p>Provide initial values for the hidden parameters. This should usually be a zero tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batch_size</strong> – number of states to track in parallel</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tensor of batch_size x hidden_size</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.neural_fields.NFPolicy.init_param">
<code class="sig-name descname">init_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_values</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/neural_fields.html#NFPolicy.init_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.neural_fields.NFPolicy.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.neural_fields.NFPolicy.kappa">
<em class="property">property </em><code class="sig-name descname">kappa</code><a class="headerlink" href="#pyrado.policies.neural_fields.NFPolicy.kappa" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the cubic decay parameter if specified in the constructor, else return zero.</p>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.neural_fields.NFPolicy.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'nf'</em><a class="headerlink" href="#pyrado.policies.neural_fields.NFPolicy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.policies.neural_fields.NFPolicy.potentials">
<em class="property">property </em><code class="sig-name descname">potentials</code><a class="headerlink" href="#pyrado.policies.neural_fields.NFPolicy.potentials" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the neurons’ potentials.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.neural_fields.NFPolicy.potentials_dot">
<code class="sig-name descname">potentials_dot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">stimuli</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/neural_fields.html#NFPolicy.potentials_dot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.neural_fields.NFPolicy.potentials_dot" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the derivative of the neurons’ potentials per time step.
<span class="math notranslate nohighlight">\(/tau /dot{u} = s + h - u + /kappa (h - u)^3,
/quad /text{with} s = s_{int} + s_{ext} = W*o + /int{w(u, v) f(u) dv}\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>stimuli</strong> – sum of external and internal stimuli at the current point in time</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>time derivative of the potentials</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.neural_fields.NFPolicy.stimuli_external">
<em class="property">property </em><code class="sig-name descname">stimuli_external</code><a class="headerlink" href="#pyrado.policies.neural_fields.NFPolicy.stimuli_external" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the neurons’ external stimuli, resulting from the current observations.
This is used for recording during a rollout.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.neural_fields.NFPolicy.stimuli_internal">
<em class="property">property </em><code class="sig-name descname">stimuli_internal</code><a class="headerlink" href="#pyrado.policies.neural_fields.NFPolicy.stimuli_internal" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the neurons’ internal stimuli, resulting from the previous activations of the neurons.
This is used for recording during a rollout.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.neural_fields.NFPolicy.tau">
<em class="property">property </em><code class="sig-name descname">tau</code><a class="headerlink" href="#pyrado.policies.neural_fields.NFPolicy.tau" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the time scale parameter (exists for all potential dynamics functions).</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.policies.rnn">
<span id="rnn"></span><h2>rnn<a class="headerlink" href="#module-pyrado.policies.rnn" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.policies.rnn.GRUPolicy">
<em class="property">class </em><code class="sig-name descname">GRUPolicy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">hidden_size</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">num_recurrent_layers</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">dropout</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">output_nonlin</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">init_param_kwargs</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">recurrent_net_kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/rnn.html#GRUPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.rnn.GRUPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.policies.rnn.RNNPolicyBase" title="pyrado.policies.rnn.RNNPolicyBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.rnn.RNNPolicyBase</span></code></a></p>
<p>Policy backed by a multi-layer GRU</p>
<dl class="py attribute">
<dt id="pyrado.policies.rnn.GRUPolicy.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'gru'</em><a class="headerlink" href="#pyrado.policies.rnn.GRUPolicy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.rnn.GRUPolicy.recurrent_network_type">
<code class="sig-name descname">recurrent_network_type</code><a class="headerlink" href="#pyrado.policies.rnn.GRUPolicy.recurrent_network_type" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.rnn.GRU</span></code></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.rnn.LSTMPolicy">
<em class="property">class </em><code class="sig-name descname">LSTMPolicy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">hidden_size</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">num_recurrent_layers</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">dropout</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">output_nonlin</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">init_param_kwargs</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">recurrent_net_kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/rnn.html#LSTMPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.rnn.LSTMPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.policies.rnn.RNNPolicyBase" title="pyrado.policies.rnn.RNNPolicyBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.rnn.RNNPolicyBase</span></code></a></p>
<p>Policy backed by a multi-layer LSTM</p>
<dl class="py method">
<dt id="pyrado.policies.rnn.LSTMPolicy.hidden_size">
<em class="property">property </em><code class="sig-name descname">hidden_size</code><a class="headerlink" href="#pyrado.policies.rnn.LSTMPolicy.hidden_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of hidden state variables.</p>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.rnn.LSTMPolicy.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'lstm'</em><a class="headerlink" href="#pyrado.policies.rnn.LSTMPolicy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.rnn.LSTMPolicy.recurrent_network_type">
<code class="sig-name descname">recurrent_network_type</code><a class="headerlink" href="#pyrado.policies.rnn.LSTMPolicy.recurrent_network_type" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.rnn.LSTM</span></code></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.rnn.RNNPolicy">
<em class="property">class </em><code class="sig-name descname">RNNPolicy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">hidden_size</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">num_recurrent_layers</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">hidden_nonlin</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'tanh'</span></em>, <em class="sig-param"><span class="n">dropout</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">output_nonlin</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">init_param_kwargs</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/rnn.html#RNNPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.rnn.RNNPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.policies.rnn.RNNPolicyBase" title="pyrado.policies.rnn.RNNPolicyBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.rnn.RNNPolicyBase</span></code></a></p>
<p>Policy backed by a multi-layer RNN</p>
<dl class="py attribute">
<dt id="pyrado.policies.rnn.RNNPolicy.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'rnn'</em><a class="headerlink" href="#pyrado.policies.rnn.RNNPolicy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.rnn.RNNPolicy.recurrent_network_type">
<code class="sig-name descname">recurrent_network_type</code><a class="headerlink" href="#pyrado.policies.rnn.RNNPolicy.recurrent_network_type" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.rnn.RNN</span></code></p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.rnn.RNNPolicyBase">
<em class="property">class </em><code class="sig-name descname">RNNPolicyBase</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">hidden_size</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">num_recurrent_layers</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">dropout</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">output_nonlin</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">init_param_kwargs</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">recurrent_net_kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/rnn.html#RNNPolicyBase"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.rnn.RNNPolicyBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.policies.base_recurrent.RecurrentPolicy" title="pyrado.policies.base_recurrent.RecurrentPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base_recurrent.RecurrentPolicy</span></code></a></p>
<p>Base class for recurrent policies wrapping torch.nn.RNNBase subclasses</p>
<dl class="py method">
<dt id="pyrado.policies.rnn.RNNPolicyBase.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rollout</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em>, <em class="sig-param"><span class="n">hidden_states_name</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'hidden_states'</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/rnn.html#RNNPolicyBase.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.rnn.RNNPolicyBase.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-evaluate the given rollout and return a derivable action tensor.
This method makes sure that the gradient is propagated through the hidden state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollout</strong> – complete rollout</p></li>
<li><p><strong>hidden_states_name</strong> – name of hidden states rollout entry, used for recurrent networks.
Change this string for value functions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>actions with gradient data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.rnn.RNNPolicyBase.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param">obs: torch.Tensor</em>, <em class="sig-param">hidden: torch.Tensor = None) -&gt; (&lt;class 'torch.Tensor'&gt;</em>, <em class="sig-param">&lt;class 'torch.Tensor'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/rnn.html#RNNPolicyBase.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.rnn.RNNPolicyBase.forward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> – observation from the environment</p></li>
<li><p><strong>hidden</strong> – the network’s hidden state. If None, use init_hidden()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>action to be taken and new hidden state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.rnn.RNNPolicyBase.hidden_size">
<em class="property">property </em><code class="sig-name descname">hidden_size</code><a class="headerlink" href="#pyrado.policies.rnn.RNNPolicyBase.hidden_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of hidden state variables.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.rnn.RNNPolicyBase.init_param">
<code class="sig-name descname">init_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_values</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/rnn.html#RNNPolicyBase.init_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.rnn.RNNPolicyBase.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.rnn.RNNPolicyBase.recurrent_network_type">
<code class="sig-name descname">recurrent_network_type</code><em class="property"> = None</em><a class="headerlink" href="#pyrado.policies.rnn.RNNPolicyBase.recurrent_network_type" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyrado.policies.rnn.default_pack_hidden">
<code class="sig-name descname">default_pack_hidden</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hidden</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">num_recurrent_layers</span></em>, <em class="sig-param"><span class="n">hidden_size</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/rnn.html#default_pack_hidden"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.rnn.default_pack_hidden" title="Permalink to this definition">¶</a></dt>
<dd><p>Pack the hidden state returned by torch.nn.RNNBase subclasses into an 1d state vector.
This is the reverse operation of default_unpack_hidden.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden</strong> – unpacked hidden state, a tensor of num_recurrent_layers x batch_size x hidden_size</p></li>
<li><p><strong>num_recurrent_layers</strong> – number of recurrent layers</p></li>
<li><p><strong>hidden_size</strong> – size of the hidden layers (all equal)</p></li>
<li><p><strong>batch_size</strong> – if not none, the result should be 2d, and the first dimension represents parts of a data batch</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>packed hidden state.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.policies.rnn.default_unpack_hidden">
<code class="sig-name descname">default_unpack_hidden</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">hidden</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">num_recurrent_layers</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">hidden_size</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/rnn.html#default_unpack_hidden"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.rnn.default_unpack_hidden" title="Permalink to this definition">¶</a></dt>
<dd><p>Unpack the flat hidden state vector into the form expected by torch.nn.RNNBase subclasses.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>hidden</strong> – packed hidden state</p></li>
<li><p><strong>num_recurrent_layers</strong> – number of recurrent layers</p></li>
<li><p><strong>hidden_size</strong> – size of the hidden layers (all equal)</p></li>
<li><p><strong>batch_size</strong> – if not none, hidden is 2d, and the first dimension represents parts of a data batch</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>unpacked hidden state, a tensor of num_recurrent_layers x batch_size x hidden_size.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrado.policies.time">
<span id="time"></span><h2>time<a class="headerlink" href="#module-pyrado.policies.time" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.policies.time.TimePolicy">
<em class="property">class </em><code class="sig-name descname">TimePolicy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">fcn_of_time</span><span class="p">:</span> <span class="n">Callable<span class="p">[</span><span class="p">[</span>float<span class="p">]</span><span class="p">, </span>Sequence<span class="p">[</span>float<span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">dt</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/time.html#TimePolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.time.TimePolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a></p>
<p>A purely time-based policy, mainly useful for testing</p>
<dl class="py method">
<dt id="pyrado.policies.time.TimePolicy.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/policies/time.html#TimePolicy.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.time.TimePolicy.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action according to the policy and the observations (forward pass).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – observation from the environment</p>
</dd>
<dt class="field-even">Return act</dt>
<dd class="field-even"><p>action to be taken</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.time.TimePolicy.init_param">
<code class="sig-name descname">init_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_values</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/time.html#TimePolicy.init_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.time.TimePolicy.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.time.TimePolicy.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'time'</em><a class="headerlink" href="#pyrado.policies.time.TimePolicy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.policies.time.TimePolicy.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/time.html#TimePolicy.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.time.TimePolicy.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the policy to it’s initial state.
This should be called at the start of a rollout. Stateful policies should use it to reset the state variables.
The default implementation does nothing.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.time.TimePolicy.script">
<code class="sig-name descname">script</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; torch.jit.ScriptModule<a class="reference internal" href="_modules/pyrado/policies/time.html#TimePolicy.script"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.time.TimePolicy.script" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a ScriptModule from this policy.
The returned module will always have the signature <cite>action = tm(observation)</cite>.
For recurrent networks, it returns a stateful module that keeps the hidden states internally.
Such modules have a reset() method to reset the hidden states.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.time.TraceableTimePolicy">
<em class="property">class </em><code class="sig-name descname">TraceableTimePolicy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">fcn_of_time</span><span class="p">:</span> <span class="n">Callable<span class="p">[</span><span class="p">[</span>float<span class="p">]</span><span class="p">, </span>Sequence<span class="p">[</span>float<span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">dt</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/time.html#TraceableTimePolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.time.TraceableTimePolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>A scriptable version of TimePolicy.</p>
<p>We could try to make TimePolicy itself scriptable, but that won’t work anyways due to Policy not being scriptable.
Better to just write another class.</p>
<dl class="py attribute">
<dt id="pyrado.policies.time.TraceableTimePolicy.current_time">
<code class="sig-name descname">current_time</code><em class="property">: float</em><a class="headerlink" href="#pyrado.policies.time.TraceableTimePolicy.current_time" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.time.TraceableTimePolicy.dt">
<code class="sig-name descname">dt</code><em class="property">: float</em><a class="headerlink" href="#pyrado.policies.time.TraceableTimePolicy.dt" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.policies.time.TraceableTimePolicy.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs_ignore</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/time.html#TraceableTimePolicy.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.time.TraceableTimePolicy.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.time.TraceableTimePolicy.input_size">
<code class="sig-name descname">input_size</code><em class="property">: int</em><a class="headerlink" href="#pyrado.policies.time.TraceableTimePolicy.input_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.time.TraceableTimePolicy.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'trtime'</em><a class="headerlink" href="#pyrado.policies.time.TraceableTimePolicy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.time.TraceableTimePolicy.output_size">
<code class="sig-name descname">output_size</code><em class="property">: int</em><a class="headerlink" href="#pyrado.policies.time.TraceableTimePolicy.output_size" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.policies.time.TraceableTimePolicy.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/time.html#TraceableTimePolicy.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.time.TraceableTimePolicy.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.policies.two_headed">
<span id="two-headed"></span><h2>two_headed<a class="headerlink" href="#module-pyrado.policies.two_headed" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.policies.two_headed.TwoHeadedFNNPolicy">
<em class="property">class </em><code class="sig-name descname">TwoHeadedFNNPolicy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">shared_hidden_sizes</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>int<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">shared_hidden_nonlin</span><span class="p">:</span> <span class="n"><span class="p">[</span>typing.Callable<span class="p">, </span>typing.Sequence<span class="p">[</span>typing.Callable<span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">head_1_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">head_2_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">head_1_output_nonlin</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">head_2_output_nonlin</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">shared_dropout</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">init_param_kwargs</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/two_headed.html#TwoHeadedFNNPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.two_headed.TwoHeadedFNNPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.policies.two_headed.TwoHeadedPolicy" title="pyrado.policies.two_headed.TwoHeadedPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.two_headed.TwoHeadedPolicy</span></code></a></p>
<p>Policy architecture which has a common body and two heads that have a separate last layer</p>
<dl class="py method">
<dt id="pyrado.policies.two_headed.TwoHeadedFNNPolicy.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>torch.Tensor<span class="p">, </span>torch.Tensor<span class="p">]</span><a class="reference internal" href="_modules/pyrado/policies/two_headed.html#TwoHeadedFNNPolicy.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.two_headed.TwoHeadedFNNPolicy.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action according to the policy and the observations (forward pass).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – observation from the environment</p>
</dd>
<dt class="field-even">Return act</dt>
<dd class="field-even"><p>action to be taken</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.two_headed.TwoHeadedFNNPolicy.init_param">
<code class="sig-name descname">init_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_values</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/two_headed.html#TwoHeadedFNNPolicy.init_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.two_headed.TwoHeadedFNNPolicy.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.two_headed.TwoHeadedFNNPolicy.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = '2h_fnn'</em><a class="headerlink" href="#pyrado.policies.two_headed.TwoHeadedFNNPolicy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.two_headed.TwoHeadedGRUPolicy">
<em class="property">class </em><code class="sig-name descname">TwoHeadedGRUPolicy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">shared_hidden_size</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">shared_num_recurrent_layers</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">head_1_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">head_2_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">head_1_output_nonlin</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">head_2_output_nonlin</span><span class="p">:</span> <span class="n">Callable</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">shared_dropout</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">init_param_kwargs</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/two_headed.html#TwoHeadedGRUPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.two_headed.TwoHeadedGRUPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.policies.two_headed.TwoHeadedPolicy" title="pyrado.policies.two_headed.TwoHeadedPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.two_headed.TwoHeadedPolicy</span></code></a>, <a class="reference internal" href="#pyrado.policies.base_recurrent.RecurrentPolicy" title="pyrado.policies.base_recurrent.RecurrentPolicy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base_recurrent.RecurrentPolicy</span></code></a></p>
<p>Policy architecture which has a common body and two heads that have a separate last layer</p>
<dl class="py method">
<dt id="pyrado.policies.two_headed.TwoHeadedGRUPolicy.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em>, <em class="sig-param"><span class="n">hidden_states_name</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'hidden_states'</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>torch.Tensor<span class="p">, </span>torch.Tensor<span class="p">]</span><a class="reference internal" href="_modules/pyrado/policies/two_headed.html#TwoHeadedGRUPolicy.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.two_headed.TwoHeadedGRUPolicy.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Re-evaluate the given rollout and return a derivable action tensor.
The default implementation simply calls <cite>forward()</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollout</strong> – complete rollout</p></li>
<li><p><strong>hidden_states_name</strong> – name of hidden states rollout entry, used for recurrent networks.
Defaults to ‘hidden_states’. Change for value functions.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>actions with gradient data</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.two_headed.TwoHeadedGRUPolicy.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">hidden</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>torch.Tensor<span class="p">, </span>torch.Tensor<span class="p">, </span>torch.Tensor<span class="p">]</span><a class="reference internal" href="_modules/pyrado/policies/two_headed.html#TwoHeadedGRUPolicy.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.two_headed.TwoHeadedGRUPolicy.forward" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> – observation from the environment</p></li>
<li><p><strong>hidden</strong> – the network’s hidden state. If None, use init_hidden()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>action to be taken and new hidden state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.two_headed.TwoHeadedGRUPolicy.hidden_size">
<em class="property">property </em><code class="sig-name descname">hidden_size</code><a class="headerlink" href="#pyrado.policies.two_headed.TwoHeadedGRUPolicy.hidden_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of hidden state variables.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.two_headed.TwoHeadedGRUPolicy.init_param">
<code class="sig-name descname">init_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_values</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/two_headed.html#TwoHeadedGRUPolicy.init_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.two_headed.TwoHeadedGRUPolicy.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.policies.two_headed.TwoHeadedGRUPolicy.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = '2h_gru'</em><a class="headerlink" href="#pyrado.policies.two_headed.TwoHeadedGRUPolicy.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.policies.two_headed.TwoHeadedPolicy">
<em class="property">class </em><code class="sig-name descname">TwoHeadedPolicy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/two_headed.html#TwoHeadedPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.two_headed.TwoHeadedPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Base class for policies with a shared body and two separate heads.</p>
<dl class="py method">
<dt id="pyrado.policies.two_headed.TwoHeadedPolicy.forward">
<em class="property">abstract </em><code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; [&lt;class ‘torch.Tensor’&gt;, (&lt;class ‘torch.Tensor’&gt;, &lt;class ‘torch.Tensor’&gt;)]<a class="reference internal" href="_modules/pyrado/policies/two_headed.html#TwoHeadedPolicy.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.two_headed.TwoHeadedPolicy.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action according to the policy and the observations (forward pass).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – observation from the environment</p>
</dd>
<dt class="field-even">Return act</dt>
<dd class="field-even"><p>action to be taken</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.policies.two_headed.TwoHeadedPolicy.init_param">
<em class="property">abstract </em><code class="sig-name descname">init_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_values</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/policies/two_headed.html#TwoHeadedPolicy.init_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.policies.two_headed.TwoHeadedPolicy.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the policy’s parameters. By default the parameters are initialized randomly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_values</strong> – tensor of fixed initial policy parameter values</p></li>
<li><p><strong>kwargs</strong> – additional keyword arguments for the policy parameter initialization</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.policies">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyrado.policies" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="sampling.html" class="btn btn-neutral float-right" title="sampling" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="plotting.html" class="btn btn-neutral float-left" title="plotting" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>