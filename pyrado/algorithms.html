

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>algorithms &mdash; Pyrado 0.2 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="domain_randomization" href="domain_randomization.html" />
    <link rel="prev" title="How to create an algorithm" href="examples/3_algorithm.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Pyrado
          

          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/1_experiment.html">How to run an experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/2_environment_wrappers.html">How to wrap an environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/3_algorithm.html">How to create an algorithm</a></li>
</ul>
<p class="caption"><span class="caption-text">Package Overview:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">algorithms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.a2c">a2c</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.actor_critic">actor_critic</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.adr">adr</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.adr_discriminator">adr_discriminator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.advantage">advantage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.arpl">arpl</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.base">base</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.bayrn">bayrn</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.cem">cem</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.dql">dql</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.epopt">epopt</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.hc">hc</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.nes">nes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.parameter_exploring">parameter_exploring</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.pepg">pepg</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.power">power</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.ppo">ppo</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.predefined_lqr">predefined_lqr</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.reps">reps</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.sac">sac</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.simopt">simopt</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.spota">spota</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.svpg">svpg</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.sysid_via_episodic_rl">sysid_via_episodic_rl</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.timeseries_prediction">timeseries_prediction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.udr">udr</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.utils">utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="domain_randomization.html">domain_randomization</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.html">environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.pysim.html">pysim</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.mujoco.html">mujoco</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.rcspysim.html">rcspysim</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.quanser.html">quanser</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment_wrappers.html">environment_wrappers</a></li>
<li class="toctree-l1"><a class="reference internal" href="exploration.html">exploration</a></li>
<li class="toctree-l1"><a class="reference internal" href="logger.html">logger</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.html">policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling.html">sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="spaces.html">spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">tests</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Pyrado</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>algorithms</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/algorithms.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="algorithms">
<h1>algorithms<a class="headerlink" href="#algorithms" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-pyrado.algorithms.a2c">
<span id="a2c"></span><h2>a2c<a class="headerlink" href="#module-pyrado.algorithms.a2c" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.a2c.A2C">
<em class="property">class </em><code class="sig-name descname">A2C</code><span class="sig-paren">(</span><em class="sig-param">save_dir: str</em>, <em class="sig-param">env: pyrado.environments.base.Env</em>, <em class="sig-param">policy: pyrado.policies.base.Policy</em>, <em class="sig-param">critic: pyrado.algorithms.advantage.GAE</em>, <em class="sig-param">max_iter: int</em>, <em class="sig-param">min_rollouts: int = None</em>, <em class="sig-param">min_steps: int = None</em>, <em class="sig-param">value_fcn_coeff: float = 0.5</em>, <em class="sig-param">entropy_coeff: float = 0.001</em>, <em class="sig-param">batch_size: int = 32</em>, <em class="sig-param">std_init: float = 1.0</em>, <em class="sig-param">max_grad_norm: float = None</em>, <em class="sig-param">num_workers: int = 4</em>, <em class="sig-param">lr: float = 0.0005</em>, <em class="sig-param">lr_scheduler=None</em>, <em class="sig-param">lr_scheduler_hparam: [&lt;class 'dict'&gt;</em>, <em class="sig-param">None] = None</em>, <em class="sig-param">logger: pyrado.logger.step.StepLogger = None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/a2c.html#A2C"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.a2c.A2C" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.actor_critic.ActorCritic" title="pyrado.algorithms.actor_critic.ActorCritic"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.actor_critic.ActorCritic</span></code></a></p>
<p>Advantage Actor Critic (A2C)</p>
<dl class="py method">
<dt id="pyrado.algorithms.a2c.A2C.loss_fcn">
<code class="sig-name descname">loss_fcn</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">log_probs</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">adv</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">v_pred</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">v_targ</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/a2c.html#A2C.loss_fcn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.a2c.A2C.loss_fcn" title="Permalink to this definition">¶</a></dt>
<dd><p>A2C loss function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log_probs</strong> – logarithm of the probabilities of the taken actions</p></li>
<li><p><strong>adv</strong> – advantage values</p></li>
<li><p><strong>v_pred</strong> – predicted value function values</p></li>
<li><p><strong>v_targ</strong> – target value function values</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>combined loss value</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.a2c.A2C.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'a2c'</em><a class="headerlink" href="#pyrado.algorithms.a2c.A2C.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.a2c.A2C.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rollouts</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a><span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/a2c.html#A2C.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.a2c.A2C.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the actor and critic parameters from the given batch of rollouts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rollouts</strong> – batch of rollouts</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.actor_critic">
<span id="actor-critic"></span><h2>actor_critic<a class="headerlink" href="#module-pyrado.algorithms.actor_critic" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.actor_critic.ActorCritic">
<em class="property">class </em><code class="sig-name descname">ActorCritic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env">pyrado.environments.base.Env</a></span></em>, <em class="sig-param"><span class="n">actor</span><span class="p">:</span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a></span></em>, <em class="sig-param"><span class="n">critic</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#pyrado.algorithms.advantage.GAE" title="pyrado.algorithms.advantage.GAE">pyrado.algorithms.advantage.GAE</a></span></em>, <em class="sig-param"><span class="n">save_dir</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">max_iter</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">logger</span><span class="p">:</span> <span class="n"><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger">pyrado.logger.step.StepLogger</a></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/actor_critic.html#ActorCritic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.actor_critic.ActorCritic" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.Algorithm</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Base class of all actor critic algorithms</p>
<dl class="py method">
<dt id="pyrado.algorithms.actor_critic.ActorCritic.critic">
<em class="property">property </em><code class="sig-name descname">critic</code><a class="headerlink" href="#pyrado.algorithms.actor_critic.ActorCritic.critic" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the critic.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.actor_critic.ActorCritic.expl_strat">
<em class="property">property </em><code class="sig-name descname">expl_strat</code><a class="headerlink" href="#pyrado.algorithms.actor_critic.ActorCritic.expl_strat" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the algorithm’s exploration strategy.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.actor_critic.ActorCritic.init_modules">
<code class="sig-name descname">init_modules</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">warmstart</span><span class="p">:</span> <span class="n">bool</span></em>, <em class="sig-param"><span class="n">suffix</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">''</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/actor_critic.html#ActorCritic.init_modules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.actor_critic.ActorCritic.init_modules" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the algorithm’s learnable modules, e.g. a policy or value function.
Overwrite this method if the algorithm uses a learnable module aside the policy, e.g. a value function.
This method is similar to <cite>load_snapshot()</cite> which also loads additional algorithm members like environments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>warmstart</strong> – if <cite>True</cite>, the algorithm starts learning with an initialization. This can either be the a
fixed parameter vector, or the results of the previous iteration</p></li>
<li><p><strong>suffix</strong> – keyword for <cite>meta_info</cite> when loading from previous iteration</p></li>
<li><p><strong>kwargs</strong> – keyword arguments for initialization, e.g. <cite>policy_param_init</cite> or <cite>valuefcn_param_init</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.actor_critic.ActorCritic.load_snapshot">
<code class="sig-name descname">load_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">load_dir</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/actor_critic.html#ActorCritic.load_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.actor_critic.ActorCritic.load_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to load the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_dir</strong> – explicit directory to load from, if <cite>None</cite> (default) <cite>self._save_dir</cite> is used</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.actor_critic.ActorCritic.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seed</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/actor_critic.html#ActorCritic.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.actor_critic.ActorCritic.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.actor_critic.ActorCritic.save_snapshot">
<code class="sig-name descname">save_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/actor_critic.html#ActorCritic.save_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.actor_critic.ActorCritic.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.actor_critic.ActorCritic.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/actor_critic.html#ActorCritic.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.actor_critic.ActorCritic.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.actor_critic.ActorCritic.update">
<em class="property">abstract </em><code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rollouts</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a><span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/actor_critic.html#ActorCritic.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.actor_critic.ActorCritic.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the actor and critic parameters from the given batch of rollouts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rollouts</strong> – batch of rollouts</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.adr">
<span id="adr"></span><h2>adr<a class="headerlink" href="#module-pyrado.algorithms.adr" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.adr.ADR">
<em class="property">class </em><code class="sig-name descname">ADR</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_dir</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env">pyrado.environments.base.Env</a></span></em>, <em class="sig-param"><span class="n">subroutine</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm">pyrado.algorithms.base.Algorithm</a></span></em>, <em class="sig-param"><span class="n">max_iter</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">svpg_particle_hparam</span><span class="p">:</span> <span class="n">dict</span></em>, <em class="sig-param"><span class="n">num_svpg_particles</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">num_discriminator_epoch</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">svpg_learning_rate</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0003</span></em>, <em class="sig-param"><span class="n">svpg_temperature</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">10</span></em>, <em class="sig-param"><span class="n">svpg_evaluation_steps</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">10</span></em>, <em class="sig-param"><span class="n">svpg_horizon</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">50</span></em>, <em class="sig-param"><span class="n">svpg_kl_factor</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.03</span></em>, <em class="sig-param"><span class="n">svpg_warmup</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em>, <em class="sig-param"><span class="n">svpg_serial</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">num_workers</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">num_trajs_per_config</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">8</span></em>, <em class="sig-param"><span class="n">max_step_length</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.05</span></em>, <em class="sig-param"><span class="n">randomized_params</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>str<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">logger</span><span class="p">:</span> <span class="n"><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger">pyrado.logger.step.StepLogger</a></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/adr.html#ADR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.adr.ADR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.Algorithm</span></code></a></p>
<p>Active Domain Randomization (ADR)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] B. Mehta, M. Diaz, F. Golemo, C.J. Pal, L. Paull, “Active Domain Randomization”, arXiv, 2019</p>
</div>
<dl class="py method">
<dt id="pyrado.algorithms.adr.ADR.compute_params">
<code class="sig-name descname">compute_params</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sim_instances</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">t</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/adr.html#ADR.compute_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.adr.ADR.compute_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes the parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sim_instances</strong> – Physics configurations trajectory</p></li>
<li><p><strong>t</strong> – time step to chose</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>parameters at the time</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.adr.ADR.load_snapshot">
<code class="sig-name descname">load_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">load_dir</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/adr.html#ADR.load_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.adr.ADR.load_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to load the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_dir</strong> – explicit directory to load from, if <cite>None</cite> (default) <cite>self._save_dir</cite> is used</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.adr.ADR.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'adr'</em><a class="headerlink" href="#pyrado.algorithms.adr.ADR.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.adr.ADR.save_snapshot">
<code class="sig-name descname">save_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/adr.html#ADR.save_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.adr.ADR.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.adr.ADR.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">parallel</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/adr.html#ADR.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.adr.ADR.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.algorithms.adr.SVPGAdapter">
<em class="property">class </em><code class="sig-name descname">SVPGAdapter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">wrapped_env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env">pyrado.environments.base.Env</a></span></em>, <em class="sig-param"><span class="n">parameters</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span><a class="reference internal" href="domain_randomization.html#pyrado.domain_randomization.domain_parameter.DomainParam" title="pyrado.domain_randomization.domain_parameter.DomainParam">pyrado.domain_randomization.domain_parameter.DomainParam</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">inner_policy</span><span class="p">:</span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a></span></em>, <em class="sig-param"><span class="n">discriminator</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#pyrado.algorithms.adr_discriminator.RewardGenerator" title="pyrado.algorithms.adr_discriminator.RewardGenerator">pyrado.algorithms.adr_discriminator.RewardGenerator</a></span></em>, <em class="sig-param"><span class="n">step_length</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">horizon</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">50</span></em>, <em class="sig-param"><span class="n">num_trajs_per_config</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">8</span></em>, <em class="sig-param"><span class="n">num_workers</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/adr.html#SVPGAdapter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.adr.SVPGAdapter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.base.EnvWrapper" title="pyrado.environment_wrappers.base.EnvWrapper"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.environment_wrappers.base.EnvWrapper</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">init_args_serializer.serializable.Serializable</span></code></p>
<p>Wrapper to encapsulate the domain parameter search as a reinforcement learning problem</p>
<dl class="py method">
<dt id="pyrado.algorithms.adr.SVPGAdapter.act_space">
<em class="property">property </em><code class="sig-name descname">act_space</code><a class="headerlink" href="#pyrado.algorithms.adr.SVPGAdapter.act_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the space of the actions.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.adr.SVPGAdapter.array_to_dict">
<code class="sig-name descname">array_to_dict</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">arr</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/adr.html#SVPGAdapter.array_to_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.adr.SVPGAdapter.array_to_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.adr.SVPGAdapter.eval_states">
<code class="sig-name descname">eval_states</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">states</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>numpy.ndarray<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/adr.html#SVPGAdapter.eval_states"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.adr.SVPGAdapter.eval_states" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the states.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>states</strong> – the states to evaluate</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>respective rewards and according trajectories</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.adr.SVPGAdapter.lite_step">
<code class="sig-name descname">lite_step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">act</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/adr.html#SVPGAdapter.lite_step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.adr.SVPGAdapter.lite_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a step without the step interface.
This allows for parallel computation of prior steps.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>act</strong> – the action to perform</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the observation after the step</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.adr.SVPGAdapter.nominal">
<code class="sig-name descname">nominal</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/adr.html#SVPGAdapter.nominal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.adr.SVPGAdapter.nominal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.adr.SVPGAdapter.nominal_dict">
<code class="sig-name descname">nominal_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/adr.html#SVPGAdapter.nominal_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.adr.SVPGAdapter.nominal_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.adr.SVPGAdapter.obs_space">
<em class="property">property </em><code class="sig-name descname">obs_space</code><a class="headerlink" href="#pyrado.algorithms.adr.SVPGAdapter.obs_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the space of the observations (agent’s perception of the environment).</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.adr.SVPGAdapter.params">
<code class="sig-name descname">params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/adr.html#SVPGAdapter.params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.adr.SVPGAdapter.params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.adr.SVPGAdapter.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_state</span><span class="p">:</span> <span class="n">numpy.ndarray</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">domain_param</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/pyrado/algorithms/adr.html#SVPGAdapter.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.adr.SVPGAdapter.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the environment to its initial state and optionally set different domain parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_state</strong> – set explicit initial state if not None</p></li>
<li><p><strong>domain_param</strong> – set explicit domain parameters if not None</p></li>
</ul>
</dd>
<dt class="field-even">Return obs</dt>
<dd class="field-even"><p>initial observation of the state.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.adr.SVPGAdapter.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">act</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/adr.html#SVPGAdapter.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.adr.SVPGAdapter.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform one time step of the simulation. When a terminal condition is met, the reset function is called.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>act</strong> – action to be taken in the step</p>
</dd>
<dt class="field-even">Return tuple of obs, reward, done, and info</dt>
<dd class="field-even"><p>obs : current observation of the environment
reward: reward depending on the selected reward function
done: indicates whether the episode has ended
env_info: contains diagnostic information about the environment</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.adr_discriminator">
<span id="adr-discriminator"></span><h2>adr_discriminator<a class="headerlink" href="#module-pyrado.algorithms.adr_discriminator" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.adr_discriminator.RewardGenerator">
<em class="property">class </em><code class="sig-name descname">RewardGenerator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env_spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">reward_multiplier</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">lr</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.003</span></em>, <em class="sig-param"><span class="n">logger</span><span class="p">:</span> <span class="n"><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger">pyrado.logger.step.StepLogger</a></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">device</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'cpu'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/adr_discriminator.html#RewardGenerator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.adr_discriminator.RewardGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for generating the discriminator rewards in ADR. Generates a reward using a trained discriminator network.</p>
<dl class="py method">
<dt id="pyrado.algorithms.adr_discriminator.RewardGenerator.get_reward">
<code class="sig-name descname">get_reward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">traj</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/adr_discriminator.html#RewardGenerator.get_reward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.adr_discriminator.RewardGenerator.get_reward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.adr_discriminator.RewardGenerator.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">reference_trajectory</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em>, <em class="sig-param"><span class="n">randomized_trajectory</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em>, <em class="sig-param"><span class="n">num_epoch</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/algorithms/adr_discriminator.html#RewardGenerator.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.adr_discriminator.RewardGenerator.train" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyrado.algorithms.adr_discriminator.convert_step_sequence">
<code class="sig-name descname">convert_step_sequence</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">trajectory</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/adr_discriminator.html#convert_step_sequence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.adr_discriminator.convert_step_sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a StepSequence to a Tensor which can be fed through a Network</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>trajectory</strong> – A step sequence containing a trajectory</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A Tensor containing the trajectory</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.advantage">
<span id="advantage"></span><h2>advantage<a class="headerlink" href="#module-pyrado.algorithms.advantage" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.advantage.GAE">
<em class="property">class </em><code class="sig-name descname">GAE</code><span class="sig-paren">(</span><em class="sig-param">value_fcn: [&lt;class 'torch.nn.modules.module.Module'&gt;, &lt;class 'pyrado.policies.base.Policy'&gt;], gamma: float = 0.99, lamda: float = 0.95, num_epoch: int = 10, batch_size: int = 64, standardize_adv: bool = True, standardizer: [None, &lt;class 'pyrado.utils.data_processing.RunningStandardizer'&gt;] = None, max_grad_norm: float = None, lr: float = 0.0005, lr_scheduler=None, lr_scheduler_hparam: [&lt;class 'dict'&gt;, None] = None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/advantage.html#GAE"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.advantage.GAE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="logger.html#pyrado.logger.step.LoggerAware" title="pyrado.logger.step.LoggerAware"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.logger.step.LoggerAware</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>General Advantage Estimation (GAE)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] J. Schulmann, P. Moritz, S. Levine, M. Jordan, P. Abbeel, ‘High-Dimensional Continuous Control Using
Generalized Advantage Estimation’, ICLR 2016</p>
</div>
<dl class="py method">
<dt id="pyrado.algorithms.advantage.GAE.gae">
<code class="sig-name descname">gae</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">concat_ros</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em>, <em class="sig-param"><span class="n">v_pred</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">requires_grad</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/algorithms/advantage.html#GAE.gae"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.advantage.GAE.gae" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the generalized advantage estimation as described in [1].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>concat_ros</strong> – concatenated rollouts (sequence of steps from potentially different rollouts)</p></li>
<li><p><strong>v_pred</strong> – state-value predictions if already computed, else pass None</p></li>
<li><p><strong>requires_grad</strong> – is the gradient required</p></li>
</ul>
</dd>
<dt class="field-even">Return adv</dt>
<dd class="field-even"><p>tensor of advantages</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.advantage.GAE.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/advantage.html#GAE.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.advantage.GAE.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the advantage estimator to it’s initial state.
The default implementation resets the learning rate scheduler if there is one.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.advantage.GAE.tdlamda_returns">
<code class="sig-name descname">tdlamda_returns</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">v_pred</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">adv</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">concat_ros</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/algorithms/advantage.html#GAE.tdlamda_returns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.advantage.GAE.tdlamda_returns" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the TD(<span class="math notranslate nohighlight">\(\lambda\)</span>) returns based on the predictions of the network (introduces a bias).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v_pred</strong> – state-value predictions if already computed, pass <cite>None</cite> to compute form given rollouts</p></li>
<li><p><strong>adv</strong> – advantages if already computed, pass <cite>None</cite> to compute form given rollouts</p></li>
<li><p><strong>concat_ros</strong> – rollouts to compute predicted values and advantages from if they are not provided</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>exponentially weighted returns based on the value function estimator</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.advantage.GAE.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rollouts</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">use_empirical_returns</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/advantage.html#GAE.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.advantage.GAE.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Adapt the parameters of the advantage function estimator, minimizing the MSE loss for the given samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollouts</strong> – batch of rollouts</p></li>
<li><p><strong>use_empirical_returns</strong> – use the return from the rollout (True) or the ones from the V-fcn (False)</p></li>
</ul>
</dd>
<dt class="field-even">Return adv</dt>
<dd class="field-even"><p>tensor of advantages after V-function updates</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.advantage.GAE.value_fcn">
<em class="property">property </em><code class="sig-name descname">value_fcn</code><a class="headerlink" href="#pyrado.algorithms.advantage.GAE.value_fcn" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the value function approximator.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.advantage.GAE.values">
<code class="sig-name descname">values</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">concat_ros</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/algorithms/advantage.html#GAE.values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.advantage.GAE.values" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the states’ values for all observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>concat_ros</strong> – concatenated rollouts</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>states’ values</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.arpl">
<span id="arpl"></span><h2>arpl<a class="headerlink" href="#module-pyrado.algorithms.arpl" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.arpl.ARPL">
<em class="property">class </em><code class="sig-name descname">ARPL</code><span class="sig-paren">(</span><em class="sig-param">save_dir: str, env: [&lt;class 'pyrado.environments.sim_base.SimEnv'&gt;, &lt;class 'pyrado.environment_wrappers.state_augmentation.StateAugmentationWrapper'&gt;], subrtn: pyrado.algorithms.base.Algorithm, policy: pyrado.policies.base.Policy, expl_strat: pyrado.exploration.stochastic_action.StochasticActionExplStrat, max_iter: int, num_rollouts: int = None, steps_num: int = None, apply_dynamics_noise: bool = False, dyn_eps: float = 0.01, dyn_phi: float = 0.1, halfspan: float = 0.25, apply_proccess_noise: bool = False, proc_eps: float = 0.01, proc_phi: float = 0.05, apply_observation_noise: bool = False, obs_eps: float = 0.01, obs_phi: float = 0.05, torch_observation: bool = True, num_workers: int = 4, logger: pyrado.logger.step.StepLogger = None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/arpl.html#ARPL"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.arpl.ARPL" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.Algorithm</span></code></a></p>
<p>Adversarially Robust Policy Learning (ARPL)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>A. Mandlekar, Y. Zhu, A. Garg, L. Fei-Fei, S. Savarese, “Adversarially Robust Policy Learning:
Active Construction of Physically-Plausible Perturbations”, IROS, 2017</p>
</div>
<dl class="py method">
<dt id="pyrado.algorithms.arpl.ARPL.load_snapshot">
<code class="sig-name descname">load_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">load_dir</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/arpl.html#ARPL.load_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.arpl.ARPL.load_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to load the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_dir</strong> – explicit directory to load from, if <cite>None</cite> (default) <cite>self._save_dir</cite> is used</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.arpl.ARPL.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'arpl'</em><a class="headerlink" href="#pyrado.algorithms.arpl.ARPL.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.arpl.ARPL.save_snapshot">
<code class="sig-name descname">save_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/arpl.html#ARPL.save_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.arpl.ARPL.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.arpl.ARPL.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/arpl.html#ARPL.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.arpl.ARPL.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.base">
<span id="base"></span><h2>base<a class="headerlink" href="#module-pyrado.algorithms.base" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.base.Algorithm">
<em class="property">class </em><code class="sig-name descname">Algorithm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_dir</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">max_iter</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">policy</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">logger</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger">pyrado.logger.step.StepLogger</a><span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code>, <a class="reference internal" href="logger.html#pyrado.logger.step.LoggerAware" title="pyrado.logger.step.LoggerAware"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.logger.step.LoggerAware</span></code></a></p>
<p>Base class of all algorithms in Pyrado
Algorithms specify the way how the policy is updated as well as the exploration strategy used to acquire samples.</p>
<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.clip_grad">
<em class="property">static </em><code class="sig-name descname">clip_grad</code><span class="sig-paren">(</span><em class="sig-param">module: torch.nn.modules.module.Module, max_grad_norm: [&lt;class 'float'&gt;, None]</em><span class="sig-paren">)</span> &#x2192; float<a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.clip_grad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.clip_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Clip all gradients of the provided Module (e.g., a policy or an advantage estimator) by their L2 norm value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The gradient clipping has to be applied between loss.backward() and optimizer.step()</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>module</strong> – Module containing parameters</p></li>
<li><p><strong>max_grad_norm</strong> – maximum L2 norm for the gradient</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>total norm of the parameters (viewed as a single vector)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.curr_iter">
<em class="property">property </em><code class="sig-name descname">curr_iter</code><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.curr_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current iteration counter.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.expl_strat">
<em class="property">property </em><code class="sig-name descname">expl_strat</code><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.expl_strat" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the algorithm’s exploration strategy.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.init_modules">
<code class="sig-name descname">init_modules</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">warmstart</span><span class="p">:</span> <span class="n">bool</span></em>, <em class="sig-param"><span class="n">suffix</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">''</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.init_modules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.init_modules" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the algorithm’s learnable modules, e.g. a policy or value function.
Overwrite this method if the algorithm uses a learnable module aside the policy, e.g. a value function.
This method is similar to <cite>load_snapshot()</cite> which also loads additional algorithm members like environments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>warmstart</strong> – if <cite>True</cite>, the algorithm starts learning with an initialization. This can either be the a
fixed parameter vector, or the results of the previous iteration</p></li>
<li><p><strong>suffix</strong> – keyword for <cite>meta_info</cite> when loading from previous iteration</p></li>
<li><p><strong>kwargs</strong> – keyword arguments for initialization, e.g. <cite>policy_param_init</cite> or <cite>valuefcn_param_init</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.base.Algorithm.iteration_key">
<code class="sig-name descname">iteration_key</code><em class="property">: str</em><em class="property"> = 'iteration'</em><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.iteration_key" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.load_snapshot">
<code class="sig-name descname">load_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">load_dir</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.load_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.load_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to load the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_dir</strong> – explicit directory to load from, if <cite>None</cite> (default) <cite>self._save_dir</cite> is used</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.make_snapshot">
<code class="sig-name descname">make_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">curr_avg_ret</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.make_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.make_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a snapshot of the training progress.
This method is called from the subclasses and delegates to the custom method <cite>save_snapshot()</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>curr_avg_ret</strong> – current average return used for the snapshot_mode ‘best’ to trigger <cite>save_snapshot()</cite></p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.max_iter">
<em class="property">property </em><code class="sig-name descname">max_iter</code><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.max_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the maximum number of iterations.</p>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.base.Algorithm.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = None</em><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.policy">
<em class="property">property </em><code class="sig-name descname">policy</code><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.policy" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the algorithm’s policy.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seed</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.save_dir">
<em class="property">property </em><code class="sig-name descname">save_dir</code><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.save_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the directory where the data is saved to.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.save_snapshot">
<code class="sig-name descname">save_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.save_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.step">
<em class="property">abstract </em><code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.stopping_criterion_met">
<code class="sig-name descname">stopping_criterion_met</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.stopping_criterion_met"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.stopping_criterion_met" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if one of the algorithms (characteristic) stopping criterions is met.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function can be overwritten by the subclasses to implement custom stopping behavior.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>flag if one of the stopping criterion(s) is met</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">load_dir</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'latest'</span></em>, <em class="sig-param"><span class="n">seed</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train one/multiple policy/policies in a given environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_dir</strong> – if not <cite>None</cite> the training snapshot will be loaded from the given directory, i.e. the training
does not start from scratch</p></li>
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new high-score)</p></li>
<li><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the policy’s (and value functions’) parameters based on the collected rollout data.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.bayrn">
<span id="bayrn"></span><h2>bayrn<a class="headerlink" href="#module-pyrado.algorithms.bayrn" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.bayrn.BayRn">
<em class="property">class </em><code class="sig-name descname">BayRn</code><span class="sig-paren">(</span><em class="sig-param">save_dir: str, env_sim: pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper, env_real: [&lt;class 'pyrado.environments.real_base.RealEnv'&gt;, &lt;class 'pyrado.environment_wrappers.base.EnvWrapper'&gt;], subrtn: pyrado.algorithms.base.Algorithm, bounds: torch.Tensor, max_iter: int, acq_fc: str, acq_restarts: int, acq_samples: int, acq_param: dict = None, mc_estimator: bool = True, num_eval_rollouts_real: int = 5, num_eval_rollouts_sim: int = 50, num_init_cand: int = 5, thold_succ: float = inf, thold_succ_subrtn: float = -inf, warmstart: bool = True, policy_param_init: torch.Tensor = None, valuefcn_param_init: torch.Tensor = None, subrtn_snapshot_mode: str = 'best'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/bayrn.html#BayRn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.bayrn.BayRn" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.Algorithm</span></code></a></p>
<p>Bayesian Domain Randomization (BayRn)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A candidate is a set of parameter values for the domain parameter distribution and its value is the
(estimated) real-world return.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>F. Muratore, C. Eilers, M. Gienger, J. Peters, “Bayesian Domain Randomization for Sim-to-Real Transfer”,
arXiv, 2020</p>
</div>
<dl class="py method">
<dt id="pyrado.algorithms.bayrn.BayRn.argmax_posterior_mean">
<em class="property">static </em><code class="sig-name descname">argmax_posterior_mean</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cands</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">cands_values</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">uc_normalizer</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.math.UnitCubeProjector" title="pyrado.utils.math.UnitCubeProjector">pyrado.utils.math.UnitCubeProjector</a></span></em>, <em class="sig-param"><span class="n">num_restarts</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">num_samples</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/algorithms/bayrn.html#BayRn.argmax_posterior_mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.bayrn.BayRn.argmax_posterior_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the GP input with the maximal posterior mean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cands</strong> – candidates a.k.a. x</p></li>
<li><p><strong>cands_values</strong> – observed values a.k.a. y</p></li>
<li><p><strong>uc_normalizer</strong> – unit cube normalizer used during the experiments (can be recovered form the bounds)</p></li>
<li><p><strong>num_restarts</strong> – number of restarts for the optimization of the acquisition function</p></li>
<li><p><strong>num_samples</strong> – number of samples for the optimization of the acquisition function</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>un-normalized candidate with maximum posterior value a.k.a. x</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.bayrn.BayRn.eval_init_policies">
<code class="sig-name descname">eval_init_policies</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/bayrn.html#BayRn.eval_init_policies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.bayrn.BayRn.eval_init_policies" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the trained initial policies on the target device and store the estimated return per candidate.
The number of initial policies to evaluate is the number of found policies.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.bayrn.BayRn.eval_policy">
<em class="property">static </em><code class="sig-name descname">eval_policy</code><span class="sig-paren">(</span><em class="sig-param">save_dir: [&lt;class 'str'&gt;, None], env: [&lt;class 'pyrado.environments.real_base.RealEnv'&gt;, &lt;class 'pyrado.environments.sim_base.SimEnv'&gt;, &lt;class 'pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper'&gt;], policy: pyrado.policies.base.Policy, mc_estimator: bool, prefix: str, num_rollouts: int, num_parallel_envs: int = 1</em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/algorithms/bayrn.html#BayRn.eval_policy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.bayrn.BayRn.eval_policy" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate a policy on the target system (real-world platform).
This method is static to facilitate evaluation of specific policies in hindsight.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_dir</strong> – directory to save the snapshots i.e. the results in, if <cite>None</cite> nothing is saved</p></li>
<li><p><strong>env</strong> – target environment for evaluation, in the sim-2-sim case this is another simulation instance</p></li>
<li><p><strong>policy</strong> – policy to evaluate</p></li>
<li><p><strong>mc_estimator</strong> – estimate the return with a sample average (<cite>True</cite>) or a lower confidence
bound (<cite>False</cite>) obtained from bootrapping</p></li>
<li><p><strong>prefix</strong> – to control the saving for the evaluation of an initial policy, <cite>None</cite> to deactivate</p></li>
<li><p><strong>num_rollouts</strong> – number of rollouts to collect on the target system</p></li>
<li><p><strong>prefix</strong> – to control the saving for the evaluation of an initial policy, <cite>None</cite> to deactivate</p></li>
<li><p><strong>num_parallel_envs</strong> – number of environments for the parallel sampler (only used for SimEnv)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>estimated return in the target domain</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.bayrn.BayRn.iteration_key">
<code class="sig-name descname">iteration_key</code><em class="property">: str</em><em class="property"> = 'bayrn_iteration'</em><a class="headerlink" href="#pyrado.algorithms.bayrn.BayRn.iteration_key" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.bayrn.BayRn.load_snapshot">
<code class="sig-name descname">load_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">load_dir</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/bayrn.html#BayRn.load_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.bayrn.BayRn.load_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to load the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_dir</strong> – explicit directory to load from, if <cite>None</cite> (default) <cite>self._save_dir</cite> is used</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.bayrn.BayRn.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'bayrn'</em><a class="headerlink" href="#pyrado.algorithms.bayrn.BayRn.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.bayrn.BayRn.save_snapshot">
<code class="sig-name descname">save_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/bayrn.html#BayRn.save_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.bayrn.BayRn.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.bayrn.BayRn.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/bayrn.html#BayRn.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.bayrn.BayRn.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.bayrn.BayRn.stopping_criterion_met">
<code class="sig-name descname">stopping_criterion_met</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/pyrado/algorithms/bayrn.html#BayRn.stopping_criterion_met"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.bayrn.BayRn.stopping_criterion_met" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if one of the algorithms (characteristic) stopping criterions is met.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function can be overwritten by the subclasses to implement custom stopping behavior.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>flag if one of the stopping criterion(s) is met</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.bayrn.BayRn.train_argmax_policy">
<em class="property">static </em><code class="sig-name descname">train_argmax_policy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">load_dir</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">env_sim</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper" title="pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper">pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper</a></span></em>, <em class="sig-param"><span class="n">subrtn</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm">pyrado.algorithms.base.Algorithm</a></span></em>, <em class="sig-param"><span class="n">num_restarts</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">num_samples</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">policy_param_init</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">valuefcn_param_init</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">subrtn_snapshot_mode</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'best'</span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a><a class="reference internal" href="_modules/pyrado/algorithms/bayrn.html#BayRn.train_argmax_policy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.bayrn.BayRn.train_argmax_policy" title="Permalink to this definition">¶</a></dt>
<dd><p>Train a policy based on the maximizer of the posterior mean.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_dir</strong> – directory to load from</p></li>
<li><p><strong>env_sim</strong> – simulation environment</p></li>
<li><p><strong>subrtn</strong> – algorithm which performs the policy / value-function optimization</p></li>
<li><p><strong>num_restarts</strong> – number of restarts for the optimization of the acquisition function</p></li>
<li><p><strong>num_samples</strong> – number of samples for the optimization of the acquisition function</p></li>
<li><p><strong>policy_param_init</strong> – initial policy parameter values for the subroutine, set <cite>None</cite> to be random</p></li>
<li><p><strong>valuefcn_param_init</strong> – initial value function parameter values for the subroutine, set <cite>None</cite> to be random</p></li>
<li><p><strong>subrtn_snapshot_mode</strong> – snapshot mode for saving during training of the subroutine</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the final BayRn policy</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.bayrn.BayRn.train_init_policies">
<code class="sig-name descname">train_init_policies</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/bayrn.html#BayRn.train_init_policies"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.bayrn.BayRn.train_init_policies" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the algorithm with a number of random distribution parameter sets a.k.a. candidates specified by
the user. Train a policy for every candidate. Finally, store the policies and candidates.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.bayrn.BayRn.train_policy_sim">
<code class="sig-name descname">train_policy_sim</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cand</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">prefix</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; float<a class="reference internal" href="_modules/pyrado/algorithms/bayrn.html#BayRn.train_policy_sim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.bayrn.BayRn.train_policy_sim" title="Permalink to this definition">¶</a></dt>
<dd><p>Train a policy in simulation for given hyper-parameters from the domain randomizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cand</strong> – hyper-parameters for the domain parameter distribution (need be compatible with the randomizer)</p></li>
<li><p><strong>prefix</strong> – set a prefix to the saved file name by passing it to <cite>meta_info</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>estimated return of the trained policy in the target domain</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.cem">
<span id="cem"></span><h2>cem<a class="headerlink" href="#module-pyrado.algorithms.cem" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.cem.CEM">
<em class="property">class </em><code class="sig-name descname">CEM</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_dir</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env">pyrado.environments.base.Env</a></span></em>, <em class="sig-param"><span class="n">policy</span><span class="p">:</span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a></span></em>, <em class="sig-param"><span class="n">max_iter</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">pop_size</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">num_rollouts</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">num_is_samples</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">expl_std_init</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">expl_std_min</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">extra_expl_std_init</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">extra_expl_decay_iter</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">10</span></em>, <em class="sig-param"><span class="n">full_cov</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">symm_sampling</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">num_workers</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">logger</span><span class="p">:</span> <span class="n"><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger">pyrado.logger.step.StepLogger</a></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/cem.html#CEM"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.cem.CEM" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.parameter_exploring.ParameterExploring" title="pyrado.algorithms.parameter_exploring.ParameterExploring"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.parameter_exploring.ParameterExploring</span></code></a></p>
<p>Cross-Entropy Method (CEM)
This implementation is basically Algorithm 3.3. in [1] with the addition of decreasing noise [2].
CEM is closely related to PoWER. The most significant difference is that the importance sampels are not kept over
iterations and that the covariance matrix is not scaled with the returns, thus allowing for negative returns.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] P.T. de Boer, D.P. Kroese, S. Mannor, R.Y. Rubinstein, “A Tutorial on the Cross-Entropy Method”,
Annals OR, 2005</p>
<p>[2] I. Szita, A. Lörnicz, “Learning Tetris Using the NoisyCross-Entropy Method”, Neural Computation, 2006</p>
</div>
<dl class="py attribute">
<dt id="pyrado.algorithms.cem.CEM.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'cem'</em><a class="headerlink" href="#pyrado.algorithms.cem.CEM.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.cem.CEM.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">param_results</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult" title="pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult">pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult</a></span></em>, <em class="sig-param"><span class="n">ret_avg_curr</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/cem.html#CEM.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.cem.CEM.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the policy from the given samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_results</strong> – Sampled parameters with evaluation</p></li>
<li><p><strong>ret_avg_curr</strong> – Average return for the current parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.dql">
<span id="dql"></span><h2>dql<a class="headerlink" href="#module-pyrado.algorithms.dql" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.dql.DQL">
<em class="property">class </em><code class="sig-name descname">DQL</code><span class="sig-paren">(</span><em class="sig-param">save_dir: str</em>, <em class="sig-param">env: pyrado.environments.base.Env</em>, <em class="sig-param">policy: pyrado.policies.fnn.DiscrActQValFNNPolicy</em>, <em class="sig-param">memory_size: int</em>, <em class="sig-param">eps_init: float</em>, <em class="sig-param">eps_schedule_gamma: float</em>, <em class="sig-param">gamma: float</em>, <em class="sig-param">max_iter: int</em>, <em class="sig-param">num_batch_updates: int</em>, <em class="sig-param">target_update_intvl: int = 5</em>, <em class="sig-param">min_rollouts: int = None</em>, <em class="sig-param">min_steps: int = None</em>, <em class="sig-param">batch_size: int = 256</em>, <em class="sig-param">num_workers: int = 4</em>, <em class="sig-param">max_grad_norm: float = 0.5</em>, <em class="sig-param">lr: float = 0.0005</em>, <em class="sig-param">lr_scheduler=None</em>, <em class="sig-param">lr_scheduler_hparam: [&lt;class 'dict'&gt;</em>, <em class="sig-param">None] = None</em>, <em class="sig-param">logger: pyrado.logger.step.StepLogger = None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/dql.html#DQL"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.dql.DQL" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.Algorithm</span></code></a></p>
<p>Deep Q-Learning (without bells and whistles)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] V. Mnih et.al., “Human-level control through deep reinforcement learning”, Nature, 2015</p>
</div>
<dl class="py method">
<dt id="pyrado.algorithms.dql.DQL.expl_strat">
<em class="property">property </em><code class="sig-name descname">expl_strat</code><a class="headerlink" href="#pyrado.algorithms.dql.DQL.expl_strat" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the algorithm’s exploration strategy.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.dql.DQL.init_modules">
<code class="sig-name descname">init_modules</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">warmstart</span><span class="p">:</span> <span class="n">bool</span></em>, <em class="sig-param"><span class="n">suffix</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">''</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/dql.html#DQL.init_modules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.dql.DQL.init_modules" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the algorithm’s learnable modules, e.g. a policy or value function.
Overwrite this method if the algorithm uses a learnable module aside the policy, e.g. a value function.
This method is similar to <cite>load_snapshot()</cite> which also loads additional algorithm members like environments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>warmstart</strong> – if <cite>True</cite>, the algorithm starts learning with an initialization. This can either be the a
fixed parameter vector, or the results of the previous iteration</p></li>
<li><p><strong>suffix</strong> – keyword for <cite>meta_info</cite> when loading from previous iteration</p></li>
<li><p><strong>kwargs</strong> – keyword arguments for initialization, e.g. <cite>policy_param_init</cite> or <cite>valuefcn_param_init</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.dql.DQL.load_snapshot">
<code class="sig-name descname">load_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">load_dir</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/dql.html#DQL.load_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.dql.DQL.load_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to load the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_dir</strong> – explicit directory to load from, if <cite>None</cite> (default) <cite>self._save_dir</cite> is used</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.dql.DQL.loss_fcn">
<code class="sig-name descname">loss_fcn</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">q_vals</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">expected_q_vals</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/algorithms/dql.html#DQL.loss_fcn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.dql.DQL.loss_fcn" title="Permalink to this definition">¶</a></dt>
<dd><p>The Huber loss function on the one-step TD error <span class="math notranslate nohighlight">\(\delta = Q(s,a) - (r + \gamma \max_a Q(s^\prime, a))\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_vals</strong> – state-action values <span class="math notranslate nohighlight">\(Q(s,a)\)</span>, from policy network</p></li>
<li><p><strong>expected_q_vals</strong> – expected state-action values <span class="math notranslate nohighlight">\(r + \gamma \max_a Q(s^\prime, a)\)</span>, from target network</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>loss value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.dql.DQL.memory">
<em class="property">property </em><code class="sig-name descname">memory</code><a class="headerlink" href="#pyrado.algorithms.dql.DQL.memory" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the replay memory.</p>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.dql.DQL.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'dql'</em><a class="headerlink" href="#pyrado.algorithms.dql.DQL.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.dql.DQL.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seed</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/dql.html#DQL.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.dql.DQL.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.dql.DQL.save_snapshot">
<code class="sig-name descname">save_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/dql.html#DQL.save_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.dql.DQL.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.dql.DQL.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/dql.html#DQL.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.dql.DQL.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.dql.DQL.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/dql.html#DQL.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.dql.DQL.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the policy’s and target Q-function’s parameters on transitions sampled from the replay memory.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.epopt">
<span id="epopt"></span><h2>epopt<a class="headerlink" href="#module-pyrado.algorithms.epopt" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.epopt.EPOpt">
<em class="property">class </em><code class="sig-name descname">EPOpt</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.base.EnvWrapper" title="pyrado.environment_wrappers.base.EnvWrapper">pyrado.environment_wrappers.base.EnvWrapper</a></span></em>, <em class="sig-param"><span class="n">subrtn</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm">pyrado.algorithms.base.Algorithm</a></span></em>, <em class="sig-param"><span class="n">skip_iter</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">epsilon</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">gamma</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/epopt.html#EPOpt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.epopt.EPOpt" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.Algorithm</span></code></a></p>
<p>Ensemble Policy Optimization (EPOpt)</p>
<p>This algorithm wraps another algorithm on a shallow level. It replaces the subroutine’s sampler with a
<cite>CVaRSampler</cite>, but does not have its own logger.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] A. Rajeswaran, S. Ghotra, B. Ravindran, S. Levine, “EPOpt: Learning Robust Neural Network Policies using
Model Ensembles”, ICLR, 2017</p>
</div>
<dl class="py method">
<dt id="pyrado.algorithms.epopt.EPOpt.load_snapshot">
<code class="sig-name descname">load_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">load_dir</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/epopt.html#EPOpt.load_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.epopt.EPOpt.load_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to load the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_dir</strong> – explicit directory to load from, if <cite>None</cite> (default) <cite>self._save_dir</cite> is used</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.epopt.EPOpt.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'epopt'</em><a class="headerlink" href="#pyrado.algorithms.epopt.EPOpt.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.epopt.EPOpt.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seed</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/epopt.html#EPOpt.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.epopt.EPOpt.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.epopt.EPOpt.save_snapshot">
<code class="sig-name descname">save_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/epopt.html#EPOpt.save_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.epopt.EPOpt.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.epopt.EPOpt.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/epopt.html#EPOpt.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.epopt.EPOpt.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.epopt.EPOpt.subroutine">
<em class="property">property </em><code class="sig-name descname">subroutine</code><a class="headerlink" href="#pyrado.algorithms.epopt.EPOpt.subroutine" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.hc">
<span id="hc"></span><h2>hc<a class="headerlink" href="#module-pyrado.algorithms.hc" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.hc.HC">
<em class="property">class </em><code class="sig-name descname">HC</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_dir</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env">pyrado.environments.base.Env</a></span></em>, <em class="sig-param"><span class="n">policy</span><span class="p">:</span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a></span></em>, <em class="sig-param"><span class="n">max_iter</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">num_rollouts</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">expl_factor</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">pop_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_workers</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/hc.html#HC"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.hc.HC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.parameter_exploring.ParameterExploring" title="pyrado.algorithms.parameter_exploring.ParameterExploring"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.parameter_exploring.ParameterExploring</span></code></a></p>
<p>Hill Climbing (HC)</p>
<p>HC is a heuristic-based policy search method that samples a population of policy parameters per iteration
and evaluates them on multiple rollouts. If one of the new parameters is better than the current one it is kept.
If the exploration parameters grow too large, they are reset.</p>
<dl class="py attribute">
<dt id="pyrado.algorithms.hc.HC.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'hc'</em><a class="headerlink" href="#pyrado.algorithms.hc.HC.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.hc.HC.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">param_results</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult" title="pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult">pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult</a></span></em>, <em class="sig-param"><span class="n">ret_avg_curr</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/hc.html#HC.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.hc.HC.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the policy from the given samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_results</strong> – Sampled parameters with evaluation</p></li>
<li><p><strong>ret_avg_curr</strong> – Average return for the current parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.hc.HC.update_expl_strat">
<em class="property">abstract </em><code class="sig-name descname">update_expl_strat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rets_avg_ros</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">ret_avg_curr</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/hc.html#HC.update_expl_strat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.hc.HC.update_expl_strat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.algorithms.hc.HCHyper">
<em class="property">class </em><code class="sig-name descname">HCHyper</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/hc.html#HCHyper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.hc.HCHyper" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.hc.HC" title="pyrado.algorithms.hc.HC"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.hc.HC</span></code></a></p>
<p>Hill Climbing variant using an exploration strategy that samples policy parameters from a hyper-sphere</p>
<dl class="py method">
<dt id="pyrado.algorithms.hc.HCHyper.update_expl_strat">
<code class="sig-name descname">update_expl_strat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rets_avg_ros</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">ret_avg_curr</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/hc.html#HCHyper.update_expl_strat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.hc.HCHyper.update_expl_strat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.algorithms.hc.HCNormal">
<em class="property">class </em><code class="sig-name descname">HCNormal</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/hc.html#HCNormal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.hc.HCNormal" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.hc.HC" title="pyrado.algorithms.hc.HC"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.hc.HC</span></code></a></p>
<p>Hill Climbing variant using an exploration strategy with normally distributed noise on the policy parameters</p>
<dl class="py method">
<dt id="pyrado.algorithms.hc.HCNormal.update_expl_strat">
<code class="sig-name descname">update_expl_strat</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rets_avg_ros</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">ret_avg_curr</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/hc.html#HCNormal.update_expl_strat"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.hc.HCNormal.update_expl_strat" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.nes">
<span id="nes"></span><h2>nes<a class="headerlink" href="#module-pyrado.algorithms.nes" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.nes.NES">
<em class="property">class </em><code class="sig-name descname">NES</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_dir</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env">pyrado.environments.base.Env</a></span></em>, <em class="sig-param"><span class="n">policy</span><span class="p">:</span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a></span></em>, <em class="sig-param"><span class="n">max_iter</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">num_rollouts</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">expl_std_init</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">expl_std_min</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">pop_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">eta_mean</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">eta_std</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">symm_sampling</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">transform_returns</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">num_workers</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">logger</span><span class="p">:</span> <span class="n"><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger">pyrado.logger.step.StepLogger</a></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/nes.html#NES"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.nes.NES" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.parameter_exploring.ParameterExploring" title="pyrado.algorithms.parameter_exploring.ParameterExploring"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.parameter_exploring.ParameterExploring</span></code></a></p>
<p>Simplified variant of Natural Evolution Strategies (NES)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] D. Wierstra, T. Schaul, T. Glasmachers, Y. Sun, J. Peters, J. Schmidhuber, “Natural Evolution Strategies”,
JMLR, 2014</p>
<p>[2] This implementation was inspired by <a class="reference external" href="https://github.com/pybrain/pybrain/blob/master/pybrain/optimization/distributionbased/snes.py">https://github.com/pybrain/pybrain/blob/master/pybrain/optimization/distributionbased/snes.py</a></p>
</div>
<dl class="py method">
<dt id="pyrado.algorithms.nes.NES.compute_utilities">
<em class="property">static </em><code class="sig-name descname">compute_utilities</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">pop_size</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">eta_mean</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">eta_std</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/nes.html#NES.compute_utilities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.nes.NES.compute_utilities" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the utilities as described in section 3.1 of [1] (a.k.a. Hansen ranking with uniform baseline)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pop_size</strong> – number of solutions in the population</p></li>
<li><p><strong>eta_mean</strong> – step size factor for the mean</p></li>
<li><p><strong>eta_std</strong> – step size factor for the standard deviation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>utility coefficient for the mean, and utility coefficient for the standard deviation</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.nes.NES.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'nes'</em><a class="headerlink" href="#pyrado.algorithms.nes.NES.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.nes.NES.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">param_results</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult" title="pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult">pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult</a></span></em>, <em class="sig-param"><span class="n">ret_avg_curr</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/nes.html#NES.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.nes.NES.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the policy from the given samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_results</strong> – Sampled parameters with evaluation</p></li>
<li><p><strong>ret_avg_curr</strong> – Average return for the current parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.parameter_exploring">
<span id="parameter-exploring"></span><h2>parameter_exploring<a class="headerlink" href="#module-pyrado.algorithms.parameter_exploring" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.parameter_exploring.ParameterExploring">
<em class="property">class </em><code class="sig-name descname">ParameterExploring</code><span class="sig-paren">(</span><em class="sig-param">save_dir: str</em>, <em class="sig-param">env: pyrado.environments.base.Env</em>, <em class="sig-param">policy: pyrado.policies.base.Policy</em>, <em class="sig-param">max_iter: int</em>, <em class="sig-param">num_rollouts: int</em>, <em class="sig-param">pop_size: [&lt;class 'int'&gt;</em>, <em class="sig-param">None] = None</em>, <em class="sig-param">num_workers: int = 4</em>, <em class="sig-param">logger: pyrado.logger.step.StepLogger = None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/parameter_exploring.html#ParameterExploring"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.parameter_exploring.ParameterExploring" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.Algorithm</span></code></a></p>
<p>Base for all algorithms that explore directly in the policy parameter space</p>
<dl class="py method">
<dt id="pyrado.algorithms.parameter_exploring.ParameterExploring.env">
<em class="property">property </em><code class="sig-name descname">env</code><a class="headerlink" href="#pyrado.algorithms.parameter_exploring.ParameterExploring.env" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the environment in which the algorithm exploration trains.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.parameter_exploring.ParameterExploring.expl_strat">
<em class="property">property </em><code class="sig-name descname">expl_strat</code><a class="headerlink" href="#pyrado.algorithms.parameter_exploring.ParameterExploring.expl_strat" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the algorithm’s exploration strategy.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.parameter_exploring.ParameterExploring.load_snapshot">
<code class="sig-name descname">load_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">load_dir</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/parameter_exploring.html#ParameterExploring.load_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.parameter_exploring.ParameterExploring.load_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to load the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_dir</strong> – explicit directory to load from, if <cite>None</cite> (default) <cite>self._save_dir</cite> is used</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.parameter_exploring.ParameterExploring.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seed</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/parameter_exploring.html#ParameterExploring.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.parameter_exploring.ParameterExploring.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.parameter_exploring.ParameterExploring.save_snapshot">
<code class="sig-name descname">save_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/parameter_exploring.html#ParameterExploring.save_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.parameter_exploring.ParameterExploring.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.parameter_exploring.ParameterExploring.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/parameter_exploring.html#ParameterExploring.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.parameter_exploring.ParameterExploring.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.parameter_exploring.ParameterExploring.stopping_criterion_met">
<code class="sig-name descname">stopping_criterion_met</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/pyrado/algorithms/parameter_exploring.html#ParameterExploring.stopping_criterion_met"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.parameter_exploring.ParameterExploring.stopping_criterion_met" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the average reward of the mean policy did not change more than the specified threshold over the
last iterations.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.parameter_exploring.ParameterExploring.update">
<em class="property">abstract </em><code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">param_results</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult" title="pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult">pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult</a></span></em>, <em class="sig-param"><span class="n">ret_avg_curr</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/parameter_exploring.html#ParameterExploring.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.parameter_exploring.ParameterExploring.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the policy from the given samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_results</strong> – Sampled parameters with evaluation</p></li>
<li><p><strong>ret_avg_curr</strong> – Average return for the current parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.pepg">
<span id="pepg"></span><h2>pepg<a class="headerlink" href="#module-pyrado.algorithms.pepg" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.pepg.PEPG">
<em class="property">class </em><code class="sig-name descname">PEPG</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_dir</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env">pyrado.environments.base.Env</a></span></em>, <em class="sig-param"><span class="n">policy</span><span class="p">:</span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a></span></em>, <em class="sig-param"><span class="n">max_iter</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">num_rollouts</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">expl_std_init</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">expl_std_min</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">pop_size</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">clip_ratio_std</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.05</span></em>, <em class="sig-param"><span class="n">normalize_update</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">transform_returns</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">num_workers</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">lr</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0005</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/pepg.html#PEPG"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.pepg.PEPG" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.parameter_exploring.ParameterExploring" title="pyrado.algorithms.parameter_exploring.ParameterExploring"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.parameter_exploring.ParameterExploring</span></code></a></p>
<p>Parameter-Exploring Policy Gradients (PEPG)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] F. Sehnke, C. Osendorfer, T. Rueckstiess, A. Graves, J. Peters, J. Schmidhuber, “Parameter-exploring
Policy Gradients”, Neural Networks, 2010</p>
</div>
<dl class="py attribute">
<dt id="pyrado.algorithms.pepg.PEPG.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'pepg'</em><a class="headerlink" href="#pyrado.algorithms.pepg.PEPG.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.pepg.PEPG.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">param_results</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult" title="pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult">pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult</a></span></em>, <em class="sig-param"><span class="n">ret_avg_curr</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/pepg.html#PEPG.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.pepg.PEPG.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the policy from the given samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_results</strong> – Sampled parameters with evaluation</p></li>
<li><p><strong>ret_avg_curr</strong> – Average return for the current parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyrado.algorithms.pepg.rank_transform">
<code class="sig-name descname">rank_transform</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">arr</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">centered</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="_modules/pyrado/algorithms/pepg.html#rank_transform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.pepg.rank_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform a 1-dim ndarray with arbitrary scalar values to an array with equally spaced rank values.
This is a nonlinear transform.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>arr</strong> – input array</p></li>
<li><p><strong>centered</strong> – if the transform should by centered around zero</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>transformed array</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.power">
<span id="power"></span><h2>power<a class="headerlink" href="#module-pyrado.algorithms.power" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.power.PoWER">
<em class="property">class </em><code class="sig-name descname">PoWER</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_dir</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env">pyrado.environments.base.Env</a></span></em>, <em class="sig-param"><span class="n">policy</span><span class="p">:</span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a></span></em>, <em class="sig-param"><span class="n">max_iter</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">pop_size</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">num_rollouts</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">num_is_samples</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">expl_std_init</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">expl_std_min</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">symm_sampling</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">num_workers</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">logger</span><span class="p">:</span> <span class="n"><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger">pyrado.logger.step.StepLogger</a></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/power.html#PoWER"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.power.PoWER" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.parameter_exploring.ParameterExploring" title="pyrado.algorithms.parameter_exploring.ParameterExploring"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.parameter_exploring.ParameterExploring</span></code></a></p>
<p>Return-based variant of Policy learning by Weighting Exploration with the Returns (PoWER)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>PoWER was designed for linear policies.
PoWER is must use positive reward functions (improper probability distribution) [1, p.10].
The original implementation is tailored to movement primitives like DMPs.</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] J. Kober and J. Peters, “Policy Search for Motor Primitives in Robotics”, Machine Learning, 2011</p>
</div>
<dl class="py attribute">
<dt id="pyrado.algorithms.power.PoWER.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'power'</em><a class="headerlink" href="#pyrado.algorithms.power.PoWER.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.power.PoWER.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seed</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/power.html#PoWER.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.power.PoWER.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.power.PoWER.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">param_results</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult" title="pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult">pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult</a></span></em>, <em class="sig-param"><span class="n">ret_avg_curr</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/power.html#PoWER.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.power.PoWER.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the policy from the given samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_results</strong> – Sampled parameters with evaluation</p></li>
<li><p><strong>ret_avg_curr</strong> – Average return for the current parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.ppo">
<span id="ppo"></span><h2>ppo<a class="headerlink" href="#module-pyrado.algorithms.ppo" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.ppo.PPO">
<em class="property">class </em><code class="sig-name descname">PPO</code><span class="sig-paren">(</span><em class="sig-param">save_dir: str</em>, <em class="sig-param">env: pyrado.environments.base.Env</em>, <em class="sig-param">policy: pyrado.policies.base.Policy</em>, <em class="sig-param">critic: pyrado.algorithms.advantage.GAE</em>, <em class="sig-param">max_iter: int</em>, <em class="sig-param">min_rollouts: int = None</em>, <em class="sig-param">min_steps: int = None</em>, <em class="sig-param">num_epoch: int = 3</em>, <em class="sig-param">eps_clip: float = 0.1</em>, <em class="sig-param">batch_size: int = 64</em>, <em class="sig-param">std_init: float = 1.0</em>, <em class="sig-param">num_workers: int = 4</em>, <em class="sig-param">max_grad_norm: float = None</em>, <em class="sig-param">lr: float = 0.0005</em>, <em class="sig-param">lr_scheduler=None</em>, <em class="sig-param">lr_scheduler_hparam: [&lt;class 'dict'&gt;</em>, <em class="sig-param">None] = None</em>, <em class="sig-param">logger: pyrado.logger.step.StepLogger = None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/ppo.html#PPO"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.ppo.PPO" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.actor_critic.ActorCritic" title="pyrado.algorithms.actor_critic.ActorCritic"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.actor_critic.ActorCritic</span></code></a></p>
<p>Proximal Policy Optimization (PPO)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] J. Schulmann,  F. Wolski, P. Dhariwal, A. Radford, O. Klimov, “Proximal Policy Optimization Algorithms”,
arXiv, 2017</p>
<p>[2] D.P. Kingma, J. Ba, “Adam: A Method for Stochastic Optimization”, ICLR, 2015</p>
</div>
<dl class="py method">
<dt id="pyrado.algorithms.ppo.PPO.expl_strat">
<em class="property">property </em><code class="sig-name descname">expl_strat</code><a class="headerlink" href="#pyrado.algorithms.ppo.PPO.expl_strat" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the algorithm’s exploration strategy.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.ppo.PPO.loss_fcn">
<code class="sig-name descname">loss_fcn</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">log_probs</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">log_probs_old</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">adv</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/algorithms/ppo.html#PPO.loss_fcn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.ppo.PPO.loss_fcn" title="Permalink to this definition">¶</a></dt>
<dd><p>PPO loss function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log_probs</strong> – logarithm of the probabilities of the taken actions using the updated policy</p></li>
<li><p><strong>log_probs_old</strong> – logarithm of the probabilities of the taken actions using the old policy</p></li>
<li><p><strong>adv</strong> – advantage values</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>loss value</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.ppo.PPO.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'ppo'</em><a class="headerlink" href="#pyrado.algorithms.ppo.PPO.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.ppo.PPO.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rollouts</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a><span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/ppo.html#PPO.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.ppo.PPO.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the actor and critic parameters from the given batch of rollouts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rollouts</strong> – batch of rollouts</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.algorithms.ppo.PPO2">
<em class="property">class </em><code class="sig-name descname">PPO2</code><span class="sig-paren">(</span><em class="sig-param">save_dir: str</em>, <em class="sig-param">env: pyrado.environments.base.Env</em>, <em class="sig-param">policy: pyrado.policies.base.Policy</em>, <em class="sig-param">critic: pyrado.algorithms.advantage.GAE</em>, <em class="sig-param">max_iter: int</em>, <em class="sig-param">min_rollouts: int = None</em>, <em class="sig-param">min_steps: int = None</em>, <em class="sig-param">num_epoch: int = 3</em>, <em class="sig-param">eps_clip: float = 0.1</em>, <em class="sig-param">value_fcn_coeff: float = 0.5</em>, <em class="sig-param">entropy_coeff: float = 0.001</em>, <em class="sig-param">batch_size: int = 32</em>, <em class="sig-param">std_init: float = 1.0</em>, <em class="sig-param">num_workers: int = 4</em>, <em class="sig-param">max_grad_norm: float = None</em>, <em class="sig-param">lr: float = 0.0005</em>, <em class="sig-param">lr_scheduler=None</em>, <em class="sig-param">lr_scheduler_hparam: [&lt;class 'dict'&gt;</em>, <em class="sig-param">None] = None</em>, <em class="sig-param">logger: pyrado.logger.step.StepLogger = None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/ppo.html#PPO2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.ppo.PPO2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.actor_critic.ActorCritic" title="pyrado.algorithms.actor_critic.ActorCritic"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.actor_critic.ActorCritic</span></code></a></p>
<p>Variant of Proximal Policy Optimization (PPO)
PPO2 differs from PPO by also clipping the value function and standardizing the advantages.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>PPO2 refers to the OpenAI version of PPO which is a GPU-enabled implementation. However, this one is not!</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] OpenAI Stable Baselines Documentation, <a class="reference external" href="https://stable-baselines.readthedocs.io/en/master/modules/ppo2.html">https://stable-baselines.readthedocs.io/en/master/modules/ppo2.html</a></p>
<p>[2] J. Schulmann,  F. Wolski, P. Dhariwal, A. Radford, O. Klimov, “Proximal Policy Optimization Algorithms”,
arXiv, 2017</p>
<p>[3] D.P. Kingma, J. Ba, “Adam: A Method for Stochastic Optimization”, ICLR, 2015</p>
</div>
<dl class="py method">
<dt id="pyrado.algorithms.ppo.PPO2.expl_strat">
<em class="property">property </em><code class="sig-name descname">expl_strat</code><a class="headerlink" href="#pyrado.algorithms.ppo.PPO2.expl_strat" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the algorithm’s exploration strategy.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.ppo.PPO2.loss_fcn">
<code class="sig-name descname">loss_fcn</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">log_probs</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">log_probs_old</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">adv</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">v_pred</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">v_pred_old</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">v_targ</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/algorithms/ppo.html#PPO2.loss_fcn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.ppo.PPO2.loss_fcn" title="Permalink to this definition">¶</a></dt>
<dd><p>PPO2 loss function</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log_probs</strong> – logarithm of the probabilities of the taken actions using the updated policy</p></li>
<li><p><strong>log_probs_old</strong> – logarithm of the probabilities of the taken actions using the old policy</p></li>
<li><p><strong>adv</strong> – advantage values</p></li>
<li><p><strong>v_pred</strong> – predicted value function values</p></li>
<li><p><strong>v_pred_old</strong> – predicted value function values using the old value function</p></li>
<li><p><strong>v_targ</strong> – target value function values</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>combined loss value</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.ppo.PPO2.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'ppo2'</em><a class="headerlink" href="#pyrado.algorithms.ppo.PPO2.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.ppo.PPO2.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rollouts</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a><span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/ppo.html#PPO2.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.ppo.PPO2.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the actor and critic parameters from the given batch of rollouts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rollouts</strong> – batch of rollouts</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.predefined_lqr">
<span id="predefined-lqr"></span><h2>predefined_lqr<a class="headerlink" href="#module-pyrado.algorithms.predefined_lqr" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.predefined_lqr.LQR">
<em class="property">class </em><code class="sig-name descname">LQR</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_dir</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environments.html#pyrado.environments.sim_base.SimEnv" title="pyrado.environments.sim_base.SimEnv">pyrado.environments.sim_base.SimEnv</a></span></em>, <em class="sig-param"><span class="n">policy</span><span class="p">:</span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a></span></em>, <em class="sig-param"><span class="n">min_rollouts</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">min_steps</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_workers</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">logger</span><span class="p">:</span> <span class="n"><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger">pyrado.logger.step.StepLogger</a></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ball_z_dim_mismatch</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/predefined_lqr.html#LQR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.predefined_lqr.LQR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.Algorithm</span></code></a></p>
<p>Linear Quadratic Regulator created using the control module</p>
<dl class="py attribute">
<dt id="pyrado.algorithms.predefined_lqr.LQR.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'lqr'</em><a class="headerlink" href="#pyrado.algorithms.predefined_lqr.LQR.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.predefined_lqr.LQR.save_snapshot">
<code class="sig-name descname">save_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/predefined_lqr.html#LQR.save_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.predefined_lqr.LQR.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.predefined_lqr.LQR.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/predefined_lqr.html#LQR.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.predefined_lqr.LQR.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.predefined_lqr.LQR.stopping_criterion_met">
<code class="sig-name descname">stopping_criterion_met</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/pyrado/algorithms/predefined_lqr.html#LQR.stopping_criterion_met"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.predefined_lqr.LQR.stopping_criterion_met" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the all eigenvalues of the closed loop system are negative.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.reps">
<span id="reps"></span><h2>reps<a class="headerlink" href="#module-pyrado.algorithms.reps" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.reps.REPS">
<em class="property">class </em><code class="sig-name descname">REPS</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_dir</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env">pyrado.environments.base.Env</a></span></em>, <em class="sig-param"><span class="n">policy</span><span class="p">:</span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a></span></em>, <em class="sig-param"><span class="n">max_iter</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">eps</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">num_rollouts</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">pop_size</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">expl_std_init</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">expl_std_min</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.01</span></em>, <em class="sig-param"><span class="n">symm_sampling</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">num_workers</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">num_epoch_dual</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">softmax_transform</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">use_map</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">grad_free_optim</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">lr_dual</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0005</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/reps.html#REPS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.reps.REPS" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.parameter_exploring.ParameterExploring" title="pyrado.algorithms.parameter_exploring.ParameterExploring"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.parameter_exploring.ParameterExploring</span></code></a></p>
<p>Episodic variant of Relative Entropy Policy Search (REPS)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] J. Peters, K. Mülling, Y. Altuen, “Relative Entropy Policy Search”, AAAI, 2010
[2] A. Abdolmaleki, J.T. Springenberg, J. Degrave, S. Bohez, Y. Tassa, D. Belov, N. Heess, M. Riedmiller,</p>
<blockquote>
<div><p>“Relative Entropy Regularized Policy Iteration”, arXiv, 2018</p>
</div></blockquote>
<dl class="simple">
<dt>[3] This implementation is inspired by the work of H. Abdulsamad</dt><dd><p><a class="reference external" href="https://github.com/hanyas/rl/blob/master/rl/ereps/ereps.py">https://github.com/hanyas/rl/blob/master/rl/ereps/ereps.py</a></p>
</dd>
</dl>
</div>
<dl class="py method">
<dt id="pyrado.algorithms.reps.REPS.dual_eval">
<code class="sig-name descname">dual_eval</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rets</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/algorithms/reps.html#REPS.dual_eval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.reps.REPS.dual_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the REPS dual function value for policy evaluation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rets</strong> – return values per policy sample after averaging over multiple rollouts using the same policy</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dual loss value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.reps.REPS.dual_impr">
<code class="sig-name descname">dual_impr</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">param_samples</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">w</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/algorithms/reps.html#REPS.dual_impr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.reps.REPS.dual_impr" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the REPS dual function value for policy improvement.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_samples</strong> – all sampled policy parameters</p></li>
<li><p><strong>w</strong> – weights of the policy parameter samples</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dual loss value</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.reps.REPS.eta">
<em class="property">property </em><code class="sig-name descname">eta</code><a class="headerlink" href="#pyrado.algorithms.reps.REPS.eta" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the Lagrange multiplier <span class="math notranslate nohighlight">\(\eta\)</span>. In [2], <span class="math notranslate nohighlight">\(/eta\)</span> is called <span class="math notranslate nohighlight">\(/alpha\)</span>.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.reps.REPS.minimize">
<code class="sig-name descname">minimize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">loss_fcn</span><span class="p">:</span> <span class="n">Callable</span></em>, <em class="sig-param"><span class="n">rets</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">param_samples</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">w</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/reps.html#REPS.minimize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.reps.REPS.minimize" title="Permalink to this definition">¶</a></dt>
<dd><p>Minimize the given dual function. Iterate num_epoch_dual times.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss_fcn</strong> – function to minimize, different for <cite>wml()</cite> and <cite>wmap()</cite></p></li>
<li><p><strong>rets</strong> – return values per policy sample after averaging over multiple rollouts using the same policy</p></li>
<li><p><strong>param_samples</strong> – all sampled policy parameters</p></li>
<li><p><strong>w</strong> – weights of the policy parameter samples</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.reps.REPS.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'reps'</em><a class="headerlink" href="#pyrado.algorithms.reps.REPS.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.reps.REPS.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">param_results</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult" title="pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult">pyrado.sampling.parameter_exploration_sampler.ParameterSamplingResult</a></span></em>, <em class="sig-param"><span class="n">ret_avg_curr</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/reps.html#REPS.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.reps.REPS.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the policy from the given samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_results</strong> – Sampled parameters with evaluation</p></li>
<li><p><strong>ret_avg_curr</strong> – Average return for the current parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.reps.REPS.weights">
<code class="sig-name descname">weights</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rets</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/algorithms/reps.html#REPS.weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.reps.REPS.weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the wights which are used to weights thy policy samples by their return.
As stated in [2, sec 4.1], we could calculate weights using any rank preserving transformation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rets</strong> – return values per policy sample after averaging over multiple rollouts using the same policy</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>weights of the policy parameter samples</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.reps.REPS.wmap">
<code class="sig-name descname">wmap</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">param_samples</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">w</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/reps.html#REPS.wmap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.reps.REPS.wmap" title="Permalink to this definition">¶</a></dt>
<dd><p>Weighted maximum a-posteriori likelihood update of the policy’s mean and the exploration strategy’s covariance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_samples</strong> – all sampled policy parameters</p></li>
<li><p><strong>w</strong> – weights of the policy parameter samples</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.reps.REPS.wml">
<code class="sig-name descname">wml</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">param_samples</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">w</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/reps.html#REPS.wml"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.reps.REPS.wml" title="Permalink to this definition">¶</a></dt>
<dd><p>Weighted maximum likelihood update of the policy’s mean and the exploration strategy’s covariance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>param_samples</strong> – all sampled policy parameters</p></li>
<li><p><strong>w</strong> – weights of the policy parameter samples</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.sac">
<span id="sac"></span><h2>sac<a class="headerlink" href="#module-pyrado.algorithms.sac" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.sac.SAC">
<em class="property">class </em><code class="sig-name descname">SAC</code><span class="sig-paren">(</span><em class="sig-param">save_dir: str</em>, <em class="sig-param">env: pyrado.environments.base.Env</em>, <em class="sig-param">policy: pyrado.policies.two_headed.TwoHeadedPolicy</em>, <em class="sig-param">q_fcn_1: pyrado.policies.base.Policy</em>, <em class="sig-param">q_fcn_2: pyrado.policies.base.Policy</em>, <em class="sig-param">memory_size: int</em>, <em class="sig-param">gamma: float</em>, <em class="sig-param">max_iter: int</em>, <em class="sig-param">num_batch_updates: int</em>, <em class="sig-param">tau: float = 0.995</em>, <em class="sig-param">alpha_init: float = 0.2</em>, <em class="sig-param">learn_alpha: bool = True</em>, <em class="sig-param">target_update_intvl: int = 1</em>, <em class="sig-param">standardize_rew: bool = True</em>, <em class="sig-param">batch_size: int = 500</em>, <em class="sig-param">min_rollouts: int = None</em>, <em class="sig-param">min_steps: int = None</em>, <em class="sig-param">num_workers: int = 4</em>, <em class="sig-param">max_grad_norm: float = 5.0</em>, <em class="sig-param">lr: float = 0.0003</em>, <em class="sig-param">lr_scheduler=None</em>, <em class="sig-param">lr_scheduler_hparam: [&lt;class 'dict'&gt;</em>, <em class="sig-param">None] = None</em>, <em class="sig-param">logger: pyrado.logger.step.StepLogger = None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/sac.html#SAC"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.sac.SAC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.Algorithm</span></code></a></p>
<p>Soft Actor-Critic (SAC) variant with stochastic policy and two Q-functions and two Q-targets (no V-function)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] T. Haarnoja, A. Zhou, P. Abbeel, S. Levine, “Soft Actor-Critic: Off-Policy Maximum Entropy Deep
Reinforcement Learning with a Stochastic Actor”, ICML, 2018</p>
<dl class="simple">
<dt>[2] This implementation was inspired by <a class="reference external" href="https://github.com/pranz24/pytorch-soft-actor-critic">https://github.com/pranz24/pytorch-soft-actor-critic</a></dt><dd><p>which is seems to be based on <a class="reference external" href="https://github.com/vitchyr/rlkit">https://github.com/vitchyr/rlkit</a></p>
</dd>
</dl>
</div>
<dl class="py method">
<dt id="pyrado.algorithms.sac.SAC.alpha">
<em class="property">property </em><code class="sig-name descname">alpha</code><a class="headerlink" href="#pyrado.algorithms.sac.SAC.alpha" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the detached entropy coefficient.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.sac.SAC.expl_strat">
<em class="property">property </em><code class="sig-name descname">expl_strat</code><a class="headerlink" href="#pyrado.algorithms.sac.SAC.expl_strat" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the algorithm’s exploration strategy.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.sac.SAC.init_modules">
<code class="sig-name descname">init_modules</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">warmstart</span><span class="p">:</span> <span class="n">bool</span></em>, <em class="sig-param"><span class="n">suffix</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">''</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/sac.html#SAC.init_modules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.sac.SAC.init_modules" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the algorithm’s learnable modules, e.g. a policy or value function.
Overwrite this method if the algorithm uses a learnable module aside the policy, e.g. a value function.
This method is similar to <cite>load_snapshot()</cite> which also loads additional algorithm members like environments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>warmstart</strong> – if <cite>True</cite>, the algorithm starts learning with an initialization. This can either be the a
fixed parameter vector, or the results of the previous iteration</p></li>
<li><p><strong>suffix</strong> – keyword for <cite>meta_info</cite> when loading from previous iteration</p></li>
<li><p><strong>kwargs</strong> – keyword arguments for initialization, e.g. <cite>policy_param_init</cite> or <cite>valuefcn_param_init</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.sac.SAC.load_snapshot">
<code class="sig-name descname">load_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">load_dir</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/sac.html#SAC.load_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.sac.SAC.load_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to load the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_dir</strong> – explicit directory to load from, if <cite>None</cite> (default) <cite>self._save_dir</cite> is used</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.sac.SAC.memory">
<em class="property">property </em><code class="sig-name descname">memory</code><a class="headerlink" href="#pyrado.algorithms.sac.SAC.memory" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the replay memory.</p>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.sac.SAC.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'sac'</em><a class="headerlink" href="#pyrado.algorithms.sac.SAC.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.sac.SAC.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seed</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/sac.html#SAC.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.sac.SAC.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.sac.SAC.save_snapshot">
<code class="sig-name descname">save_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/sac.html#SAC.save_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.sac.SAC.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.sac.SAC.soft_update">
<em class="property">static </em><code class="sig-name descname">soft_update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">target</span><span class="p">:</span> <span class="n">torch.nn.modules.module.Module</span></em>, <em class="sig-param"><span class="n">source</span><span class="p">:</span> <span class="n">torch.nn.modules.module.Module</span></em>, <em class="sig-param"><span class="n">tau</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.995</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/sac.html#SAC.soft_update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.sac.SAC.soft_update" title="Permalink to this definition">¶</a></dt>
<dd><p>Moving average update, a.k.a. Polyak update.
Modifies the input argument <cite>target</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>target</strong> – PyTroch module with parameters to be updated</p></li>
<li><p><strong>source</strong> – PyTroch module with parameters to update to</p></li>
<li><p><strong>tau</strong> – interpolation factor for averaging, between 0 and 1</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.sac.SAC.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/sac.html#SAC.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.sac.SAC.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.sac.SAC.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/sac.html#SAC.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.sac.SAC.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the policy’s and Q-functions’ parameters on transitions sampled from the replay memory.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.simopt">
<span id="simopt"></span><h2>simopt<a class="headerlink" href="#module-pyrado.algorithms.simopt" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.simopt.SimOpt">
<em class="property">class </em><code class="sig-name descname">SimOpt</code><span class="sig-paren">(</span><em class="sig-param">save_dir: str, env_sim: pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper, env_real: [&lt;class 'pyrado.environments.real_base.RealEnv'&gt;, &lt;class 'pyrado.environment_wrappers.base.EnvWrapper'&gt;], subrtn_policy: pyrado.algorithms.base.Algorithm, subrtn_distr: pyrado.algorithms.sysid_via_episodic_rl.SysIdViaEpisodicRL, max_iter: int, num_eval_rollouts: int = 5, thold_succ: float = inf, thold_succ_subrtn: float = -inf, warmstart: bool = True, policy_param_init: torch.Tensor = None, valuefcn_param_init: torch.Tensor = None, subrtn_snapshot_mode: str = 'latest', logger: pyrado.logger.step.StepLogger = None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/simopt.html#SimOpt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.simopt.SimOpt" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.Algorithm</span></code></a></p>
<p>Simulation Optimization (SimOpt)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>A candidate is a set of parameter values for the domain parameter distribution and its value is the
discrepancy between the simulated and real observations (based on a weighted metric).</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] Y. SimOpt, A. Handa, V. Makoviychuk, M. Macklin, J. Issac, N.D. Ratliff, D. Fox, “Closing the Sim-to-Real
Loop: Adapting Simulation Randomization with Real World Experience”, ICRA, 2020</p>
</div>
<dl class="py method">
<dt id="pyrado.algorithms.simopt.SimOpt.eval_behav_policy">
<em class="property">static </em><code class="sig-name descname">eval_behav_policy</code><span class="sig-paren">(</span><em class="sig-param">save_dir: [&lt;class 'str'&gt;, None], env: [&lt;class 'pyrado.environments.real_base.RealEnv'&gt;, &lt;class 'pyrado.environments.sim_base.SimEnv'&gt;, &lt;class 'pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper'&gt;], policy: pyrado.policies.base.Policy, prefix: str, num_rollouts: int, init_states: [&lt;class 'numpy.ndarray'&gt;, None] = None, seed: int = 1001</em><span class="sig-paren">)</span> &#x2192; Sequence<span class="p">[</span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a><span class="p">]</span><a class="reference internal" href="_modules/pyrado/algorithms/simopt.html#SimOpt.eval_behav_policy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.simopt.SimOpt.eval_behav_policy" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate a policy on the target system (real-world platform).
This method is static to facilitate evaluation of specific policies in hindsight.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_dir</strong> – directory to save the snapshots i.e. the results in, if <cite>None</cite> nothing is saved</p></li>
<li><p><strong>env</strong> – environment for evaluation, in the sim-2-sim case this is another simulation instance</p></li>
<li><p><strong>policy</strong> – policy to evaluate</p></li>
<li><p><strong>prefix</strong> – to control the saving for the evaluation of an initial policy, <cite>None</cite> to deactivate</p></li>
<li><p><strong>num_rollouts</strong> – number of rollouts to collect on the target domain</p></li>
<li><p><strong>init_states</strong> – pass the initial states of the real system to sync the simulation (mandatory in this case)</p></li>
<li><p><strong>seed</strong> – seed value for the random number generators, only used when evaluating in simulation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rollouts</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.simopt.SimOpt.eval_ddp_policy">
<em class="property">static </em><code class="sig-name descname">eval_ddp_policy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rollouts_real</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">env_sim</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper" title="pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper">pyrado.environment_wrappers.domain_randomization.MetaDomainRandWrapper</a></span></em>, <em class="sig-param"><span class="n">num_rollouts</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">subrtn_distr</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#pyrado.algorithms.sysid_via_episodic_rl.SysIdViaEpisodicRL" title="pyrado.algorithms.sysid_via_episodic_rl.SysIdViaEpisodicRL">pyrado.algorithms.sysid_via_episodic_rl.SysIdViaEpisodicRL</a></span></em>, <em class="sig-param"><span class="n">subrtn_policy</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm">pyrado.algorithms.base.Algorithm</a></span></em><span class="sig-paren">)</span> &#x2192; float<a class="reference internal" href="_modules/pyrado/algorithms/simopt.html#SimOpt.eval_ddp_policy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.simopt.SimOpt.eval_ddp_policy" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the policy that fits the domain parameter distribution to the observed rollouts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollouts_real</strong> – recorded real-world rollouts</p></li>
<li><p><strong>env_sim</strong> – randomized simulation environment a.k.a. source domain</p></li>
<li><p><strong>num_rollouts</strong> – number of rollouts to collect on the target domain</p></li>
<li><p><strong>subrtn_distr</strong> – algorithm which performs the optimization of the domain parameter distribution policy</p></li>
<li><p><strong>subrtn_policy</strong> – algorithm which performs the optimization of the behavioral policy (and value-function)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>average system identification loss</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.simopt.SimOpt.iteration_key">
<code class="sig-name descname">iteration_key</code><em class="property">: str</em><em class="property"> = 'simopt_iteration'</em><a class="headerlink" href="#pyrado.algorithms.simopt.SimOpt.iteration_key" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.simopt.SimOpt.load_snapshot">
<code class="sig-name descname">load_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">load_dir</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/simopt.html#SimOpt.load_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.simopt.SimOpt.load_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to load the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_dir</strong> – explicit directory to load from, if <cite>None</cite> (default) <cite>self._save_dir</cite> is used</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.simopt.SimOpt.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'simopt'</em><a class="headerlink" href="#pyrado.algorithms.simopt.SimOpt.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.simopt.SimOpt.save_snapshot">
<code class="sig-name descname">save_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/simopt.html#SimOpt.save_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.simopt.SimOpt.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.simopt.SimOpt.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'latest'</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/simopt.html#SimOpt.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.simopt.SimOpt.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.simopt.SimOpt.train_ddp_policy">
<code class="sig-name descname">train_ddp_policy</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rollouts_real</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">prefix</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; float<a class="reference internal" href="_modules/pyrado/algorithms/simopt.html#SimOpt.train_ddp_policy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.simopt.SimOpt.train_ddp_policy" title="Permalink to this definition">¶</a></dt>
<dd><p>Train and evaluate the policy that parametrizes domain randomizer, such that the loss given by the instance of
<cite>SysIdViaEpisodicRL</cite> is minimized.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollouts_real</strong> – recorded real-world rollouts</p></li>
<li><p><strong>prefix</strong> – set a prefix to the saved file name by passing it to <cite>meta_info</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>average system identification loss</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.simopt.SimOpt.train_policy_sim">
<code class="sig-name descname">train_policy_sim</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">cand</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">prefix</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span> &#x2192; float<a class="reference internal" href="_modules/pyrado/algorithms/simopt.html#SimOpt.train_policy_sim"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.simopt.SimOpt.train_policy_sim" title="Permalink to this definition">¶</a></dt>
<dd><p>Train a policy in simulation for given hyper-parameters from the domain randomizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cand</strong> – hyper-parameters for the domain parameter distribution (need be compatible with the randomizer)</p></li>
<li><p><strong>prefix</strong> – set a prefix to the saved file name by passing it to <cite>meta_info</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>estimated return of the trained policy in the target domain</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.spota">
<span id="spota"></span><h2>spota<a class="headerlink" href="#module-pyrado.algorithms.spota" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.spota.SPOTA">
<em class="property">class </em><code class="sig-name descname">SPOTA</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_dir</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.domain_randomization.DomainRandWrapperBuffer" title="pyrado.environment_wrappers.domain_randomization.DomainRandWrapperBuffer">pyrado.environment_wrappers.domain_randomization.DomainRandWrapperBuffer</a></span></em>, <em class="sig-param"><span class="n">subrtn_cand</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm">pyrado.algorithms.base.Algorithm</a></span></em>, <em class="sig-param"><span class="n">subrtn_refs</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm">pyrado.algorithms.base.Algorithm</a></span></em>, <em class="sig-param"><span class="n">max_iter</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">alpha</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">beta</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">nG</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">nJ</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">ntau</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">nc_init</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">nr_init</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">sequence_cand</span><span class="p">:</span> <span class="n">callable</span></em>, <em class="sig-param"><span class="n">sequence_refs</span><span class="p">:</span> <span class="n">callable</span></em>, <em class="sig-param"><span class="n">warmstart_cand</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">warmstart_refs</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">cand_policy_param_init</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">cand_critic_param_init</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">num_bs_reps</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1000</span></em>, <em class="sig-param"><span class="n">studentized_ci</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">base_seed</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">logger</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/spota.html#SPOTA"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.spota.SPOTA" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.Algorithm</span></code></a></p>
<p>Simulation-based Policy Optimization with Probability Assessment (SPOTA)</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We use each domain parameter set <span class="math notranslate nohighlight">\(\xi_{j,nr}\)</span> for <span class="math notranslate nohighlight">\(n_{\tau}\)</span> rollouts.
The candidate and the reference policies must have the same architecture!</p>
</div>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] F. Muratore, M. Gienger, J. Peters, “Assessing Transferability from Simulation to Reality for Reinforcement
Learning”, PAMI, 2019</p>
<p>[2] W. Mak, D.P. Morton, and R.K. Wood, “Monte Carlo bounding techniques for determining solution quality in
stochastic programs”, Oper. Res. Lett., 1999</p>
</div>
<dl class="py attribute">
<dt id="pyrado.algorithms.spota.SPOTA.iteration_key">
<code class="sig-name descname">iteration_key</code><em class="property">: str</em><em class="property"> = 'spota_iteration'</em><a class="headerlink" href="#pyrado.algorithms.spota.SPOTA.iteration_key" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.spota.SPOTA.load_snapshot">
<code class="sig-name descname">load_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">load_dir</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/spota.html#SPOTA.load_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.spota.SPOTA.load_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to load the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_dir</strong> – explicit directory to load from, if <cite>None</cite> (default) <cite>self._save_dir</cite> is used</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.spota.SPOTA.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'spota'</em><a class="headerlink" href="#pyrado.algorithms.spota.SPOTA.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.spota.SPOTA.save_snapshot">
<code class="sig-name descname">save_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/spota.html#SPOTA.save_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.spota.SPOTA.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.spota.SPOTA.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/spota.html#SPOTA.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.spota.SPOTA.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.spota.SPOTA.stopping_criterion_met">
<code class="sig-name descname">stopping_criterion_met</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/pyrado/algorithms/spota.html#SPOTA.stopping_criterion_met"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.spota.SPOTA.stopping_criterion_met" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the upper confidence bound on the optimality gap is smaller than the specified threshold.
.. note:: The UCBOG is equal to zero if all optimality gap samples are negative.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.spota.SPOTA.subroutines">
<em class="property">property </em><code class="sig-name descname">subroutines</code><a class="headerlink" href="#pyrado.algorithms.spota.SPOTA.subroutines" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.svpg">
<span id="svpg"></span><h2>svpg<a class="headerlink" href="#module-pyrado.algorithms.svpg" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.svpg.SVPG">
<em class="property">class </em><code class="sig-name descname">SVPG</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">save_dir</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env">pyrado.environments.base.Env</a></span></em>, <em class="sig-param"><span class="n">particle_hparam</span><span class="p">:</span> <span class="n">dict</span></em>, <em class="sig-param"><span class="n">max_iter</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">num_particles</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">temperature</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">lr</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">horizon</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">std_init</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">min_rollouts</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">min_steps</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">10000</span></em>, <em class="sig-param"><span class="n">num_workers</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">serial</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">logger</span><span class="p">:</span> <span class="n"><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger">pyrado.logger.step.StepLogger</a></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/svpg.html#SVPG"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.svpg.SVPG" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.Algorithm</span></code></a></p>
<p>Stein Variational Policy Gradient (SVPG)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] Yang Liu, Prajit Ramachandran, Qiang Liu, Jian Peng, “Stein Variational Policy Gradient”, arXiv, 2017</p>
</div>
<dl class="py method">
<dt id="pyrado.algorithms.svpg.SVPG.kernel">
<code class="sig-name descname">kernel</code><span class="sig-paren">(</span><em class="sig-param">X: torch.Tensor) -&gt; (&lt;class 'torch.Tensor'&gt;</em>, <em class="sig-param">&lt;class 'torch.Tensor'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/svpg.html#SVPG.kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.svpg.SVPG.kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the RBF-kernel and the corresponding derivatives.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>X</strong> – the tensor to compute the kernel from</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the kernel and its derivatives</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.svpg.SVPG.load_snapshot">
<code class="sig-name descname">load_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">load_dir</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/svpg.html#SVPG.load_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.svpg.SVPG.load_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to load the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_dir</strong> – explicit directory to load from, if <cite>None</cite> (default) <cite>self._save_dir</cite> is used</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.svpg.SVPG.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'svpg'</em><a class="headerlink" href="#pyrado.algorithms.svpg.SVPG.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.svpg.SVPG.save_snapshot">
<code class="sig-name descname">save_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/svpg.html#SVPG.save_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.svpg.SVPG.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.svpg.SVPG.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/svpg.html#SVPG.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.svpg.SVPG.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.svpg.SVPG.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rollouts</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a><span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/svpg.html#SVPG.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.svpg.SVPG.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Train the particles <span class="math notranslate nohighlight">\(mu\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rollouts</strong> – rewards collected from the rollout</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.algorithms.svpg.SVPGParticle">
<em class="property">class </em><code class="sig-name descname">SVPGParticle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">actor</span><span class="p">:</span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a></span></em>, <em class="sig-param"><span class="n">critic</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#pyrado.algorithms.advantage.GAE" title="pyrado.algorithms.advantage.GAE">pyrado.algorithms.advantage.GAE</a></span></em>, <em class="sig-param"><span class="n">use_cuda</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/svpg.html#SVPGParticle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.svpg.SVPGParticle" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.policies.base.Policy</span></code></a></p>
<p>An actor-critic particle of type <cite>Policy</cite>.
Particles’ parameters are considered to be part of the parameter distribution optimized by the SVPG algorithm.</p>
<dl class="py method">
<dt id="pyrado.algorithms.svpg.SVPGParticle.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/algorithms/svpg.html#SVPGParticle.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.svpg.SVPGParticle.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action given an observation. Forwards to the actor head.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – the observation</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the action</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.svpg.SVPGParticle.init_param">
<code class="sig-name descname">init_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">init_values</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/svpg.html#SVPGParticle.init_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.svpg.SVPGParticle.init_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Initializes the parameters of the actor and critic networks with given values.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>init_values</strong> – the initial values for the actor and critic networks</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.svpg.SVPGParticle.value">
<code class="sig-name descname">value</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/algorithms/svpg.html#SVPGParticle.value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.svpg.SVPGParticle.value" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict the value of a given observation. Forwards to the critic head.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obs</strong> – the observation</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the predicted value</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.sysid_via_episodic_rl">
<span id="sysid-via-episodic-rl"></span><h2>sysid_via_episodic_rl<a class="headerlink" href="#module-pyrado.algorithms.sysid_via_episodic_rl" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.sysid_via_episodic_rl.SysIdViaEpisodicRL">
<em class="property">class </em><code class="sig-name descname">SysIdViaEpisodicRL</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">subrtn</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm">pyrado.algorithms.base.Algorithm</a></span></em>, <em class="sig-param"><span class="n">behavior_policy</span><span class="p">:</span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a></span></em>, <em class="sig-param"><span class="n">num_rollouts_per_distr</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">metric</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>Callable<span class="p">[</span><span class="p">[</span>numpy.ndarray<span class="p">]</span><span class="p">, </span>numpy.ndarray<span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">obs_dim_weight</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>list<span class="p">, </span>numpy.ndarray<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">w_abs</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.5</span></em>, <em class="sig-param"><span class="n">w_sq</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">num_workers</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">4</span></em>, <em class="sig-param"><span class="n">base_seed</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">1001</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/sysid_via_episodic_rl.html#SysIdViaEpisodicRL"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.sysid_via_episodic_rl.SysIdViaEpisodicRL" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.Algorithm</span></code></a></p>
<p>Wrapper to frame black-box system identification as an episodic reinforcement learning problem</p>
<dl class="py method">
<dt id="pyrado.algorithms.sysid_via_episodic_rl.SysIdViaEpisodicRL.default_metric">
<em class="property">static </em><code class="sig-name descname">default_metric</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">err</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">w_abs</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">w_sq</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">obs_dim_weight</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/sysid_via_episodic_rl.html#SysIdViaEpisodicRL.default_metric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.sysid_via_episodic_rl.SysIdViaEpisodicRL.default_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the weighted linear combination of the observation error’s MAE and MSE, averaged over time</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In contrast to [1], we are using the mean absolute error and the mean squared error instead of the L1 and
the L2 norm. The reason for this is that longer time series would be punished otherwise.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>err</strong> – error signal with time steps along the first dimension</p></li>
<li><p><strong>w_abs</strong> – weight for the mean absolute errors</p></li>
<li><p><strong>w_sq</strong> – weight for the mean squared errors</p></li>
<li><p><strong>obs_dim_weight</strong> – (diagonal) weight matrix for the different observation dimensions</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>weighted linear combination of the error’s MAE and MSE, averaged over time</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.sysid_via_episodic_rl.SysIdViaEpisodicRL.iteration_key">
<code class="sig-name descname">iteration_key</code><em class="property">: str</em><em class="property"> = 'sysiderl_iteration'</em><a class="headerlink" href="#pyrado.algorithms.sysid_via_episodic_rl.SysIdViaEpisodicRL.iteration_key" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.sysid_via_episodic_rl.SysIdViaEpisodicRL.load_snapshot">
<code class="sig-name descname">load_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">load_dir</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/sysid_via_episodic_rl.html#SysIdViaEpisodicRL.load_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.sysid_via_episodic_rl.SysIdViaEpisodicRL.load_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to load the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_dir</strong> – explicit directory to load from, if <cite>None</cite> (default) <cite>self._save_dir</cite> is used</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.sysid_via_episodic_rl.SysIdViaEpisodicRL.loss_fcn">
<code class="sig-name descname">loss_fcn</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rollout_real</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em>, <em class="sig-param"><span class="n">rollout_sim</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em><span class="sig-paren">)</span> &#x2192; float<a class="reference internal" href="_modules/pyrado/algorithms/sysid_via_episodic_rl.html#SysIdViaEpisodicRL.loss_fcn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.sysid_via_episodic_rl.SysIdViaEpisodicRL.loss_fcn" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the discrepancy between two time sequences of observations given metric.
Be sure to align and truncate the rollouts beforehand.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollout_real</strong> – (concatenated) real-world rollout containing the observations</p></li>
<li><p><strong>rollout_sim</strong> – (concatenated) simulated rollout containing the observations</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>discrepancy cost summed over the observation dimensions</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.sysid_via_episodic_rl.SysIdViaEpisodicRL.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'sysiderl'</em><a class="headerlink" href="#pyrado.algorithms.sysid_via_episodic_rl.SysIdViaEpisodicRL.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.sysid_via_episodic_rl.SysIdViaEpisodicRL.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seed</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/sysid_via_episodic_rl.html#SysIdViaEpisodicRL.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.sysid_via_episodic_rl.SysIdViaEpisodicRL.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.sysid_via_episodic_rl.SysIdViaEpisodicRL.save_snapshot">
<code class="sig-name descname">save_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/sysid_via_episodic_rl.html#SysIdViaEpisodicRL.save_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.sysid_via_episodic_rl.SysIdViaEpisodicRL.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.sysid_via_episodic_rl.SysIdViaEpisodicRL.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/sysid_via_episodic_rl.html#SysIdViaEpisodicRL.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.sysid_via_episodic_rl.SysIdViaEpisodicRL.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.sysid_via_episodic_rl.SysIdViaEpisodicRL.subrtn">
<em class="property">property </em><code class="sig-name descname">subrtn</code><a class="headerlink" href="#pyrado.algorithms.sysid_via_episodic_rl.SysIdViaEpisodicRL.subrtn" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the subroutine used for updating the domain parameter distribution.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.sysid_via_episodic_rl.SysIdViaEpisodicRL.truncate_rollouts">
<em class="property">static </em><code class="sig-name descname">truncate_rollouts</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rollouts_real</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">rollouts_sim</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">replicate</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span> &#x2192; Tuple<span class="p">[</span>Sequence<span class="p">[</span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a><span class="p">]</span><span class="p">, </span>Sequence<span class="p">[</span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a><span class="p">]</span><span class="p">]</span><a class="reference internal" href="_modules/pyrado/algorithms/sysid_via_episodic_rl.html#SysIdViaEpisodicRL.truncate_rollouts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.sysid_via_episodic_rl.SysIdViaEpisodicRL.truncate_rollouts" title="Permalink to this definition">¶</a></dt>
<dd><p>In case (some of the) rollouts failed or succeed in one domain, but not in the other, we truncate the longer
observation sequence. When truncating, we compare every of the M real rollouts to every of the N simulated
rollouts, thus replicate the real rollout N times and the simulated rollouts M times.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollouts_real</strong> – M real-world rollouts of different length if <cite>replicate = True</cite>, else K real-world
rollouts of different length</p></li>
<li><p><strong>rollouts_sim</strong> – N simulated rollouts of different length if <cite>replicate = True</cite>, else K simulated
rollouts of different length</p></li>
<li><p><strong>replicate</strong> – if <cite>False</cite> the i-th rollout from <cite>rollouts_real</cite> is (only) compared with the i-th rollout from
<cite>rollouts_sim</cite>, in this case the number of rollouts and the initial states have to match</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>MxN real-world rollouts and MxN simulated rollouts of equal length if <cite>replicate = True</cite>, else
K real-world rollouts and K simulated rollouts of equal length</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.timeseries_prediction">
<span id="timeseries-prediction"></span><h2>timeseries_prediction<a class="headerlink" href="#module-pyrado.algorithms.timeseries_prediction" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.timeseries_prediction.TSPred">
<em class="property">class </em><code class="sig-name descname">TSPred</code><span class="sig-paren">(</span><em class="sig-param">save_dir: str</em>, <em class="sig-param">dataset: pyrado.utils.data_sets.TimeSeriesDataSet</em>, <em class="sig-param">policy: pyrado.policies.base.Policy</em>, <em class="sig-param">max_iter: int</em>, <em class="sig-param">windowed_mode: bool = False</em>, <em class="sig-param">optim_class=&lt;class 'torch.optim.adam.Adam'&gt;</em>, <em class="sig-param">optim_hparam: dict = None</em>, <em class="sig-param">loss_fcn=MSELoss()</em>, <em class="sig-param">lr_scheduler=None</em>, <em class="sig-param">lr_scheduler_hparam: Optional[dict] = None</em>, <em class="sig-param">num_workers: int = 1</em>, <em class="sig-param">seed: Optional[int] = None</em>, <em class="sig-param">logger: pyrado.logger.step.StepLogger = None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/timeseries_prediction.html#TSPred"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.timeseries_prediction.TSPred" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.Algorithm</span></code></a></p>
<p>Train a policy to predict a time series of data.</p>
<dl class="py method">
<dt id="pyrado.algorithms.timeseries_prediction.TSPred.evaluate">
<em class="property">static </em><code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">policy</span><span class="p">:</span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a></span></em>, <em class="sig-param"><span class="n">inps</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">targs</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">windowed_mode</span><span class="p">:</span> <span class="n">bool</span></em>, <em class="sig-param"><span class="n">num_init_samples</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">cascaded_predictions</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">hidden</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>torch.Tensor<span class="p">]</span></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">loss_fcn</span><span class="o">=</span><span class="default_value">MSELoss()</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/timeseries_prediction.html#TSPred.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.timeseries_prediction.TSPred.evaluate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.timeseries_prediction.TSPred.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'tspred'</em><a class="headerlink" href="#pyrado.algorithms.timeseries_prediction.TSPred.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.timeseries_prediction.TSPred.predict">
<em class="property">static </em><code class="sig-name descname">predict</code><span class="sig-paren">(</span><em class="sig-param">policy: pyrado.policies.base.Policy</em>, <em class="sig-param">inp_seq: torch.Tensor</em>, <em class="sig-param">windowed_mode: bool</em>, <em class="sig-param">hidden: Optional[torch.Tensor] = None) -&gt; (&lt;class 'torch.Tensor'&gt;</em>, <em class="sig-param">&lt;class 'torch.Tensor'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/timeseries_prediction.html#TSPred.predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.timeseries_prediction.TSPred.predict" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the hidden states, predict one output given a arbitrary long sequence of inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>policy</strong> – policy used to make the predictions</p></li>
<li><p><strong>inp_seq</strong> – input sequence</p></li>
<li><p><strong>hidden</strong> – initial hidden states</p></li>
<li><p><strong>windowed_mode</strong> – if <cite>True</cite>, fixed length input sequences are provided to the policy which then predicts
one sample, else the complete input sequence is fed to the policy which then predicts
an equally long sequence of samples</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>predicted output and latest hidden state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.timeseries_prediction.TSPred.save_snapshot">
<code class="sig-name descname">save_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/timeseries_prediction.html#TSPred.save_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.timeseries_prediction.TSPred.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.timeseries_prediction.TSPred.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/timeseries_prediction.html#TSPred.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.timeseries_prediction.TSPred.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.udr">
<span id="udr"></span><h2>udr<a class="headerlink" href="#module-pyrado.algorithms.udr" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.udr.UDR">
<em class="property">class </em><code class="sig-name descname">UDR</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environment_wrappers.html#pyrado.environment_wrappers.base.EnvWrapper" title="pyrado.environment_wrappers.base.EnvWrapper">pyrado.environment_wrappers.base.EnvWrapper</a></span></em>, <em class="sig-param"><span class="n">subrtn</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm">pyrado.algorithms.base.Algorithm</a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/udr.html#UDR"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.udr.UDR" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.Algorithm</span></code></a></p>
<p>Uniform Domain Randomization (UDR)</p>
<p>This algorithm barely wraps another algorithm. The main purpose is to check if</p>
<dl class="py method">
<dt id="pyrado.algorithms.udr.UDR.load_snapshot">
<code class="sig-name descname">load_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">load_dir</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/udr.html#UDR.load_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.udr.UDR.load_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to load the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_dir</strong> – explicit directory to load from, if <cite>None</cite> (default) <cite>self._save_dir</cite> is used</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.udr.UDR.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = 'udr'</em><a class="headerlink" href="#pyrado.algorithms.udr.UDR.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.udr.UDR.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seed</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/udr.html#UDR.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.udr.UDR.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.udr.UDR.save_snapshot">
<code class="sig-name descname">save_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/udr.html#UDR.save_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.udr.UDR.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.udr.UDR.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/udr.html#UDR.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.udr.UDR.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.udr.UDR.subroutine">
<em class="property">property </em><code class="sig-name descname">subroutine</code><a class="headerlink" href="#pyrado.algorithms.udr.UDR.subroutine" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.utils">
<span id="utils"></span><h2>utils<a class="headerlink" href="#module-pyrado.algorithms.utils" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.utils.ActionStatistics">
<em class="property">class </em><code class="sig-name descname">ActionStatistics</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">act_distr</span><span class="p">:</span> <span class="n">torch.distributions.distribution.Distribution</span></em>, <em class="sig-param"><span class="n">log_probs</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">entropy</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/utils.html#ActionStatistics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.ActionStatistics" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>act_distr: probability distribution at the given policy output values
log_probs: <span class="math notranslate nohighlight">\(\log (p(act|obs, hidden))\)</span> if hidden exists, else <span class="math notranslate nohighlight">\(\log (p(act|obs))\)</span>
entropy: entropy of the action distribution</p>
<dl class="py method">
<dt id="pyrado.algorithms.utils.ActionStatistics.act_distr">
<em class="property">property </em><code class="sig-name descname">act_distr</code><a class="headerlink" href="#pyrado.algorithms.utils.ActionStatistics.act_distr" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.utils.ActionStatistics.entropy">
<em class="property">property </em><code class="sig-name descname">entropy</code><a class="headerlink" href="#pyrado.algorithms.utils.ActionStatistics.entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.utils.ActionStatistics.log_probs">
<em class="property">property </em><code class="sig-name descname">log_probs</code><a class="headerlink" href="#pyrado.algorithms.utils.ActionStatistics.log_probs" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.algorithms.utils.ReplayMemory">
<em class="property">class </em><code class="sig-name descname">ReplayMemory</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">capacity</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/utils.html#ReplayMemory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.ReplayMemory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for storing step transitions</p>
<dl class="py method">
<dt id="pyrado.algorithms.utils.ReplayMemory.avg_reward">
<code class="sig-name descname">avg_reward</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; float<a class="reference internal" href="_modules/pyrado/algorithms/utils.html#ReplayMemory.avg_reward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.ReplayMemory.avg_reward" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the average reward for all steps stored in the replay memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>average reward</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.utils.ReplayMemory.isempty">
<em class="property">property </em><code class="sig-name descname">isempty</code><a class="headerlink" href="#pyrado.algorithms.utils.ReplayMemory.isempty" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the replay buffer is empty.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.utils.ReplayMemory.memory">
<em class="property">property </em><code class="sig-name descname">memory</code><a class="headerlink" href="#pyrado.algorithms.utils.ReplayMemory.memory" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the replay buffer.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.utils.ReplayMemory.push">
<code class="sig-name descname">push</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ros</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>list<span class="p">, </span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">truncate_last</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/utils.html#ReplayMemory.push"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.ReplayMemory.push" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a sequence of steps and drop of steps if the capacity is exceeded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ros</strong> – list of rollouts or one concatenated rollout</p></li>
<li><p><strong>truncate_last</strong> – remove the last step from each rollout, forwarded to <cite>StepSequence.concat</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.utils.ReplayMemory.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/utils.html#ReplayMemory.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.ReplayMemory.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.utils.ReplayMemory.sample">
<code class="sig-name descname">sample</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span> &#x2192; tuple<a class="reference internal" href="_modules/pyrado/algorithms/utils.html#ReplayMemory.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.ReplayMemory.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample randomly from the replay memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batch_size</strong> – number of samples</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple of transition steps and associated next steps</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyrado.algorithms.utils.compute_action_statistics">
<code class="sig-name descname">compute_action_statistics</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">steps</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em>, <em class="sig-param"><span class="n">expl_strat</span><span class="p">:</span> <span class="n"><a class="reference internal" href="exploration.html#pyrado.exploration.stochastic_action.StochasticActionExplStrat" title="pyrado.exploration.stochastic_action.StochasticActionExplStrat">pyrado.exploration.stochastic_action.StochasticActionExplStrat</a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#pyrado.algorithms.utils.ActionStatistics" title="pyrado.algorithms.utils.ActionStatistics">pyrado.algorithms.utils.ActionStatistics</a><a class="reference internal" href="_modules/pyrado/algorithms/utils.html#compute_action_statistics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.compute_action_statistics" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action distribution from the exploration strategy, compute the log action probabilities and entropy
for the given rollout using the given exploration strategy.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Requires the exploration strategy to have a (most likely custom) <cite>evaluate()</cite> method.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>steps</strong> – recorded rollout data</p></li>
<li><p><strong>expl_strat</strong> – exploration strategy used to generate the data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>collected action statistics, see <cite>ActionStatistics</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.algorithms.utils.load_prefix_suffix">
<code class="sig-name descname">load_prefix_suffix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em>, <em class="sig-param"><span class="n">name</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">file_ext</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">load_dir</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>dict<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/utils.html#load_prefix_suffix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.load_prefix_suffix" title="Permalink to this definition">¶</a></dt>
<dd><p>Load an arbitrary object object using a prefix or suffix, depending on the meta information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> – object to load into</p></li>
<li><p><strong>name</strong> – name of the object for loading</p></li>
<li><p><strong>file_ext</strong> – file extension, e.g. ‘pt’ for policies</p></li>
<li><p><strong>load_dir</strong> – directory to load from</p></li>
<li><p><strong>meta_info</strong> – meta information that can contain a pre- and/or suffix for altering the name</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.algorithms.utils.save_prefix_suffix">
<code class="sig-name descname">save_prefix_suffix</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em>, <em class="sig-param"><span class="n">name</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">file_ext</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">save_dir</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">Optional<span class="p">[</span>dict<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/utils.html#save_prefix_suffix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.save_prefix_suffix" title="Permalink to this definition">¶</a></dt>
<dd><p>Save an arbitrary object object using a prefix or suffix, depending on the meta information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> – object to save</p></li>
<li><p><strong>name</strong> – name of the object for saving</p></li>
<li><p><strong>file_ext</strong> – file extension, e.g. ‘pt’ for policies</p></li>
<li><p><strong>save_dir</strong> – directory to save in</p></li>
<li><p><strong>meta_info</strong> – meta information that can contain a pre- and/or suffix for altering the name</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.algorithms.utils.until_thold_exceeded">
<code class="sig-name descname">until_thold_exceeded</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">thold</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">max_iter</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/utils.html#until_thold_exceeded"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.until_thold_exceeded" title="Permalink to this definition">¶</a></dt>
<dd><p>Designed to wrap a function and repeat it until the return value exceeds a threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thold</strong> – threshold</p></li>
<li><p><strong>max_iter</strong> – maximum number of iterations of the wrapped function, set to <cite>None</cite> to run the loop relentlessly</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>wrapped function</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyrado.algorithms" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="domain_randomization.html" class="btn btn-neutral float-right" title="domain_randomization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="examples/3_algorithm.html" class="btn btn-neutral float-left" title="How to create an algorithm" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>