

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>utils &mdash; Pyrado 0.2 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="tests" href="tests.html" />
    <link rel="prev" title="tasks" href="tasks.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Pyrado
          

          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/1_experiment.html">How to run an experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/2_environment_wrappers.html">How to wrap an environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/3_algorithm.html">How to create an algorithm</a></li>
</ul>
<p class="caption"><span class="caption-text">Package Overview:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="algorithms.html">algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="domain_randomization.html">domain_randomization</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.html">environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.pysim.html">pysim</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.mujoco.html">mujoco</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.rcspysim.html">rcspysim</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.quanser.html">quanser</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment_wrappers.html">environment_wrappers</a></li>
<li class="toctree-l1"><a class="reference internal" href="exploration.html">exploration</a></li>
<li class="toctree-l1"><a class="reference internal" href="logger.html">logger</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.html">policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling.html">sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="spaces.html">spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">tasks</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">utils</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.utils.argparser">argparser</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.utils.averaging">averaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-types">data_types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.utils.exceptions">exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#experiments">experiments</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.utils.functions">functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#input-output">input_output</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.utils.math">math</a></li>
<li class="toctree-l2"><a class="reference internal" href="#nn-layers">nn_layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.utils.normalizing">normalizing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.utils.optimizers">optimizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.utils.order">order</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.utils.properties">properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.utils.standardizing">standardizing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.utils.tensor">tensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.utils">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">tests</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Pyrado</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>utils</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/utils.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="utils">
<h1>utils<a class="headerlink" href="#utils" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-pyrado.utils.argparser">
<span id="argparser"></span><h2>argparser<a class="headerlink" href="#module-pyrado.utils.argparser" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyrado.utils.argparser.get_argparser">
<code class="sig-name descname">get_argparser</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; argparse.ArgumentParser<a class="reference internal" href="_modules/pyrado/utils/argparser.html#get_argparser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.argparser.get_argparser" title="Permalink to this definition">¶</a></dt>
<dd><p>Return Pyrado’s default argument parser.</p>
</dd></dl>

</div>
<div class="section" id="module-pyrado.utils.averaging">
<span id="averaging"></span><h2>averaging<a class="headerlink" href="#module-pyrado.utils.averaging" title="Permalink to this headline">¶</a></h2>
<p>Only tested for 1-dim inputs.</p>
<dl class="py class">
<dt id="pyrado.utils.averaging.RunningExpDecayingAverage">
<em class="property">class </em><code class="sig-name descname">RunningExpDecayingAverage</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alpha</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/averaging.html#RunningExpDecayingAverage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.averaging.RunningExpDecayingAverage" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Implementation of an exponentially decaying average estimator</p>
<dl class="py method">
<dt id="pyrado.utils.averaging.RunningExpDecayingAverage.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alpha</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/averaging.html#RunningExpDecayingAverage.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.averaging.RunningExpDecayingAverage.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset internal variables.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.utils.averaging.RunningMemoryAverage">
<em class="property">class </em><code class="sig-name descname">RunningMemoryAverage</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">capacity</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/averaging.html#RunningMemoryAverage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.averaging.RunningMemoryAverage" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Implementation of an estimator that computes the average for a memorized buffer</p>
<dl class="py method">
<dt id="pyrado.utils.averaging.RunningMemoryAverage.memory">
<em class="property">property </em><code class="sig-name descname">memory</code><a class="headerlink" href="#pyrado.utils.averaging.RunningMemoryAverage.memory" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.utils.averaging.RunningMemoryAverage.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">capacity</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/averaging.html#RunningMemoryAverage.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.averaging.RunningMemoryAverage.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset internal variables.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="data-types">
<h2>data_types<a class="headerlink" href="#data-types" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyrado.utils.exceptions">
<span id="exceptions"></span><h2>exceptions<a class="headerlink" href="#module-pyrado.utils.exceptions" title="Permalink to this headline">¶</a></h2>
<dl class="py exception">
<dt id="pyrado.utils.exceptions.BaseErr">
<em class="property">exception </em><code class="sig-name descname">BaseErr</code><a class="reference internal" href="_modules/pyrado/utils/exceptions.html#BaseErr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.exceptions.BaseErr" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Base class for exceptions in Pyrado</p>
<dl class="py method">
<dt id="pyrado.utils.exceptions.BaseErr.retrieve_var_name">
<em class="property">static </em><code class="sig-name descname">retrieve_var_name</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">var</span></em>, <em class="sig-param"><span class="n">stack_level</span><span class="o">=</span><span class="default_value">2</span></em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="_modules/pyrado/utils/exceptions.html#BaseErr.retrieve_var_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.exceptions.BaseErr.retrieve_var_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the name of the given variable by searching through the locals and globals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>var</strong> – variable to look for</p></li>
<li><p><strong>stack_level</strong> – number of frames to go up. 1 is the caller, 2 (default) is the caller’s caller.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>name of the first matching variable</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt id="pyrado.utils.exceptions.KeyErr">
<em class="property">exception </em><code class="sig-name descname">KeyErr</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">key</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">container</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">msg</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/exceptions.html#KeyErr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.exceptions.KeyErr" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.utils.exceptions.BaseErr" title="pyrado.utils.exceptions.BaseErr"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.utils.exceptions.BaseErr</span></code></a></p>
<p>Class for exceptions raised asking for a key in an object that does not exist</p>
</dd></dl>

<dl class="py exception">
<dt id="pyrado.utils.exceptions.PathErr">
<em class="property">exception </em><code class="sig-name descname">PathErr</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">given</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">msg</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/exceptions.html#PathErr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.exceptions.PathErr" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.utils.exceptions.BaseErr" title="pyrado.utils.exceptions.BaseErr"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.utils.exceptions.BaseErr</span></code></a></p>
<p>Class for exceptions raised by passing wrong paths to folders or files</p>
</dd></dl>

<dl class="py exception">
<dt id="pyrado.utils.exceptions.ShapeErr">
<em class="property">exception </em><code class="sig-name descname">ShapeErr</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">given</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">given_name</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">expected_match</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">msg</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/exceptions.html#ShapeErr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.exceptions.ShapeErr" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.utils.exceptions.BaseErr" title="pyrado.utils.exceptions.BaseErr"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.utils.exceptions.BaseErr</span></code></a></p>
<p>Class for exceptions raised by passing wrong values</p>
<dl class="py method">
<dt id="pyrado.utils.exceptions.ShapeErr.get_shape_and_name">
<em class="property">static </em><code class="sig-name descname">get_shape_and_name</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em>, <em class="sig-param"><span class="n">var</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/exceptions.html#ShapeErr.get_shape_and_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.exceptions.ShapeErr.get_shape_and_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py exception">
<dt id="pyrado.utils.exceptions.TypeErr">
<em class="property">exception </em><code class="sig-name descname">TypeErr</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">given=None</em>, <em class="sig-param">given_name: str = None</em>, <em class="sig-param">expected_type: [&lt;class 'type'&gt;</em>, <em class="sig-param">&lt;class 'list'&gt;</em>, <em class="sig-param">&lt;class 'tuple'&gt;] = None</em>, <em class="sig-param">msg: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/exceptions.html#TypeErr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.exceptions.TypeErr" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.utils.exceptions.BaseErr" title="pyrado.utils.exceptions.BaseErr"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.utils.exceptions.BaseErr</span></code></a></p>
<p>Class for exceptions raised by passing wrong data types</p>
</dd></dl>

<dl class="py exception">
<dt id="pyrado.utils.exceptions.ValueErr">
<em class="property">exception </em><code class="sig-name descname">ValueErr</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">given</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">given_name</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">eq_constraint</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">l_constraint</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">le_constraint</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">g_constraint</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ge_constraint</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">msg</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/exceptions.html#ValueErr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.exceptions.ValueErr" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.utils.exceptions.BaseErr" title="pyrado.utils.exceptions.BaseErr"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.utils.exceptions.BaseErr</span></code></a></p>
<p>Class for exceptions raised by passing wrong values</p>
</dd></dl>

</div>
<div class="section" id="experiments">
<h2>experiments<a class="headerlink" href="#experiments" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyrado.utils.functions">
<span id="functions"></span><h2>functions<a class="headerlink" href="#module-pyrado.utils.functions" title="Permalink to this headline">¶</a></h2>
<p>A small collection of well-known functions for testing or benchmarking</p>
<dl class="py function">
<dt id="pyrado.utils.functions.noisy_nonlin_fcn">
<code class="sig-name descname">noisy_nonlin_fcn</code><span class="sig-paren">(</span><em class="sig-param">x: [&lt;class 'torch.Tensor'&gt;, &lt;class 'numpy.ndarray'&gt;], f: float = 1.0, noise_std: float = 0.0</em><span class="sig-paren">)</span> &#x2192; [&lt;class ‘torch.Tensor’&gt;, &lt;class ‘numpy.ndarray’&gt;]<a class="reference internal" href="_modules/pyrado/utils/functions.html#noisy_nonlin_fcn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.functions.noisy_nonlin_fcn" title="Permalink to this definition">¶</a></dt>
<dd><p>A 1-dim function (sinus superposed with polynomial), representing the black box function in Bayesian optimization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – function argument</p></li>
<li><p><strong>noise_std</strong> – scale of the additive noise sampled from a standard normal distribution</p></li>
<li><p><strong>f</strong> – frequency of the sinus wave [Hz]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>function value</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.functions.rosenbrock">
<code class="sig-name descname">rosenbrock</code><span class="sig-paren">(</span><em class="sig-param">x: Union[torch.Tensor</em>, <em class="sig-param">numpy.ndarray]) -&gt; (&lt;class 'torch.Tensor'&gt;</em>, <em class="sig-param">&lt;class 'numpy.ndarray'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/functions.html#rosenbrock"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.functions.rosenbrock" title="Permalink to this definition">¶</a></dt>
<dd><p>The Rosenbrock function
(consistent with <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/tutorial/optimize.html">https://docs.scipy.org/doc/scipy/reference/tutorial/optimize.html</a>)
:param x: multi-dim column vector, or array thereof
:return: value of the rosenbrock function at the input point, or array thereof</p>
</dd></dl>

</div>
<div class="section" id="input-output">
<h2>input_output<a class="headerlink" href="#input-output" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyrado.utils.math">
<span id="math"></span><h2>math<a class="headerlink" href="#module-pyrado.utils.math" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.utils.math.UnitCubeProjector">
<em class="property">class </em><code class="sig-name descname">UnitCubeProjector</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">bound_lo</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>numpy.ndarray<span class="p">, </span>torch.Tensor<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">bound_up</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>numpy.ndarray<span class="p">, </span>torch.Tensor<span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/math.html#UnitCubeProjector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.math.UnitCubeProjector" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Project to a unit qube <span class="math notranslate nohighlight">\([0, 1]^d\)</span> and back using explicit bounds</p>
<dl class="py method">
<dt id="pyrado.utils.math.UnitCubeProjector.project_back">
<code class="sig-name descname">project_back</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>numpy.ndarray<span class="p">, </span>torch.Tensor<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; Union<span class="p">[</span>numpy.ndarray<span class="p">, </span>torch.Tensor<span class="p">]</span><a class="reference internal" href="_modules/pyrado/utils/math.html#UnitCubeProjector.project_back"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.math.UnitCubeProjector.project_back" title="Permalink to this definition">¶</a></dt>
<dd><p>Revert the previous normalization using the stored explicit bounds</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – input from the uni space</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>element of the original space</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.utils.math.UnitCubeProjector.project_to">
<code class="sig-name descname">project_to</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>numpy.ndarray<span class="p">, </span>torch.Tensor<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; Union<span class="p">[</span>numpy.ndarray<span class="p">, </span>torch.Tensor<span class="p">]</span><a class="reference internal" href="_modules/pyrado/utils/math.html#UnitCubeProjector.project_to"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.math.UnitCubeProjector.project_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize every dimension individually using the stored explicit bounds and the L_1 norm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – input to project to the unit space</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>element of the unit cube</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.math.clamp">
<code class="sig-name descname">clamp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">lo</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">up</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/utils/math.html#clamp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.math.clamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Clip the entries of a tensor by the entries of a lower bound and an upper bound tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inp</strong> – input tensor</p></li>
<li><p><strong>lo</strong> – lower bound for each entry</p></li>
<li><p><strong>lo</strong> – upper bound for each entry</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>clipped tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.math.clamp_symm">
<code class="sig-name descname">clamp_symm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">up_lo</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/utils/math.html#clamp_symm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.math.clamp_symm" title="Permalink to this definition">¶</a></dt>
<dd><p>Symmetrically clip the entries of a tensor by the entries of a tensor with only positive entries.
One use case of this function is if you want to clip the parameter update by a ratio of the old parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inp</strong> – input tensor</p></li>
<li><p><strong>up_lo</strong> – upper and (negative of the) lower bound for each entry</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>clipped tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.math.cosine_similarity">
<code class="sig-name descname">cosine_similarity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">y</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/utils/math.html#cosine_similarity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.math.cosine_similarity" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the cosine similarity between two tensors $D_cos(x,y) = frac{x^T y}{<a href="#id1"><span class="problematic" id="id2">|x|</span></a> cdot <a href="#id3"><span class="problematic" id="id4">|y|</span></a>}$.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – input tensor</p></li>
<li><p><strong>y</strong> – input tensor</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>cosine similarity value</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.math.cov">
<code class="sig-name descname">cov</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">data_along_rows</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/math.html#cov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.math.cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the covariance matrix given data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only real valued matrices are supported</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – matrix containing multiple observations of multiple variables</p></li>
<li><p><strong>data_along_rows</strong> – if <cite>True</cite> the variables are stacked along the columns, else they are along the rows</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>covariance matrix given the data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.math.explained_var">
<code class="sig-name descname">explained_var</code><span class="sig-paren">(</span><em class="sig-param">y_mdl: Union[numpy.ndarray, torch.Tensor], y_obs: Union[numpy.ndarray, torch.Tensor]) -&gt; (&lt;class 'numpy.ndarray'&gt;, &lt;class 'torch.Tensor'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/math.html#explained_var"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.math.explained_var" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate proportion of the variance “explained” by the model (see coefficient of determination R^2)
.. note:: R^2 = 0.49 implies that 49% of the variability of the dependent variable has been accounted for.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_mdl</strong> – predictions from the model</p></li>
<li><p><strong>y_obs</strong> – observed data (ground truth)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>proportion of the explained variance (i.e. R^2 value)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.math.logmeanexp">
<code class="sig-name descname">logmeanexp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">dim</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/utils/math.html#logmeanexp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.math.logmeanexp" title="Permalink to this definition">¶</a></dt>
<dd><p>Numerically stable way to compute <span class="math notranslate nohighlight">\(\log \left( 1/N \sum_{i=1}^N \exp(x) \right)\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – input tensor</p></li>
<li><p><strong>dim</strong> – dimension to compute the logmeanexp along</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><span class="math notranslate nohighlight">\(\log \left( 1/N \sum_{i=1}^N \exp(x) \right)\)</span></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.math.rmse">
<code class="sig-name descname">rmse</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>numpy.ndarray<span class="p">, </span>torch.Tensor<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">y</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>numpy.ndarray<span class="p">, </span>torch.Tensor<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">dim</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em><span class="sig-paren">)</span> &#x2192; Union<span class="p">[</span>numpy.ndarray<span class="p">, </span>torch.Tensor<span class="p">]</span><a class="reference internal" href="_modules/pyrado/utils/math.html#rmse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.math.rmse" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the root mean squared error between two inputs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – input data, e.g. output of a neural network</p></li>
<li><p><strong>y</strong> – input data, e.g. target values for the output</p></li>
<li><p><strong>dim</strong> – dimension to compute the RMSE along</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="nn-layers">
<h2>nn_layers<a class="headerlink" href="#nn-layers" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyrado.utils.normalizing">
<span id="normalizing"></span><h2>normalizing<a class="headerlink" href="#module-pyrado.utils.normalizing" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.utils.normalizing.RunningNormalizer">
<em class="property">class </em><code class="sig-name descname">RunningNormalizer</code><a class="reference internal" href="_modules/pyrado/utils/normalizing.html#RunningNormalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.normalizing.RunningNormalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Normalizes given data based on the history of observed data, such that all outputs are in range [-1, 1]</p>
<dl class="py method">
<dt id="pyrado.utils.normalizing.RunningNormalizer.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/normalizing.html#RunningNormalizer.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.normalizing.RunningNormalizer.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset internal variables.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.normalizing.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param">x: Union[numpy.ndarray, torch.Tensor], axis: int = -1, order: int = 1, eps: float = 1e-08) -&gt; (&lt;class 'numpy.ndarray'&gt;, &lt;class 'torch.Tensor'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/normalizing.html#normalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.normalizing.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize a numpy <cite>ndarray</cite> or a PyTroch <cite>Tensor</cite> without changing the input.
Choosing <cite>axis=1</cite> and <cite>norm_order=1</cite> makes all columns of sum to 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – input to normalize</p></li>
<li><p><strong>axis</strong> – axis of the array to normalize along</p></li>
<li><p><strong>order</strong> – order of the norm (e.g., L_1 norm: absolute values, L_2 norm: quadratic values)</p></li>
<li><p><strong>eps</strong> – lower bound on the norm, to avoid division by zero</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>normalized array</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrado.utils.optimizers">
<span id="optimizers"></span><h2>optimizers<a class="headerlink" href="#module-pyrado.utils.optimizers" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.utils.optimizers.GSS">
<em class="property">class </em><code class="sig-name descname">GSS</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">param_min</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">param_max</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/optimizers.html#GSS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.optimizers.GSS" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.optim.optimizer.Optimizer</span></code></p>
<p>Golden Section Search optimizer</p>
<dl class="py method">
<dt id="pyrado.utils.optimizers.GSS.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/optimizers.html#GSS.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.optimizers.GSS.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.utils.optimizers.GSS.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">closure</span><span class="p">:</span> <span class="n">collections.abc.Callable</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/optimizers.html#GSS.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.optimizers.GSS.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a single optimization step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>closure</strong> – a closure that reevaluates the model and returns the loss</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>accumulated loss for all parameter groups after the parameter update</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.utils.order">
<span id="order"></span><h2>order<a class="headerlink" href="#module-pyrado.utils.order" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyrado.utils.order.filter_los_by_lok">
<code class="sig-name descname">filter_los_by_lok</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">strs</span><span class="p">:</span> <span class="n">list</span></em>, <em class="sig-param"><span class="n">keys</span><span class="p">:</span> <span class="n">list</span></em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/pyrado/utils/order.html#filter_los_by_lok"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.order.filter_los_by_lok" title="Permalink to this definition">¶</a></dt>
<dd><p>Filter a list of strings by a list of key strings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>strs</strong> – list of strings to filter</p></li>
<li><p><strong>keys</strong> – key-strings to filter by</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list with unique elements of the input list which contain at least one of the keys</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.order.get_immediate_subdirs">
<code class="sig-name descname">get_immediate_subdirs</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">parent_dir</span><span class="p">:</span> <span class="n">str</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/order.html#get_immediate_subdirs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.order.get_immediate_subdirs" title="Permalink to this definition">¶</a></dt>
<dd><p>Get all 1st level subdirectories of a specified directory (i.e. a path)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>parent_dir</strong> – directory in which to look for subdirectories</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of names of all 1st level subdirectories</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.order.natural_sort">
<code class="sig-name descname">natural_sort</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lst</span><span class="p">:</span> <span class="n">list</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/order.html#natural_sort"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.order.natural_sort" title="Permalink to this definition">¶</a></dt>
<dd><p>Sort a list like a human would do. Normal list sort does  1, 10, 11, 2, 3. But this function yields 1, 2, 3, 10, 11.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference external" href="https://stackoverflow.com/questions/4836710/is-there-a-built-in-function-for-string-natural-sort">https://stackoverflow.com/questions/4836710/is-there-a-built-in-function-for-string-natural-sort</a></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>lst</strong> – input list</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>alpha-numerically sorted list</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrado.utils.properties">
<span id="properties"></span><h2>properties<a class="headerlink" href="#module-pyrado.utils.properties" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.utils.properties.Delegate">
<em class="property">class </em><code class="sig-name descname">Delegate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">delegate</span></em>, <em class="sig-param"><span class="n">attr</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/properties.html#Delegate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.properties.Delegate" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Delegate to a class member object.</p>
<p>Example:
class Foo:</p>
<blockquote>
<div><dl class="simple">
<dt>def __init__(self, bar):</dt><dd><p>self.bar = bar</p>
</dd>
</dl>
<p>baz = Delegate(“bar”)</p>
</div></blockquote>
<p>foo = Foo()
foo.baz &lt;=&gt; foo.bar.baz</p>
</dd></dl>

<dl class="py class">
<dt id="pyrado.utils.properties.ReadOnlyDelegate">
<em class="property">class </em><code class="sig-name descname">ReadOnlyDelegate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">delegate</span></em>, <em class="sig-param"><span class="n">attr</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/properties.html#ReadOnlyDelegate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.properties.ReadOnlyDelegate" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Delegate to a class member object in a read-only way.</p>
<p>Example:
class Foo:</p>
<blockquote>
<div><dl class="simple">
<dt>def __init__(self, bar):</dt><dd><p>self.bar = bar</p>
</dd>
</dl>
<p>baz = Delegate(“bar”)</p>
</div></blockquote>
<p>foo = Foo()
foo.baz &lt;=&gt; foo.bar.baz</p>
</dd></dl>

<dl class="py class">
<dt id="pyrado.utils.properties.cached_property">
<em class="property">class </em><code class="sig-name descname">cached_property</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">func</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/properties.html#cached_property"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.properties.cached_property" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Decorator that turns a function into a cached property.
When the property is first accessed, the function is called to compute the value. Later calls use the cached value.
.. note:: Requires a <cite>__dict__</cite> field, so it won’t work on named tuples.</p>
</dd></dl>

</div>
<div class="section" id="module-pyrado.utils.standardizing">
<span id="standardizing"></span><h2>standardizing<a class="headerlink" href="#module-pyrado.utils.standardizing" title="Permalink to this headline">¶</a></h2>
<p>Only tested for 1-dim inputs, e.g. time series of rewards.</p>
<dl class="py class">
<dt id="pyrado.utils.standardizing.RunningStandardizer">
<em class="property">class </em><code class="sig-name descname">RunningStandardizer</code><a class="reference internal" href="_modules/pyrado/utils/standardizing.html#RunningStandardizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.standardizing.RunningStandardizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Implementation of Welford’s online algorithm</p>
<dl class="py method">
<dt id="pyrado.utils.standardizing.RunningStandardizer.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/standardizing.html#RunningStandardizer.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.standardizing.RunningStandardizer.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset internal variables.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.utils.standardizing.Standardizer">
<em class="property">class </em><code class="sig-name descname">Standardizer</code><a class="reference internal" href="_modules/pyrado/utils/standardizing.html#Standardizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.standardizing.Standardizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A stateful standardizer that remembers the mean and standard deviation for later un-standardization</p>
<dl class="py method">
<dt id="pyrado.utils.standardizing.Standardizer.standardize">
<code class="sig-name descname">standardize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>numpy.ndarray<span class="p">, </span>torch.Tensor<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">eps</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">1e-08</span></em><span class="sig-paren">)</span> &#x2192; [&lt;class ‘numpy.ndarray’&gt;, &lt;class ‘torch.Tensor’&gt;]<a class="reference internal" href="_modules/pyrado/utils/standardizing.html#Standardizer.standardize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.standardizing.Standardizer.standardize" title="Permalink to this definition">¶</a></dt>
<dd><p>Standardize the input data to make it <span class="math notranslate nohighlight">\(~ N(0, 1)\)</span> and store the input’s mean and standard deviation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – input ndarray or Tensor</p></li>
<li><p><strong>eps</strong> – factor for numerical stability</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>standardized ndarray or Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.utils.standardizing.Standardizer.unstandardize">
<code class="sig-name descname">unstandardize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>numpy.ndarray<span class="p">, </span>torch.Tensor<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; [&lt;class ‘numpy.ndarray’&gt;, &lt;class ‘torch.Tensor’&gt;]<a class="reference internal" href="_modules/pyrado/utils/standardizing.html#Standardizer.unstandardize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.standardizing.Standardizer.unstandardize" title="Permalink to this definition">¶</a></dt>
<dd><p>Revert the previous standardization of the input data to make it <span class="math notranslate nohighlight">\(~ N(\mu, \sigma)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – input ndarray or Tensor</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>un-standardized ndarray or Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.standardizing.scale_min_max">
<code class="sig-name descname">scale_min_max</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>numpy.ndarray<span class="p">, </span>torch.Tensor<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">bound_lo</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>float<span class="p">, </span>numpy.ndarray<span class="p">, </span>torch.Tensor<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">bound_up</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>int<span class="p">, </span>float<span class="p">, </span>numpy.ndarray<span class="p">, </span>torch.Tensor<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; [&lt;class ‘numpy.ndarray’&gt;, &lt;class ‘torch.Tensor’&gt;]<a class="reference internal" href="_modules/pyrado/utils/standardizing.html#scale_min_max"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.standardizing.scale_min_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform the input data to to be in <span class="math notranslate nohighlight">\([a, b]\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – input ndarray or Tensor</p></li>
<li><p><strong>bound_lo</strong> – lower bound for the transformed data</p></li>
<li><p><strong>bound_up</strong> – upper bound for the transformed data</p></li>
<li><p><strong>data</strong> – input ndarray or Tensor</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>scaled ndarray or Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.standardizing.standardize">
<code class="sig-name descname">standardize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span><span class="p">:</span> <span class="n">Union<span class="p">[</span>numpy.ndarray<span class="p">, </span>torch.Tensor<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">eps</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">1e-08</span></em><span class="sig-paren">)</span> &#x2192; [&lt;class ‘numpy.ndarray’&gt;, &lt;class ‘torch.Tensor’&gt;]<a class="reference internal" href="_modules/pyrado/utils/standardizing.html#standardize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.standardizing.standardize" title="Permalink to this definition">¶</a></dt>
<dd><p>Standardize the input data to make it <span class="math notranslate nohighlight">\(~ N(0, 1)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – input ndarray or Tensor</p></li>
<li><p><strong>eps</strong> – factor for numerical stability</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>standardized ndarray or Tensor</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrado.utils.tensor">
<span id="tensor"></span><h2>tensor<a class="headerlink" href="#module-pyrado.utils.tensor" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyrado.utils.tensor.atleast_2D">
<code class="sig-name descname">atleast_2D</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/utils/tensor.html#atleast_2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.tensor.atleast_2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Mimic the numpy function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> – any tensor</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an at least 2-dim tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.tensor.atleast_3D">
<code class="sig-name descname">atleast_3D</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/utils/tensor.html#atleast_3D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.tensor.atleast_3D" title="Permalink to this definition">¶</a></dt>
<dd><p>Mimic the numpy function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> – any tensor</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an at least 3-dim tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.tensor.insert_tensor_col">
<code class="sig-name descname">insert_tensor_col</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">idx</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">col</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/utils/tensor.html#insert_tensor_col"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.tensor.insert_tensor_col" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert a column into a PyTorch Tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – original tensor</p></li>
<li><p><strong>idx</strong> – column index where to insert the column</p></li>
<li><p><strong>col</strong> – tensor to insert</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tensor with new column at index idx</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.tensor.stack_tensor_dict_list">
<code class="sig-name descname">stack_tensor_dict_list</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tensor_dict_list</span><span class="p">:</span> <span class="n">list</span></em><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="_modules/pyrado/utils/tensor.html#stack_tensor_dict_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.tensor.stack_tensor_dict_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Stack a list of dictionaries of {tensors or dict of tensors}.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tensor_dict_list</strong> – a list of dicts of {tensors or dict of tensors}.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dict of {stacked tensors or dict of stacked tensors}</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.tensor.stack_tensor_list">
<code class="sig-name descname">stack_tensor_list</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tensor_list</span><span class="p">:</span> <span class="n">list</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/utils/tensor.html#stack_tensor_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.tensor.stack_tensor_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function for stacking a list of tensors</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tensor_list</strong> – list of tensors to stack (along a new dim)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tensor of at least 1-dim</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrado.utils">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyrado.utils" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyrado.utils.get_class_name">
<code class="sig-name descname">get_class_name</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="_modules/pyrado/utils.html#get_class_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.get_class_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Get an arbitrary objects name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obj</strong> – any object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>name of the class of the given object</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tests.html" class="btn btn-neutral float-right" title="tests" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tasks.html" class="btn btn-neutral float-left" title="tasks" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>