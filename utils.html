

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>utils &mdash; Pyrado 0.2 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="tests" href="tests.html" />
    <link rel="prev" title="tasks" href="tasks.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Pyrado
          

          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/algorithm.html">How to create an algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/experiment.html">How to run an experiment</a></li>
</ul>
<p class="caption"><span class="caption-text">Package Overview:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="algorithms.html">algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="domain_randomization.html">domain_randomization</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.html">environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.pysim.html">pysim</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.mujoco.html">mujoco</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.rcspysim.html">rcspysim</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.quanser.html">quanser</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment_wrappers.html">environment_wrappers</a></li>
<li class="toctree-l1"><a class="reference internal" href="exploration.html">exploration</a></li>
<li class="toctree-l1"><a class="reference internal" href="logger.html">logger</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.html">policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling.html">sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="spaces.html">spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">tasks</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">utils</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.utils.argparser">argparser</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.utils.averaging">averaging</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.utils.data_types">data_types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.utils.exceptions">exceptions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#experiments">experiments</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.utils.functions">functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.utils.input_output">input_output</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.utils.math">math</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.utils.nn_layers">nn_layers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.utils.normalizing">normalizing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.utils.optimizers">optimizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.utils.properties">properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.utils.standardizing">standardizing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.utils.tensor">tensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.utils">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">tests</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Pyrado</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>utils</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/utils.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="utils">
<h1>utils<a class="headerlink" href="#utils" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-pyrado.utils.argparser">
<span id="argparser"></span><h2>argparser<a class="headerlink" href="#module-pyrado.utils.argparser" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyrado.utils.argparser.get_argparser">
<code class="sig-name descname">get_argparser</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; argparse.ArgumentParser<a class="reference internal" href="_modules/pyrado/utils/argparser.html#get_argparser"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.argparser.get_argparser" title="Permalink to this definition">¶</a></dt>
<dd><p>Return Pyrado’s default argument parser.</p>
</dd></dl>

</div>
<div class="section" id="module-pyrado.utils.averaging">
<span id="averaging"></span><h2>averaging<a class="headerlink" href="#module-pyrado.utils.averaging" title="Permalink to this headline">¶</a></h2>
<p>Only tested for 1-dim inputs.</p>
<dl class="py class">
<dt id="pyrado.utils.averaging.RunningExpDecayingAverage">
<em class="property">class </em><code class="sig-name descname">RunningExpDecayingAverage</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alpha</span><span class="p">:</span> <span class="n">float</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/averaging.html#RunningExpDecayingAverage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.averaging.RunningExpDecayingAverage" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Implementation of an exponentially decaying average estimator</p>
<dl class="py method">
<dt id="pyrado.utils.averaging.RunningExpDecayingAverage.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">alpha</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/averaging.html#RunningExpDecayingAverage.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.averaging.RunningExpDecayingAverage.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset internal variables.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.utils.averaging.RunningMemoryAverage">
<em class="property">class </em><code class="sig-name descname">RunningMemoryAverage</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">capacity</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/averaging.html#RunningMemoryAverage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.averaging.RunningMemoryAverage" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Implementation of an estimator that computes the average for a memorized buffer</p>
<dl class="py method">
<dt id="pyrado.utils.averaging.RunningMemoryAverage.memory">
<em class="property">property </em><code class="sig-name descname">memory</code><a class="headerlink" href="#pyrado.utils.averaging.RunningMemoryAverage.memory" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.utils.averaging.RunningMemoryAverage.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">capacity</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/averaging.html#RunningMemoryAverage.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.averaging.RunningMemoryAverage.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset internal variables.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.utils.data_types">
<span id="data-types"></span><h2>data_types<a class="headerlink" href="#module-pyrado.utils.data_types" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.utils.data_types.DSSpec">
<em class="property">class </em><code class="sig-name descname">DSSpec</code><span class="sig-paren">(</span><em class="sig-param">function: str, goal: [&lt;class 'numpy.ndarray'&gt;, &lt;class 'float'&gt;, &lt;class 'int'&gt;], **kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/data_types.html#DSSpec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.data_types.DSSpec" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></p>
<p>The specification of a dynamical system implemented in <cite>RcsPySim</cite> and used in combination with ADN
We are directly subclassing dict beacuse <cite>PropertySource</cite> in <cite>RcsPySim</cite> extracts information from dicts.</p>
</dd></dl>

<dl class="py class">
<dt id="pyrado.utils.data_types.EnvSpec">
<em class="property">class </em><code class="sig-name descname">EnvSpec</code><span class="sig-paren">(</span><em class="sig-param">obs_space: pyrado.spaces.base.Space</em>, <em class="sig-param">act_space: pyrado.spaces.base.Space</em>, <em class="sig-param">state_space: pyrado.spaces.base.Space = &lt;class 'pyrado.spaces.empty.EmptySpace'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/data_types.html#EnvSpec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.data_types.EnvSpec" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>The specification of an environment’s input and output space</p>
<dl class="py method">
<dt id="pyrado.utils.data_types.EnvSpec.act_space">
<em class="property">property </em><code class="sig-name descname">act_space</code><a class="headerlink" href="#pyrado.utils.data_types.EnvSpec.act_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.utils.data_types.EnvSpec.obs_space">
<em class="property">property </em><code class="sig-name descname">obs_space</code><a class="headerlink" href="#pyrado.utils.data_types.EnvSpec.obs_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.utils.data_types.EnvSpec.state_space">
<em class="property">property </em><code class="sig-name descname">state_space</code><a class="headerlink" href="#pyrado.utils.data_types.EnvSpec.state_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.utils.data_types.LinDSSpec">
<em class="property">class </em><code class="sig-name descname">LinDSSpec</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function</span><span class="o">=</span><span class="default_value">'lin'</span></em>, <em class="sig-param"><span class="n">goal</span><span class="o">=</span><span class="default_value">np.array([- 1.0, 2.0])</span></em>, <em class="sig-param"><span class="n">errorDynamics</span><span class="o">=</span><span class="default_value">np.eye(2)</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/data_types.html#LinDSSpec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.data_types.LinDSSpec" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.utils.data_types.DSSpec" title="pyrado.utils.data_types.DSSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.utils.data_types.DSSpec</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt id="pyrado.utils.data_types.MSDDSSpec">
<em class="property">class </em><code class="sig-name descname">MSDDSSpec</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">function</span><span class="o">=</span><span class="default_value">'msd_nlin'</span></em>, <em class="sig-param"><span class="n">goal</span><span class="o">=</span><span class="default_value">np.array([- 1.0, 2.0])</span></em>, <em class="sig-param"><span class="n">attractorStiffness</span><span class="o">=</span><span class="default_value">50.0</span></em>, <em class="sig-param"><span class="n">damping</span><span class="o">=</span><span class="default_value">10.0</span></em>, <em class="sig-param"><span class="n">mass</span><span class="o">=</span><span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/data_types.html#MSDDSSpec"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.data_types.MSDDSSpec" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.utils.data_types.DSSpec" title="pyrado.utils.data_types.DSSpec"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.utils.data_types.DSSpec</span></code></a></p>
</dd></dl>

<dl class="py class">
<dt id="pyrado.utils.data_types.RenderMode">
<em class="property">class </em><code class="sig-name descname">RenderMode</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">text</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">video</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/data_types.html#RenderMode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.data_types.RenderMode" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>The specification of a render mode, do not print or render anything by default</p>
<dl class="py method">
<dt id="pyrado.utils.data_types.RenderMode.text">
<em class="property">property </em><code class="sig-name descname">text</code><a class="headerlink" href="#pyrado.utils.data_types.RenderMode.text" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.utils.data_types.RenderMode.video">
<em class="property">property </em><code class="sig-name descname">video</code><a class="headerlink" href="#pyrado.utils.data_types.RenderMode.video" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.data_types.check_all_shapes_equal">
<code class="sig-name descname">check_all_shapes_equal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">iterable</span></em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/pyrado/utils/data_types.html#check_all_shapes_equal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.data_types.check_all_shapes_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the shape attribute of all elements of an iterable (e.g., list) are equal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>iterable</strong> – iterable to check</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool saying if all elements are equal</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.data_types.check_all_types_equal">
<code class="sig-name descname">check_all_types_equal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">iterable</span></em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/pyrado/utils/data_types.html#check_all_types_equal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.data_types.check_all_types_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if all elements of an iterable (e.g., list) are if the same type.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>iterable</strong> – iterable to check</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool saying if all elements are of equal type</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.data_types.check_all_values_equal">
<code class="sig-name descname">check_all_values_equal</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">iterable</span></em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/pyrado/utils/data_types.html#check_all_values_equal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.data_types.check_all_values_equal" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if all elements of an iterable (e.g., list) are equal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>iterable</strong> – iterable to check</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool saying if all elements are equal</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.data_types.dict_arraylike_to_float">
<code class="sig-name descname">dict_arraylike_to_float</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">d</span><span class="p">:</span> <span class="n">dict</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/data_types.html#dict_arraylike_to_float"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.data_types.dict_arraylike_to_float" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert every scalar array-like entry the provided dict to to a float.
This function is useful when the metrics (e.g., calculated with numpy) should be saved in a YAML-file.
:param d: input dict with 1-element arrays
:return d: output dict with float entries where conversion was possible</p>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.data_types.fill_list_of_arrays">
<code class="sig-name descname">fill_list_of_arrays</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">loa</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>numpy.ndarray<span class="p">]</span></span></em>, <em class="sig-param"><span class="n">des_len</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">fill_ele</span><span class="o">=</span><span class="default_value">nan</span></em><span class="sig-paren">)</span> &#x2192; Sequence<span class="p">[</span>numpy.ndarray<span class="p">]</span><a class="reference internal" href="_modules/pyrado/utils/data_types.html#fill_list_of_arrays"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.data_types.fill_list_of_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Fill a list of arrays with potential unequal length (first axis) will provided elements</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loa</strong> – list of ndarrays</p></li>
<li><p><strong>des_len</strong> – desired length of the resulting arrays</p></li>
<li><p><strong>fill_ele</strong> – element to fill the arrays with</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of ndarrays with equal length</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.data_types.is_iterable">
<code class="sig-name descname">is_iterable</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span></em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/pyrado/utils/data_types.html#is_iterable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.data_types.is_iterable" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the input is iterable by trying to create an iterator from the input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inp</strong> – any object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>True</cite> if input is iterable, else <cite>False</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.data_types.is_iterator">
<code class="sig-name descname">is_iterator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span></em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/pyrado/utils/data_types.html#is_iterator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.data_types.is_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the input is an iterator by trying to call <cite>next()</cite> on it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inp</strong> – any object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><cite>True</cite> if input is an iterator, else <cite>False</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.data_types.merge_lod_same_dtype">
<code class="sig-name descname">merge_lod_same_dtype</code><span class="sig-paren">(</span><em class="sig-param">lod: Sequence[dict], dtpye=&lt;class 'set'&gt;</em><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="_modules/pyrado/utils/data_types.html#merge_lod_same_dtype"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.data_types.merge_lod_same_dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>Marge a list of dicts in to one dict.
The resulting dict has only one value type for all entries, but the dicts do not override each other.
:param lod: list of dicts
:return: merged dict</p>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.data_types.merge_lod_var_dtype">
<code class="sig-name descname">merge_lod_var_dtype</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">lod</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span>dict<span class="p">]</span></span></em><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="_modules/pyrado/utils/data_types.html#merge_lod_var_dtype"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.data_types.merge_lod_var_dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>Marge a list of dicts in to one dict.
The resulting dict can have different value types, but the dicts later in the list override earlier ones.
:param lod: list of dicts
:return: merged dict</p>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.data_types.to_float_relentless">
<code class="sig-name descname">to_float_relentless</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/data_types.html#to_float_relentless"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.data_types.to_float_relentless" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a ndarray to a list of floats or to only one float.
Convert a list of numerical values to a list of floats to only one float.
Convert a scalar to a float.
:param inp: ndarray, or list, or scalar
:return: scalar number or list of floats</p>
</dd></dl>

</div>
<div class="section" id="module-pyrado.utils.exceptions">
<span id="exceptions"></span><h2>exceptions<a class="headerlink" href="#module-pyrado.utils.exceptions" title="Permalink to this headline">¶</a></h2>
<dl class="py exception">
<dt id="pyrado.utils.exceptions.BaseErr">
<em class="property">exception </em><code class="sig-name descname">BaseErr</code><a class="reference internal" href="_modules/pyrado/utils/exceptions.html#BaseErr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.exceptions.BaseErr" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Exception</span></code></p>
<p>Base class for exceptions in Pyrado</p>
<dl class="py method">
<dt id="pyrado.utils.exceptions.BaseErr.retrieve_var_name">
<em class="property">static </em><code class="sig-name descname">retrieve_var_name</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">var</span></em>, <em class="sig-param"><span class="n">stack_level</span><span class="o">=</span><span class="default_value">2</span></em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="_modules/pyrado/utils/exceptions.html#BaseErr.retrieve_var_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.exceptions.BaseErr.retrieve_var_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the name of the given variable by searching through the locals and globals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>var</strong> – variable to look for</p></li>
<li><p><strong>stack_level</strong> – number of frames to go up. 1 is the caller, 2 (default) is the caller’s caller.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>name of the first matching variable</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py exception">
<dt id="pyrado.utils.exceptions.KeyErr">
<em class="property">exception </em><code class="sig-name descname">KeyErr</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">key</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">container</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">msg</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/exceptions.html#KeyErr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.exceptions.KeyErr" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.utils.exceptions.BaseErr" title="pyrado.utils.exceptions.BaseErr"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.utils.exceptions.BaseErr</span></code></a></p>
<p>Class for exceptions raised asking for a key in an object that does not exist</p>
</dd></dl>

<dl class="py exception">
<dt id="pyrado.utils.exceptions.PathErr">
<em class="property">exception </em><code class="sig-name descname">PathErr</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">given</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">msg</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/exceptions.html#PathErr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.exceptions.PathErr" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.utils.exceptions.BaseErr" title="pyrado.utils.exceptions.BaseErr"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.utils.exceptions.BaseErr</span></code></a></p>
<p>Class for exceptions raised by passing wrong paths to folders or files</p>
</dd></dl>

<dl class="py exception">
<dt id="pyrado.utils.exceptions.ShapeErr">
<em class="property">exception </em><code class="sig-name descname">ShapeErr</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">given</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">given_name</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">expected_match</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">msg</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/exceptions.html#ShapeErr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.exceptions.ShapeErr" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.utils.exceptions.BaseErr" title="pyrado.utils.exceptions.BaseErr"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.utils.exceptions.BaseErr</span></code></a></p>
<p>Class for exceptions raised by passing wrong values</p>
<dl class="py method">
<dt id="pyrado.utils.exceptions.ShapeErr.get_shape_and_name">
<em class="property">static </em><code class="sig-name descname">get_shape_and_name</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em>, <em class="sig-param"><span class="n">var</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/exceptions.html#ShapeErr.get_shape_and_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.exceptions.ShapeErr.get_shape_and_name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py exception">
<dt id="pyrado.utils.exceptions.TypeErr">
<em class="property">exception </em><code class="sig-name descname">TypeErr</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">given=None</em>, <em class="sig-param">given_name: str = None</em>, <em class="sig-param">expected_type: [&lt;class 'type'&gt;</em>, <em class="sig-param">&lt;class 'list'&gt;</em>, <em class="sig-param">&lt;class 'tuple'&gt;] = None</em>, <em class="sig-param">msg: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/exceptions.html#TypeErr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.exceptions.TypeErr" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.utils.exceptions.BaseErr" title="pyrado.utils.exceptions.BaseErr"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.utils.exceptions.BaseErr</span></code></a></p>
<p>Class for exceptions raised by passing wrong data types</p>
</dd></dl>

<dl class="py exception">
<dt id="pyrado.utils.exceptions.ValueErr">
<em class="property">exception </em><code class="sig-name descname">ValueErr</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">given</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">given_name</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">eq_constraint</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">l_constraint</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">le_constraint</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">g_constraint</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ge_constraint</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">msg</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/exceptions.html#ValueErr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.exceptions.ValueErr" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.utils.exceptions.BaseErr" title="pyrado.utils.exceptions.BaseErr"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.utils.exceptions.BaseErr</span></code></a></p>
<p>Class for exceptions raised by passing wrong values</p>
</dd></dl>

</div>
<div class="section" id="experiments">
<h2>experiments<a class="headerlink" href="#experiments" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyrado.utils.functions">
<span id="functions"></span><h2>functions<a class="headerlink" href="#module-pyrado.utils.functions" title="Permalink to this headline">¶</a></h2>
<p>A small collection of well-known functions for testing or benchmarking</p>
<dl class="py function">
<dt id="pyrado.utils.functions.noisy_nonlin_fcn">
<code class="sig-name descname">noisy_nonlin_fcn</code><span class="sig-paren">(</span><em class="sig-param">x: [&lt;class 'torch.Tensor'&gt;, &lt;class 'numpy.ndarray'&gt;], f: float = 1.0, noise_std: float = 0.0</em><span class="sig-paren">)</span> &#x2192; [&lt;class ‘torch.Tensor’&gt;, &lt;class ‘numpy.ndarray’&gt;]<a class="reference internal" href="_modules/pyrado/utils/functions.html#noisy_nonlin_fcn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.functions.noisy_nonlin_fcn" title="Permalink to this definition">¶</a></dt>
<dd><p>A 1-dim function (sinus superposed with polynomial), representing the black box function in Bayesian optimization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – function argument</p></li>
<li><p><strong>noise_std</strong> – scale of the additive noise sampled from a standard normal distribution</p></li>
<li><p><strong>f</strong> – frequency of the sinus wave [Hz]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>function value</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.functions.rosenbrock">
<code class="sig-name descname">rosenbrock</code><span class="sig-paren">(</span><em class="sig-param">x: [&lt;class 'torch.Tensor'&gt;</em>, <em class="sig-param">&lt;class 'numpy.ndarray'&gt;]) -&gt; (&lt;class 'torch.Tensor'&gt;</em>, <em class="sig-param">&lt;class 'numpy.ndarray'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/functions.html#rosenbrock"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.functions.rosenbrock" title="Permalink to this definition">¶</a></dt>
<dd><p>The Rosenbrock function
(consistent with <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/tutorial/optimize.html">https://docs.scipy.org/doc/scipy/reference/tutorial/optimize.html</a>)
:param x: multi-dim column vector, or array thereof
:return: value of the rosenbrock function at the input point, or array thereof</p>
</dd></dl>

</div>
<div class="section" id="module-pyrado.utils.input_output">
<span id="input-output"></span><h2>input_output<a class="headerlink" href="#module-pyrado.utils.input_output" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyrado.utils.input_output.color_validity">
<code class="sig-name descname">color_validity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">data</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em>, <em class="sig-param"><span class="n">valids</span><span class="p">:</span> <span class="n">numpy.ndarray</span></em><span class="sig-paren">)</span> &#x2192; list<a class="reference internal" href="_modules/pyrado/utils/input_output.html#color_validity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.input_output.color_validity" title="Permalink to this definition">¶</a></dt>
<dd><p>Color the entries of an data array red or green depending on the if the entries are valid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – ndarray containing the data to print</p></li>
<li><p><strong>valids</strong> – ndarray containing boolian integer values deciding gor the color (1 –&gt; green, 0 –&gt; red)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of stings</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.input_output.ensure_math_mode">
<code class="sig-name descname">ensure_math_mode</code><span class="sig-paren">(</span><em class="sig-param">inp: [&lt;class 'str'&gt;, typing.Sequence[str]], no_subscript: bool = False</em><span class="sig-paren">)</span> &#x2192; [&lt;class ‘str’&gt;, &lt;class ‘list’&gt;]<a class="reference internal" href="_modules/pyrado/utils/input_output.html#ensure_math_mode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.input_output.ensure_math_mode" title="Permalink to this definition">¶</a></dt>
<dd><p>Naive way to ensure that a sting is compatible with LaTeX math mode for printing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inp</strong> – input string</p></li>
<li><p><strong>no_subscript</strong> – force no subscript (sometimes there might be problems due to double subscript</p></li>
</ul>
</dd>
<dt class="field-even">Return s</dt>
<dd class="field-even"><p>sting in math mode</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.input_output.ensure_no_subscript">
<code class="sig-name descname">ensure_no_subscript</code><span class="sig-paren">(</span><em class="sig-param">inp: [&lt;class 'str'&gt;, typing.Sequence[str]]</em><span class="sig-paren">)</span> &#x2192; [&lt;class ‘str’&gt;, &lt;class ‘list’&gt;]<a class="reference internal" href="_modules/pyrado/utils/input_output.html#ensure_no_subscript"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.input_output.ensure_no_subscript" title="Permalink to this definition">¶</a></dt>
<dd><p>Naive way to ensure that a sting is compatible with LaTeX for printing by removing the math mode symbols.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>inp</strong> – input string or iterable of stings</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>sting without subscript</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.input_output.insert_newlines">
<code class="sig-name descname">insert_newlines</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">string</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">every</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="_modules/pyrado/utils/input_output.html#insert_newlines"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.input_output.insert_newlines" title="Permalink to this definition">¶</a></dt>
<dd><p>Inserts multiple line breaks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>string</strong> – input string to be broken into multiple lines</p></li>
<li><p><strong>every</strong> – gap in number of characters between every line break</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the input sting with line breaks</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.input_output.num_iter_from_rollouts">
<code class="sig-name descname">num_iter_from_rollouts</code><span class="sig-paren">(</span><em class="sig-param">ros: [typing.Sequence[pyrado.sampling.step_sequence.StepSequence], None], concat_ros: [&lt;class 'pyrado.sampling.step_sequence.StepSequence'&gt;, None], batch_size: int</em><span class="sig-paren">)</span> &#x2192; int<a class="reference internal" href="_modules/pyrado/utils/input_output.html#num_iter_from_rollouts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.input_output.num_iter_from_rollouts" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of iterations from the given rollout data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ros</strong> – multiple rollouts</p></li>
<li><p><strong>concat_ros</strong> – concatenated rollouts</p></li>
<li><p><strong>batch_size</strong> – number of samples per batch</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>number of iterations (e.g. used for the progress bar)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.input_output.print_cbt">
<code class="sig-name descname">print_cbt</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">msg</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">color</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">''</span></em>, <em class="sig-param"><span class="n">bright</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em>, <em class="sig-param"><span class="n">tag</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">''</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/input_output.html#print_cbt"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.input_output.print_cbt" title="Permalink to this definition">¶</a></dt>
<dd><p>Print a colored (and bright) message with a tag in the beginning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>msg</strong> – string to print</p></li>
<li><p><strong>color</strong> – color to print in, default <cite>‘’</cite> is the IDE’s/system’s default</p></li>
<li><p><strong>bright</strong> – flag if the message should be printed bright</p></li>
<li><p><strong>tag</strong> – tag to be printed in brackets in front of the message</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.input_output.select_query">
<code class="sig-name descname">select_query</code><span class="sig-paren">(</span><em class="sig-param">items</em>, <em class="sig-param">max_display=10</em>, <em class="sig-param">fallback=None</em>, <em class="sig-param">item_formatter=&lt;class 'str'&gt;</em>, <em class="sig-param">header: str = 'Available options:'</em>, <em class="sig-param">footer: str = 'Please enter the number of the option to use.'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/input_output.html#select_query"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.input_output.select_query" title="Permalink to this definition">¶</a></dt>
<dd><p>Ask the user to select an item out of the given list.</p>
</dd></dl>

</div>
<div class="section" id="module-pyrado.utils.math">
<span id="math"></span><h2>math<a class="headerlink" href="#module-pyrado.utils.math" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.utils.math.UnitCubeProjector">
<em class="property">class </em><code class="sig-name descname">UnitCubeProjector</code><span class="sig-paren">(</span><em class="sig-param">bound_lo: [&lt;class 'numpy.ndarray'&gt;, &lt;class 'torch.Tensor'&gt;], bound_up: [&lt;class 'numpy.ndarray'&gt;, &lt;class 'torch.Tensor'&gt;]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/math.html#UnitCubeProjector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.math.UnitCubeProjector" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Project to a unit qube <span class="math notranslate nohighlight">\([0, 1]^d\)</span> and back using explicit bounds</p>
<dl class="py method">
<dt id="pyrado.utils.math.UnitCubeProjector.project_back">
<code class="sig-name descname">project_back</code><span class="sig-paren">(</span><em class="sig-param">data: [&lt;class 'numpy.ndarray'&gt;, &lt;class 'torch.Tensor'&gt;]</em><span class="sig-paren">)</span> &#x2192; [&lt;class ‘numpy.ndarray’&gt;, &lt;class ‘torch.Tensor’&gt;]<a class="reference internal" href="_modules/pyrado/utils/math.html#UnitCubeProjector.project_back"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.math.UnitCubeProjector.project_back" title="Permalink to this definition">¶</a></dt>
<dd><p>Revert the previous normalization using the stored explicit bounds</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – input from the uni space</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>element of the original space</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.utils.math.UnitCubeProjector.project_to">
<code class="sig-name descname">project_to</code><span class="sig-paren">(</span><em class="sig-param">data: [&lt;class 'numpy.ndarray'&gt;, &lt;class 'torch.Tensor'&gt;]</em><span class="sig-paren">)</span> &#x2192; [&lt;class ‘numpy.ndarray’&gt;, &lt;class ‘torch.Tensor’&gt;]<a class="reference internal" href="_modules/pyrado/utils/math.html#UnitCubeProjector.project_to"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.math.UnitCubeProjector.project_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize every dimension individually using the stored explicit bounds and the L_1 norm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – input to project to the unit space</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>element of the unit cube</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.math.clamp">
<code class="sig-name descname">clamp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">lo</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">up</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/utils/math.html#clamp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.math.clamp" title="Permalink to this definition">¶</a></dt>
<dd><p>Clip the entries of a tensor by the entries of a lower bound and an upper bound tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inp</strong> – input tensor</p></li>
<li><p><strong>lo</strong> – lower bound for each entry</p></li>
<li><p><strong>lo</strong> – upper bound for each entry</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>clipped tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.math.clamp_symm">
<code class="sig-name descname">clamp_symm</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">up_lo</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/utils/math.html#clamp_symm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.math.clamp_symm" title="Permalink to this definition">¶</a></dt>
<dd><p>Symmetrically clip the entries of a tensor by the entries of a tensor with only positive entries.
One use case of this function is if you want to clip the parameter update by a ratio of the old parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inp</strong> – input tensor</p></li>
<li><p><strong>up_lo</strong> – upper and (negative of the) lower bound for each entry</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>clipped tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.math.cosine_similarity">
<code class="sig-name descname">cosine_similarity</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">y</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/utils/math.html#cosine_similarity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.math.cosine_similarity" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the cosine similarity between two tensors $D_cos(x,y) = frac{x^T y}{<a href="#id1"><span class="problematic" id="id2">|x|</span></a> cdot <a href="#id3"><span class="problematic" id="id4">|y|</span></a>}$.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – input tensor</p></li>
<li><p><strong>y</strong> – input tensor</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>cosine similarity value</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.math.cov">
<code class="sig-name descname">cov</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">data_along_rows</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/math.html#cov"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.math.cov" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the covariance matrix given data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only real valued matrices are supported</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – matrix containing multiple observations of multiple variables</p></li>
<li><p><strong>data_along_rows</strong> – if <cite>True</cite> the variables are stacked along the columns, else they are along the rows</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>covariance matrix given the data</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.math.explained_var">
<code class="sig-name descname">explained_var</code><span class="sig-paren">(</span><em class="sig-param">y_mdl: [&lt;class 'numpy.ndarray'&gt;, &lt;class 'torch.Tensor'&gt;], y_obs: [&lt;class 'numpy.ndarray'&gt;, &lt;class 'torch.Tensor'&gt;]) -&gt; (&lt;class 'numpy.ndarray'&gt;, &lt;class 'torch.Tensor'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/math.html#explained_var"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.math.explained_var" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate proportion of the variance “explained” by the model (see coefficient of determination R^2)
.. note:: R^2 = 0.49 implies that 49% of the variability of the dependent variable has been accounted for.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_mdl</strong> – predictions from the model</p></li>
<li><p><strong>y_obs</strong> – observed data (ground truth)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>proportion of the explained variance (i.e. R^2 value)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.math.logmeanexp">
<code class="sig-name descname">logmeanexp</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">dim</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">0</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/utils/math.html#logmeanexp"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.math.logmeanexp" title="Permalink to this definition">¶</a></dt>
<dd><p>Numerically stable way to compute <span class="math notranslate nohighlight">\(\log \left( 1/N \sum_{i=1}^N \exp(x) \right)\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – input tensor</p></li>
<li><p><strong>dim</strong> – dimension to compute the logmeanexp along</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><span class="math notranslate nohighlight">\(\log \left( 1/N \sum_{i=1}^N \exp(x) \right)\)</span></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrado.utils.nn_layers">
<span id="nn-layers"></span><h2>nn_layers<a class="headerlink" href="#module-pyrado.utils.nn_layers" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.utils.nn_layers.IndiNonlinLayer">
<em class="property">class </em><code class="sig-name descname">IndiNonlinLayer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_features</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">nonlin</span><span class="p">:</span> <span class="n"><span class="p">[</span>typing.Callable<span class="p">, </span>typing.Sequence<span class="p">[</span>typing.Callable<span class="p">]</span><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">bias</span><span class="p">:</span> <span class="n">bool</span></em>, <em class="sig-param"><span class="n">weight</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">True</span></em>, <em class="sig-param"><span class="n">init_weight</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">init_bias</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/nn_layers.html#IndiNonlinLayer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.nn_layers.IndiNonlinLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Layer subtracts a bias from the input, multiplies the result with a strictly positive scaling factor, and then
applies the provided nonlinearity. If a list of nonlinearities is provided, every dimension will be processed
separately. The scaling and the bias are learnable parameters.</p>
<dl class="py method">
<dt id="pyrado.utils.nn_layers.IndiNonlinLayer.extra_repr">
<code class="sig-name descname">extra_repr</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="_modules/pyrado/utils/nn_layers.html#IndiNonlinLayer.extra_repr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.nn_layers.IndiNonlinLayer.extra_repr" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the extra representation of the module</p>
<p>To print customized extra information, you should reimplement
this method in your own modules. Both single-line and multi-line
strings are acceptable.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.utils.nn_layers.IndiNonlinLayer.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/utils/nn_layers.html#IndiNonlinLayer.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.nn_layers.IndiNonlinLayer.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.utils.nn_layers.MirrConv1d">
<em class="property">class </em><code class="sig-name descname">MirrConv1d</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_channels</span></em>, <em class="sig-param"><span class="n">out_channels</span></em>, <em class="sig-param"><span class="n">kernel_size</span></em>, <em class="sig-param"><span class="n">stride</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">padding</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">dilation</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">groups</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">bias</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">padding_mode</span><span class="o">=</span><span class="default_value">'zeros'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/nn_layers.html#MirrConv1d"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.nn_layers.MirrConv1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.conv._ConvNd</span></code></p>
<p>Overriding <cite>Conv1d</cite> module implementation from PyTorch 1.4 to re-use parts of the convolution weights by mirroring
the first half of the kernel (along the columns). This way we can save (close to) half of the parameters, under
the assumption that we have a kernel that obeys this kind of symmetry.
The biases are left unchanged.</p>
<dl class="py method">
<dt id="pyrado.utils.nn_layers.MirrConv1d.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/utils/nn_layers.html#MirrConv1d.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.nn_layers.MirrConv1d.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.utils.nn_layers.PositiveScaleLayer">
<em class="property">class </em><code class="sig-name descname">PositiveScaleLayer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_features</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">init_weight</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/nn_layers.html#PositiveScaleLayer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.nn_layers.PositiveScaleLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Layer which scales (strictly positive) the input using a learnable scaling factor</p>
<dl class="py method">
<dt id="pyrado.utils.nn_layers.PositiveScaleLayer.extra_repr">
<code class="sig-name descname">extra_repr</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="_modules/pyrado/utils/nn_layers.html#PositiveScaleLayer.extra_repr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.nn_layers.PositiveScaleLayer.extra_repr" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the extra representation of the module</p>
<p>To print customized extra information, you should reimplement
this method in your own modules. Both single-line and multi-line
strings are acceptable.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.utils.nn_layers.PositiveScaleLayer.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/utils/nn_layers.html#PositiveScaleLayer.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.nn_layers.PositiveScaleLayer.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.utils.nn_layers.ScaleLayer">
<em class="property">class </em><code class="sig-name descname">ScaleLayer</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">in_features</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">init_weight</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">1.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/nn_layers.html#ScaleLayer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.nn_layers.ScaleLayer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>Layer which scales the output of the input using a learnable scaling factor</p>
<dl class="py method">
<dt id="pyrado.utils.nn_layers.ScaleLayer.extra_repr">
<code class="sig-name descname">extra_repr</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="_modules/pyrado/utils/nn_layers.html#ScaleLayer.extra_repr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.nn_layers.ScaleLayer.extra_repr" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the extra representation of the module</p>
<p>To print customized extra information, you should reimplement
this method in your own modules. Both single-line and multi-line
strings are acceptable.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.utils.nn_layers.ScaleLayer.forward">
<code class="sig-name descname">forward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">inp</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/utils/nn_layers.html#ScaleLayer.forward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.nn_layers.ScaleLayer.forward" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the computation performed at every call.</p>
<p>Should be overridden by all subclasses.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Although the recipe for forward pass needs to be defined within
this function, one should call the <code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code> instance afterwards
instead of this since the former takes care of running the
registered hooks while the latter silently ignores them.</p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.utils.normalizing">
<span id="normalizing"></span><h2>normalizing<a class="headerlink" href="#module-pyrado.utils.normalizing" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.utils.normalizing.RunningNormalizer">
<em class="property">class </em><code class="sig-name descname">RunningNormalizer</code><a class="reference internal" href="_modules/pyrado/utils/normalizing.html#RunningNormalizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.normalizing.RunningNormalizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Normalizes given data based on the history of observed data, such that all outputs are in range [-1, 1]</p>
<dl class="py method">
<dt id="pyrado.utils.normalizing.RunningNormalizer.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/normalizing.html#RunningNormalizer.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.normalizing.RunningNormalizer.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset internal variables.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.normalizing.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param">x: [&lt;class 'numpy.ndarray'&gt;, &lt;class 'torch.Tensor'&gt;], axis: int = -1, order: int = 1, eps: float = 1e-08) -&gt; (&lt;class 'numpy.ndarray'&gt;, &lt;class 'torch.Tensor'&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/normalizing.html#normalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.normalizing.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Normalize a numpy <cite>ndarray</cite> or a PyTroch <cite>Tensor</cite> without changing the input.
Choosing <cite>axis=1</cite> and <cite>norm_order=1</cite> makes all columns of sum to 1.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – input to normalize</p></li>
<li><p><strong>axis</strong> – axis of the array to normalize along</p></li>
<li><p><strong>order</strong> – order of the norm (e.g., L_1 norm: absolute values, L_2 norm: quadratic values)</p></li>
<li><p><strong>eps</strong> – lower bound on the norm, to avoid division by zero</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>normalized array</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrado.utils.optimizers">
<span id="optimizers"></span><h2>optimizers<a class="headerlink" href="#module-pyrado.utils.optimizers" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.utils.optimizers.GSS">
<em class="property">class </em><code class="sig-name descname">GSS</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">params</span></em>, <em class="sig-param"><span class="n">param_min</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">param_max</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/optimizers.html#GSS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.optimizers.GSS" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.optim.optimizer.Optimizer</span></code></p>
<p>Golden Section Search optimizer</p>
<dl class="py method">
<dt id="pyrado.utils.optimizers.GSS.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/optimizers.html#GSS.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.optimizers.GSS.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.utils.optimizers.GSS.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">closure</span><span class="p">:</span> <span class="n">collections.abc.Callable</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/optimizers.html#GSS.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.optimizers.GSS.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Performs a single optimization step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>closure</strong> – a closure that reevaluates the model and returns the loss</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>accumulated loss for all parameter groups after the parameter update</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-pyrado.utils.properties">
<span id="properties"></span><h2>properties<a class="headerlink" href="#module-pyrado.utils.properties" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.utils.properties.Delegate">
<em class="property">class </em><code class="sig-name descname">Delegate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">delegate</span></em>, <em class="sig-param"><span class="n">attr</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/properties.html#Delegate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.properties.Delegate" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Delegate to a class member object.</p>
<p>Example:
class Foo:</p>
<blockquote>
<div><dl class="simple">
<dt>def __init__(self, bar):</dt><dd><p>self.bar = bar</p>
</dd>
</dl>
<p>baz = Delegate(“bar”)</p>
</div></blockquote>
<p>foo = Foo()
foo.baz &lt;=&gt; foo.bar.baz</p>
</dd></dl>

<dl class="py class">
<dt id="pyrado.utils.properties.ReadOnlyDelegate">
<em class="property">class </em><code class="sig-name descname">ReadOnlyDelegate</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">delegate</span></em>, <em class="sig-param"><span class="n">attr</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/properties.html#ReadOnlyDelegate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.properties.ReadOnlyDelegate" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Delegate to a class member object in a read-only way.</p>
<p>Example:
class Foo:</p>
<blockquote>
<div><dl class="simple">
<dt>def __init__(self, bar):</dt><dd><p>self.bar = bar</p>
</dd>
</dl>
<p>baz = Delegate(“bar”)</p>
</div></blockquote>
<p>foo = Foo()
foo.baz &lt;=&gt; foo.bar.baz</p>
</dd></dl>

<dl class="py class">
<dt id="pyrado.utils.properties.cached_property">
<em class="property">class </em><code class="sig-name descname">cached_property</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">func</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/properties.html#cached_property"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.properties.cached_property" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Decorator that turns a function into a cached property.
When the property is first accessed, the function is called to compute the value. Later calls use the cached value.
.. note:: Requires a <cite>__dict__</cite> field, so it won’t work on named tuples.</p>
</dd></dl>

</div>
<div class="section" id="module-pyrado.utils.standardizing">
<span id="standardizing"></span><h2>standardizing<a class="headerlink" href="#module-pyrado.utils.standardizing" title="Permalink to this headline">¶</a></h2>
<p>Only tested for 1-dim inputs, e.g. time series of rewards.</p>
<dl class="py class">
<dt id="pyrado.utils.standardizing.RunningStandardizer">
<em class="property">class </em><code class="sig-name descname">RunningStandardizer</code><a class="reference internal" href="_modules/pyrado/utils/standardizing.html#RunningStandardizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.standardizing.RunningStandardizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Implementation of Welford’s online algorithm</p>
<dl class="py method">
<dt id="pyrado.utils.standardizing.RunningStandardizer.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/utils/standardizing.html#RunningStandardizer.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.standardizing.RunningStandardizer.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset internal variables.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.utils.standardizing.Standardizer">
<em class="property">class </em><code class="sig-name descname">Standardizer</code><a class="reference internal" href="_modules/pyrado/utils/standardizing.html#Standardizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.standardizing.Standardizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A stateful standardizer that remembers the mean and standard deviation for later un-standardization</p>
<dl class="py method">
<dt id="pyrado.utils.standardizing.Standardizer.standardize">
<code class="sig-name descname">standardize</code><span class="sig-paren">(</span><em class="sig-param">data: [&lt;class 'numpy.ndarray'&gt;, &lt;class 'torch.Tensor'&gt;], eps: float = 1e-08</em><span class="sig-paren">)</span> &#x2192; [&lt;class ‘numpy.ndarray’&gt;, &lt;class ‘torch.Tensor’&gt;]<a class="reference internal" href="_modules/pyrado/utils/standardizing.html#Standardizer.standardize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.standardizing.Standardizer.standardize" title="Permalink to this definition">¶</a></dt>
<dd><p>Standardize the input data to make it <span class="math notranslate nohighlight">\(~ N(0, 1)\)</span> and store the input’s mean and standard deviation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – input ndarray or Tensor</p></li>
<li><p><strong>eps</strong> – factor for numerical stability</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>standardized ndarray or Tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.utils.standardizing.Standardizer.unstandardize">
<code class="sig-name descname">unstandardize</code><span class="sig-paren">(</span><em class="sig-param">data: [&lt;class 'numpy.ndarray'&gt;, &lt;class 'torch.Tensor'&gt;]</em><span class="sig-paren">)</span> &#x2192; [&lt;class ‘numpy.ndarray’&gt;, &lt;class ‘torch.Tensor’&gt;]<a class="reference internal" href="_modules/pyrado/utils/standardizing.html#Standardizer.unstandardize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.standardizing.Standardizer.unstandardize" title="Permalink to this definition">¶</a></dt>
<dd><p>Revert the previous standardization of the input data to make it <span class="math notranslate nohighlight">\(~ N(\mu, \sigma)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – input ndarray or Tensor</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>un-standardized ndarray or Tensor</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.standardizing.standardize">
<code class="sig-name descname">standardize</code><span class="sig-paren">(</span><em class="sig-param">data: [&lt;class 'numpy.ndarray'&gt;, &lt;class 'torch.Tensor'&gt;], eps: float = 1e-08</em><span class="sig-paren">)</span> &#x2192; [&lt;class ‘numpy.ndarray’&gt;, &lt;class ‘torch.Tensor’&gt;]<a class="reference internal" href="_modules/pyrado/utils/standardizing.html#standardize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.standardizing.standardize" title="Permalink to this definition">¶</a></dt>
<dd><p>Standardize the input data to make it <span class="math notranslate nohighlight">\(~ N(0, 1)\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> – input ndarray or Tensor</p></li>
<li><p><strong>eps</strong> – factor for numerical stability</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>standardized ndarray or Tensor</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrado.utils.tensor">
<span id="tensor"></span><h2>tensor<a class="headerlink" href="#module-pyrado.utils.tensor" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyrado.utils.tensor.atleast_2D">
<code class="sig-name descname">atleast_2D</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/utils/tensor.html#atleast_2D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.tensor.atleast_2D" title="Permalink to this definition">¶</a></dt>
<dd><p>Mimic the numpy function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> – any tensor</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an at least 2-dim tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.tensor.atleast_3D">
<code class="sig-name descname">atleast_3D</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/utils/tensor.html#atleast_3D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.tensor.atleast_3D" title="Permalink to this definition">¶</a></dt>
<dd><p>Mimic the numpy function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> – any tensor</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>an at least 3-dim tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.tensor.insert_tensor_col">
<code class="sig-name descname">insert_tensor_col</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">x</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">idx</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">col</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/utils/tensor.html#insert_tensor_col"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.tensor.insert_tensor_col" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert a column into a PyTorch Tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> – original tensor</p></li>
<li><p><strong>idx</strong> – column index where to insert the column</p></li>
<li><p><strong>col</strong> – tensor to insert</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tensor with new column at index idx</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.tensor.stack_tensor_dict_list">
<code class="sig-name descname">stack_tensor_dict_list</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tensor_dict_list</span><span class="p">:</span> <span class="n">list</span></em><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="_modules/pyrado/utils/tensor.html#stack_tensor_dict_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.tensor.stack_tensor_dict_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Stack a list of dictionaries of {tensors or dict of tensors}.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tensor_dict_list</strong> – a list of dicts of {tensors or dict of tensors}.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a dict of {stacked tensors or dict of stacked tensors}</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.tensor.stack_tensor_list">
<code class="sig-name descname">stack_tensor_list</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">tensor_list</span><span class="p">:</span> <span class="n">list</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/utils/tensor.html#stack_tensor_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.tensor.stack_tensor_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience function for stacking a list of tensors</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tensor_list</strong> – list of tensors to stack (along a new dim)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tensor of at least 1-dim</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrado.utils">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyrado.utils" title="Permalink to this headline">¶</a></h2>
<dl class="py function">
<dt id="pyrado.utils.get_class_name">
<code class="sig-name descname">get_class_name</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="_modules/pyrado/utils.html#get_class_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.get_class_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Get an arbitrary objects name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obj</strong> – any object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>name of the class of the given object</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.utils.issequence">
<code class="sig-name descname">issequence</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obj</span></em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/pyrado/utils.html#issequence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.utils.issequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if an object is a sequence / an iterable.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using against <cite>isinstance(obj, collections.Sequence)</cite> yields <cite>False</cite> for some types like <cite>set</cite> and <cite>dict</cite>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obj</strong> – any object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>flag if the object is a sequence / an iterable</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tests.html" class="btn btn-neutral float-right" title="tests" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="tasks.html" class="btn btn-neutral float-left" title="tasks" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>