

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>algorithms &mdash; Pyrado 0.2 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="domain_randomization" href="domain_randomization.html" />
    <link rel="prev" title="How to create an algorithm" href="examples/3_algorithm.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> Pyrado
          

          
          </a>

          
            
            
              <div class="version">
                0.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/1_experiment.html">How to run an experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/2_environment_wrappers.html">How to wrap an environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/3_algorithm.html">How to create an algorithm</a></li>
</ul>
<p class="caption"><span class="caption-text">Package Overview:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">algorithms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#a2c">a2c</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.actor_critic">actor_critic</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adr">adr</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.adr_discriminator">adr_discriminator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.advantage">advantage</a></li>
<li class="toctree-l2"><a class="reference internal" href="#arpl">arpl</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.base">base</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bayrn">bayrn</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cem">cem</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dql">dql</a></li>
<li class="toctree-l2"><a class="reference internal" href="#epopt">epopt</a></li>
<li class="toctree-l2"><a class="reference internal" href="#hc">hc</a></li>
<li class="toctree-l2"><a class="reference internal" href="#nes">nes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#parameter-exploring">parameter_exploring</a></li>
<li class="toctree-l2"><a class="reference internal" href="#pepg">pepg</a></li>
<li class="toctree-l2"><a class="reference internal" href="#power">power</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ppo">ppo</a></li>
<li class="toctree-l2"><a class="reference internal" href="#predefined-lqr">predefined_lqr</a></li>
<li class="toctree-l2"><a class="reference internal" href="#reps">reps</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sac">sac</a></li>
<li class="toctree-l2"><a class="reference internal" href="#simopt">simopt</a></li>
<li class="toctree-l2"><a class="reference internal" href="#spota">spota</a></li>
<li class="toctree-l2"><a class="reference internal" href="#svpg">svpg</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sysid-as-rl">sysid_as_rl</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms.utils">utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-pyrado.algorithms">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="domain_randomization.html">domain_randomization</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.html">environments</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.pysim.html">pysim</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.mujoco.html">mujoco</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.rcspysim.html">rcspysim</a></li>
<li class="toctree-l1"><a class="reference internal" href="environments.quanser.html">quanser</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment_wrappers.html">environment_wrappers</a></li>
<li class="toctree-l1"><a class="reference internal" href="exploration.html">exploration</a></li>
<li class="toctree-l1"><a class="reference internal" href="logger.html">logger</a></li>
<li class="toctree-l1"><a class="reference internal" href="plotting.html">plotting</a></li>
<li class="toctree-l1"><a class="reference internal" href="policies.html">policies</a></li>
<li class="toctree-l1"><a class="reference internal" href="sampling.html">sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="spaces.html">spaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="tasks.html">tasks</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils.html">utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="tests.html">tests</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Pyrado</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>algorithms</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/algorithms.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="algorithms">
<h1>algorithms<a class="headerlink" href="#algorithms" title="Permalink to this headline">¶</a></h1>
<div class="section" id="a2c">
<h2>a2c<a class="headerlink" href="#a2c" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyrado.algorithms.actor_critic">
<span id="actor-critic"></span><h2>actor_critic<a class="headerlink" href="#module-pyrado.algorithms.actor_critic" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.actor_critic.ActorCritic">
<em class="property">class </em><code class="sig-name descname">ActorCritic</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env</span><span class="p">:</span> <span class="n"><a class="reference internal" href="environments.html#pyrado.environments.base.Env" title="pyrado.environments.base.Env">pyrado.environments.base.Env</a></span></em>, <em class="sig-param"><span class="n">actor</span><span class="p">:</span> <span class="n"><a class="reference internal" href="policies.html#pyrado.policies.base.Policy" title="pyrado.policies.base.Policy">pyrado.policies.base.Policy</a></span></em>, <em class="sig-param"><span class="n">critic</span><span class="p">:</span> <span class="n"><a class="reference internal" href="#pyrado.algorithms.advantage.GAE" title="pyrado.algorithms.advantage.GAE">pyrado.algorithms.advantage.GAE</a></span></em>, <em class="sig-param"><span class="n">save_dir</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">max_iter</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">logger</span><span class="p">:</span> <span class="n"><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger">pyrado.logger.step.StepLogger</a></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/actor_critic.html#ActorCritic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.actor_critic.ActorCritic" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#pyrado.algorithms.base.Algorithm" title="pyrado.algorithms.base.Algorithm"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.algorithms.base.Algorithm</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code></p>
<p>Base class of all actor critic algorithms</p>
<dl class="py method">
<dt id="pyrado.algorithms.actor_critic.ActorCritic.critic">
<em class="property">property </em><code class="sig-name descname">critic</code><a class="headerlink" href="#pyrado.algorithms.actor_critic.ActorCritic.critic" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the critic.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.actor_critic.ActorCritic.expl_strat">
<em class="property">property </em><code class="sig-name descname">expl_strat</code><a class="headerlink" href="#pyrado.algorithms.actor_critic.ActorCritic.expl_strat" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the algorithm’s exploration strategy.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.actor_critic.ActorCritic.init_modules">
<code class="sig-name descname">init_modules</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">warmstart</span><span class="p">:</span> <span class="n">bool</span></em>, <em class="sig-param"><span class="n">suffix</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">''</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/actor_critic.html#ActorCritic.init_modules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.actor_critic.ActorCritic.init_modules" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the algorithm’s learnable modules, e.g. a policy or value function.
Overwrite this method if the algorithm uses a learnable module aside the policy, e.g. a value function.
This method is similar to <cite>load_snapshot()</cite> which also loads additional algorithm members like environments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>warmstart</strong> – if <cite>True</cite>, the algorithm starts learning with an initialization. This can either be the a
fixed parameter vector, or the results of the previous iteration</p></li>
<li><p><strong>suffix</strong> – keyword for <cite>meta_info</cite> when loading from previous iteration</p></li>
<li><p><strong>kwargs</strong> – keyword arguments for initialization, e.g. <cite>policy_param_init</cite> or <cite>valuefcn_param_init</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.actor_critic.ActorCritic.load_snapshot">
<code class="sig-name descname">load_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">load_dir</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/actor_critic.html#ActorCritic.load_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.actor_critic.ActorCritic.load_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to load the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_dir</strong> – explicit directory to load from, if <cite>None</cite> (default) <cite>self._save_dir</cite> is used</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.actor_critic.ActorCritic.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seed</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/actor_critic.html#ActorCritic.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.actor_critic.ActorCritic.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.actor_critic.ActorCritic.save_snapshot">
<code class="sig-name descname">save_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/actor_critic.html#ActorCritic.save_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.actor_critic.ActorCritic.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.actor_critic.ActorCritic.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/actor_critic.html#ActorCritic.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.actor_critic.ActorCritic.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.actor_critic.ActorCritic.update">
<em class="property">abstract </em><code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rollouts</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a><span class="p">]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/actor_critic.html#ActorCritic.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.actor_critic.ActorCritic.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the actor and critic parameters from the given batch of rollouts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>rollouts</strong> – batch of rollouts</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="adr">
<h2>adr<a class="headerlink" href="#adr" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyrado.algorithms.adr_discriminator">
<span id="adr-discriminator"></span><h2>adr_discriminator<a class="headerlink" href="#module-pyrado.algorithms.adr_discriminator" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.adr_discriminator.RewardGenerator">
<em class="property">class </em><code class="sig-name descname">RewardGenerator</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">env_spec</span><span class="p">:</span> <span class="n"><a class="reference internal" href="utils.html#pyrado.utils.data_types.EnvSpec" title="pyrado.utils.data_types.EnvSpec">pyrado.utils.data_types.EnvSpec</a></span></em>, <em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span></em>, <em class="sig-param"><span class="n">reward_multiplier</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">lr</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">0.003</span></em>, <em class="sig-param"><span class="n">logger</span><span class="p">:</span> <span class="n"><a class="reference internal" href="logger.html#pyrado.logger.step.StepLogger" title="pyrado.logger.step.StepLogger">pyrado.logger.step.StepLogger</a></span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">device</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'cpu'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/adr_discriminator.html#RewardGenerator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.adr_discriminator.RewardGenerator" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for generating the discriminator rewards in ADR. Generates a reward using a trained discriminator network.</p>
<dl class="py method">
<dt id="pyrado.algorithms.adr_discriminator.RewardGenerator.get_reward">
<code class="sig-name descname">get_reward</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">traj</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/adr_discriminator.html#RewardGenerator.get_reward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.adr_discriminator.RewardGenerator.get_reward" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.adr_discriminator.RewardGenerator.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">reference_trajectory</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em>, <em class="sig-param"><span class="n">randomized_trajectory</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em>, <em class="sig-param"><span class="n">num_epoch</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/algorithms/adr_discriminator.html#RewardGenerator.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.adr_discriminator.RewardGenerator.train" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyrado.algorithms.adr_discriminator.convert_step_sequence">
<code class="sig-name descname">convert_step_sequence</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">trajectory</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/adr_discriminator.html#convert_step_sequence"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.adr_discriminator.convert_step_sequence" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a StepSequence to a Tensor which can be fed through a Network</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>trajectory</strong> – A step sequence containing a trajectory</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A Tensor containing the trajectory</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms.advantage">
<span id="advantage"></span><h2>advantage<a class="headerlink" href="#module-pyrado.algorithms.advantage" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.advantage.GAE">
<em class="property">class </em><code class="sig-name descname">GAE</code><span class="sig-paren">(</span><em class="sig-param">value_fcn: [&lt;class 'torch.nn.modules.module.Module'&gt;, &lt;class 'pyrado.policies.base.Policy'&gt;], gamma: float = 0.99, lamda: float = 0.95, num_epoch: int = 10, batch_size: int = 64, standardize_adv: bool = True, standardizer: [None, &lt;class 'pyrado.utils.standardizing.RunningStandardizer'&gt;] = None, max_grad_norm: float = None, lr: float = 0.0005, lr_scheduler=None, lr_scheduler_hparam: [&lt;class 'dict'&gt;, None] = None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/advantage.html#GAE"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.advantage.GAE" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="logger.html#pyrado.logger.step.LoggerAware" title="pyrado.logger.step.LoggerAware"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.logger.step.LoggerAware</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">torch.nn.modules.module.Module</span></code></p>
<p>General Advantage Estimation (GAE)</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>[1] J. Schulmann, P. Moritz, S. Levine, M. Jordan, P. Abbeel, ‘High-Dimensional Continuous Control Using
Generalized Advantage Estimation’, ICLR 2016</p>
</div>
<dl class="py method">
<dt id="pyrado.algorithms.advantage.GAE.gae">
<code class="sig-name descname">gae</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">concat_ros</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em>, <em class="sig-param"><span class="n">v_pred</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">requires_grad</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/algorithms/advantage.html#GAE.gae"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.advantage.GAE.gae" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the generalized advantage estimation as described in [1].</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>concat_ros</strong> – concatenated rollouts (sequence of steps from potentially different rollouts)</p></li>
<li><p><strong>v_pred</strong> – state-value predictions if already computed, else pass None</p></li>
<li><p><strong>requires_grad</strong> – is the gradient required</p></li>
</ul>
</dd>
<dt class="field-even">Return adv</dt>
<dd class="field-even"><p>tensor of advantages</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.advantage.GAE.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/advantage.html#GAE.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.advantage.GAE.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the advantage estimator to it’s initial state.
The default implementation resets the learning rate scheduler if there is one.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.advantage.GAE.tdlamda_returns">
<code class="sig-name descname">tdlamda_returns</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">v_pred</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">adv</span><span class="p">:</span> <span class="n">torch.Tensor</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">concat_ros</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/algorithms/advantage.html#GAE.tdlamda_returns"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.advantage.GAE.tdlamda_returns" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the TD(<span class="math notranslate nohighlight">\(\lambda\)</span>) returns based on the predictions of the network (introduces a bias).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v_pred</strong> – state-value predictions if already computed, pass <cite>None</cite> to compute form given rollouts</p></li>
<li><p><strong>adv</strong> – advantages if already computed, pass <cite>None</cite> to compute form given rollouts</p></li>
<li><p><strong>concat_ros</strong> – rollouts to compute predicted values and advantages from if they are not provided</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>exponentially weighted returns based on the value function estimator</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.advantage.GAE.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">rollouts</span><span class="p">:</span> <span class="n">Sequence<span class="p">[</span><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a><span class="p">]</span></span></em>, <em class="sig-param"><span class="n">use_empirical_returns</span><span class="p">:</span> <span class="n">bool</span> <span class="o">=</span> <span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/advantage.html#GAE.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.advantage.GAE.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Adapt the parameters of the advantage function estimator, minimizing the MSE loss for the given samples.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rollouts</strong> – batch of rollouts</p></li>
<li><p><strong>use_empirical_returns</strong> – use the return from the rollout (True) or the ones from the V-fcn (False)</p></li>
</ul>
</dd>
<dt class="field-even">Return adv</dt>
<dd class="field-even"><p>tensor of advantages after V-function updates</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.advantage.GAE.value_fcn">
<em class="property">property </em><code class="sig-name descname">value_fcn</code><a class="headerlink" href="#pyrado.algorithms.advantage.GAE.value_fcn" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the value function approximator.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.advantage.GAE.values">
<code class="sig-name descname">values</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">concat_ros</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="_modules/pyrado/algorithms/advantage.html#GAE.values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.advantage.GAE.values" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the states’ values for all observations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>concat_ros</strong> – concatenated rollouts</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>states’ values</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="arpl">
<h2>arpl<a class="headerlink" href="#arpl" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyrado.algorithms.base">
<span id="base"></span><h2>base<a class="headerlink" href="#module-pyrado.algorithms.base" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.base.Algorithm">
<em class="property">class </em><code class="sig-name descname">Algorithm</code><span class="sig-paren">(</span><em class="sig-param">save_dir: str, max_iter: int, policy: [&lt;class 'pyrado.policies.base.Policy'&gt;, None], logger: pyrado.logger.step.StepLogger = None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">abc.ABC</span></code>, <a class="reference internal" href="logger.html#pyrado.logger.step.LoggerAware" title="pyrado.logger.step.LoggerAware"><code class="xref py py-class docutils literal notranslate"><span class="pre">pyrado.logger.step.LoggerAware</span></code></a></p>
<p>Base class of all algorithms in Pyrado
Algorithms specify the way how the policy is updated as well as the exploration strategy used to acquire samples.</p>
<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.clip_grad">
<em class="property">static </em><code class="sig-name descname">clip_grad</code><span class="sig-paren">(</span><em class="sig-param">module: torch.nn.modules.module.Module, max_grad_norm: [&lt;class 'float'&gt;, None]</em><span class="sig-paren">)</span> &#x2192; float<a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.clip_grad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.clip_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Clip all gradients of the provided Module (e.g., a policy or an advantage estimator) by their L2 norm value.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The gradient clipping has to be applied between loss.backward() and optimizer.step()</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>module</strong> – Module containing parameters</p></li>
<li><p><strong>max_grad_norm</strong> – maximum L2 norm for the gradient</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>total norm of the parameters (viewed as a single vector)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.curr_iter">
<em class="property">property </em><code class="sig-name descname">curr_iter</code><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.curr_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current iteration counter.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.expl_strat">
<em class="property">property </em><code class="sig-name descname">expl_strat</code><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.expl_strat" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the algorithm’s exploration strategy.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.init_modules">
<code class="sig-name descname">init_modules</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">warmstart</span><span class="p">:</span> <span class="n">bool</span></em>, <em class="sig-param"><span class="n">suffix</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">''</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.init_modules"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.init_modules" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the algorithm’s learnable modules, e.g. a policy or value function.
Overwrite this method if the algorithm uses a learnable module aside the policy, e.g. a value function.
This method is similar to <cite>load_snapshot()</cite> which also loads additional algorithm members like environments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>warmstart</strong> – if <cite>True</cite>, the algorithm starts learning with an initialization. This can either be the a
fixed parameter vector, or the results of the previous iteration</p></li>
<li><p><strong>suffix</strong> – keyword for <cite>meta_info</cite> when loading from previous iteration</p></li>
<li><p><strong>kwargs</strong> – keyword arguments for initialization, e.g. <cite>policy_param_init</cite> or <cite>valuefcn_param_init</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.base.Algorithm.iteration_key">
<code class="sig-name descname">iteration_key</code><em class="property">: str</em><em class="property"> = 'iteration'</em><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.iteration_key" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.load_snapshot">
<code class="sig-name descname">load_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">load_dir</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.load_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.load_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to load the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_dir</strong> – explicit directory to load from, if <cite>None</cite> (default) <cite>self._save_dir</cite> is used</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.make_snapshot">
<code class="sig-name descname">make_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">curr_avg_ret</span><span class="p">:</span> <span class="n">float</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.make_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.make_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a snapshot of the training progress.
This method is called from the subclasses and delegates to the custom method <cite>save_snapshot()</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>curr_avg_ret</strong> – current average return used for the snapshot_mode ‘best’ to trigger <cite>save_snapshot()</cite></p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.max_iter">
<em class="property">property </em><code class="sig-name descname">max_iter</code><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.max_iter" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the maximum number of iterations.</p>
</dd></dl>

<dl class="py attribute">
<dt id="pyrado.algorithms.base.Algorithm.name">
<code class="sig-name descname">name</code><em class="property">: str</em><em class="property"> = None</em><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.name" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.policy">
<em class="property">property </em><code class="sig-name descname">policy</code><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.policy" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the algorithm’s policy.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">seed</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the algorithm to it’s initial state. This should NOT reset learned policy parameters.
By default, this resets the iteration count and the exploration strategy.
Be sure to call this function if you override it.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.save_dir">
<em class="property">property </em><code class="sig-name descname">save_dir</code><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.save_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the directory where the data is saved to.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.save_snapshot">
<code class="sig-name descname">save_snapshot</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.save_snapshot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.save_snapshot" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the algorithm information (e.g., environment, policy, ect.).
Subclasses should call the base method to save the policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a <cite>dict</cite> of information about the current iteration of the meta-algorithm</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.step">
<em class="property">abstract </em><code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a single iteration of the algorithm. This includes collecting the data, updating the parameters, and
adding the metrics of interest to the logger. Does not update the <cite>curr_iter</cite> attribute.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new highscore)</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.stopping_criterion_met">
<code class="sig-name descname">stopping_criterion_met</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.stopping_criterion_met"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.stopping_criterion_met" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if one of the algorithms (characteristic) stopping criterions is met.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function can be overwritten by the subclasses to implement custom stopping behavior.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>flag if one of the stopping criterion(s) is met</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">load_dir</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">snapshot_mode</span><span class="p">:</span> <span class="n">str</span> <span class="o">=</span> <span class="default_value">'latest'</span></em>, <em class="sig-param"><span class="n">seed</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em>, <em class="sig-param"><span class="n">meta_info</span><span class="p">:</span> <span class="n">dict</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.train" title="Permalink to this definition">¶</a></dt>
<dd><p>Train one/multiple policy/policies in a given environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>load_dir</strong> – if not <cite>None</cite> the training snapshot will be loaded from the given directory, i.e. the training
does not start from scratch</p></li>
<li><p><strong>snapshot_mode</strong> – determines when the snapshots are stored (e.g. on every iteration or on new high-score)</p></li>
<li><p><strong>seed</strong> – seed value for the random number generators, pass <cite>None</cite> for no seeding</p></li>
<li><p><strong>meta_info</strong> – is not <cite>None</cite> if this algorithm is run as a subroutine of a meta-algorithm,
contains a dict of information about the current iteration of the meta-algorithm</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.base.Algorithm.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span><span class="p">:</span> <span class="n">Any</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/base.html#Algorithm.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.base.Algorithm.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the policy’s (and value functions’) parameters based on the collected rollout data.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="bayrn">
<h2>bayrn<a class="headerlink" href="#bayrn" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="cem">
<h2>cem<a class="headerlink" href="#cem" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="dql">
<h2>dql<a class="headerlink" href="#dql" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="epopt">
<h2>epopt<a class="headerlink" href="#epopt" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="hc">
<h2>hc<a class="headerlink" href="#hc" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="nes">
<h2>nes<a class="headerlink" href="#nes" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="parameter-exploring">
<h2>parameter_exploring<a class="headerlink" href="#parameter-exploring" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="pepg">
<h2>pepg<a class="headerlink" href="#pepg" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="power">
<h2>power<a class="headerlink" href="#power" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="ppo">
<h2>ppo<a class="headerlink" href="#ppo" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="predefined-lqr">
<h2>predefined_lqr<a class="headerlink" href="#predefined-lqr" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="reps">
<h2>reps<a class="headerlink" href="#reps" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="sac">
<h2>sac<a class="headerlink" href="#sac" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="simopt">
<h2>simopt<a class="headerlink" href="#simopt" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="spota">
<h2>spota<a class="headerlink" href="#spota" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="svpg">
<h2>svpg<a class="headerlink" href="#svpg" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="sysid-as-rl">
<h2>sysid_as_rl<a class="headerlink" href="#sysid-as-rl" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-pyrado.algorithms.utils">
<span id="utils"></span><h2>utils<a class="headerlink" href="#module-pyrado.algorithms.utils" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="pyrado.algorithms.utils.ActionStatistics">
<em class="property">class </em><code class="sig-name descname">ActionStatistics</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">act_distr</span><span class="p">:</span> <span class="n">torch.distributions.distribution.Distribution</span></em>, <em class="sig-param"><span class="n">log_probs</span><span class="p">:</span> <span class="n">torch.Tensor</span></em>, <em class="sig-param"><span class="n">entropy</span><span class="p">:</span> <span class="n">torch.Tensor</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/utils.html#ActionStatistics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.ActionStatistics" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p>act_distr: probability distribution at the given policy output values
log_probs: <span class="math notranslate nohighlight">\(\log (p(act|obs, hidden))\)</span> if hidden exists, else <span class="math notranslate nohighlight">\(\log (p(act|obs))\)</span>
entropy: entropy of the action distribution</p>
<dl class="py method">
<dt id="pyrado.algorithms.utils.ActionStatistics.act_distr">
<em class="property">property </em><code class="sig-name descname">act_distr</code><a class="headerlink" href="#pyrado.algorithms.utils.ActionStatistics.act_distr" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 0</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.utils.ActionStatistics.entropy">
<em class="property">property </em><code class="sig-name descname">entropy</code><a class="headerlink" href="#pyrado.algorithms.utils.ActionStatistics.entropy" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 2</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.utils.ActionStatistics.log_probs">
<em class="property">property </em><code class="sig-name descname">log_probs</code><a class="headerlink" href="#pyrado.algorithms.utils.ActionStatistics.log_probs" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for field number 1</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt id="pyrado.algorithms.utils.ReplayMemory">
<em class="property">class </em><code class="sig-name descname">ReplayMemory</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">capacity</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/utils.html#ReplayMemory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.ReplayMemory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Base class for storing step transitions</p>
<dl class="py method">
<dt id="pyrado.algorithms.utils.ReplayMemory.avg_reward">
<code class="sig-name descname">avg_reward</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; float<a class="reference internal" href="_modules/pyrado/algorithms/utils.html#ReplayMemory.avg_reward"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.ReplayMemory.avg_reward" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the average reward for all steps stored in the replay memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>average reward</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.utils.ReplayMemory.isempty">
<em class="property">property </em><code class="sig-name descname">isempty</code><a class="headerlink" href="#pyrado.algorithms.utils.ReplayMemory.isempty" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the replay buffer is empty.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.utils.ReplayMemory.memory">
<em class="property">property </em><code class="sig-name descname">memory</code><a class="headerlink" href="#pyrado.algorithms.utils.ReplayMemory.memory" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the replay buffer.</p>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.utils.ReplayMemory.push">
<code class="sig-name descname">push</code><span class="sig-paren">(</span><em class="sig-param">ros: [&lt;class 'list'&gt;, &lt;class 'pyrado.sampling.step_sequence.StepSequence'&gt;], truncate_last: bool = True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/utils.html#ReplayMemory.push"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.ReplayMemory.push" title="Permalink to this definition">¶</a></dt>
<dd><p>Save a sequence of steps and drop of steps if the capacity is exceeded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ros</strong> – list of rollouts or one concatenated rollout</p></li>
<li><p><strong>truncate_last</strong> – remove the last step from each rollout, forwarded to <cite>StepSequence.concat</cite></p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.utils.ReplayMemory.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/utils.html#ReplayMemory.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.ReplayMemory.reset" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="pyrado.algorithms.utils.ReplayMemory.sample">
<code class="sig-name descname">sample</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">batch_size</span><span class="p">:</span> <span class="n">int</span></em><span class="sig-paren">)</span> &#x2192; tuple<a class="reference internal" href="_modules/pyrado/algorithms/utils.html#ReplayMemory.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.ReplayMemory.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample randomly from the replay memory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>batch_size</strong> – number of samples</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple of transition steps and associated next steps</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt id="pyrado.algorithms.utils.compute_action_statistics">
<code class="sig-name descname">compute_action_statistics</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">steps</span><span class="p">:</span> <span class="n"><a class="reference internal" href="sampling.html#pyrado.sampling.step_sequence.StepSequence" title="pyrado.sampling.step_sequence.StepSequence">pyrado.sampling.step_sequence.StepSequence</a></span></em>, <em class="sig-param"><span class="n">expl_strat</span><span class="p">:</span> <span class="n"><a class="reference internal" href="exploration.html#pyrado.exploration.stochastic_action.StochasticActionExplStrat" title="pyrado.exploration.stochastic_action.StochasticActionExplStrat">pyrado.exploration.stochastic_action.StochasticActionExplStrat</a></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="#pyrado.algorithms.utils.ActionStatistics" title="pyrado.algorithms.utils.ActionStatistics">pyrado.algorithms.utils.ActionStatistics</a><a class="reference internal" href="_modules/pyrado/algorithms/utils.html#compute_action_statistics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.compute_action_statistics" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action distribution from the exploration strategy, compute the log action probabilities and entropy
for the given rollout using the given exploration strategy.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Requires the exploration strategy to have a (most likely custom) <cite>evaluate()</cite> method.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>steps</strong> – recorded rollout data</p></li>
<li><p><strong>expl_strat</strong> – exploration strategy used to generate the data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>collected action statistics, see <cite>ActionStatistics</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.algorithms.utils.load_prefix_suffix">
<code class="sig-name descname">load_prefix_suffix</code><span class="sig-paren">(</span><em class="sig-param">obj, name: str, file_ext: str, load_dir: str, meta_info: [&lt;class 'dict'&gt;, None]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/utils.html#load_prefix_suffix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.load_prefix_suffix" title="Permalink to this definition">¶</a></dt>
<dd><p>Load an arbitrary object object using a prefix or suffix, depending on the meta information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> – object to load into</p></li>
<li><p><strong>name</strong> – name of the object for loading</p></li>
<li><p><strong>file_ext</strong> – file extension, e.g. ‘pt’ for policies</p></li>
<li><p><strong>load_dir</strong> – directory to load from</p></li>
<li><p><strong>meta_info</strong> – meta information that can contain a pre- and/or suffix for altering the name</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.algorithms.utils.save_prefix_suffix">
<code class="sig-name descname">save_prefix_suffix</code><span class="sig-paren">(</span><em class="sig-param">obj, name: str, file_ext: str, save_dir: str, meta_info: [&lt;class 'dict'&gt;, None]</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/utils.html#save_prefix_suffix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.save_prefix_suffix" title="Permalink to this definition">¶</a></dt>
<dd><p>Save an arbitrary object object using a prefix or suffix, depending on the meta information.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> – object to save</p></li>
<li><p><strong>name</strong> – name of the object for saving</p></li>
<li><p><strong>file_ext</strong> – file extension, e.g. ‘pt’ for policies</p></li>
<li><p><strong>save_dir</strong> – directory to save in</p></li>
<li><p><strong>meta_info</strong> – meta information that can contain a pre- and/or suffix for altering the name</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pyrado.algorithms.utils.until_thold_exceeded">
<code class="sig-name descname">until_thold_exceeded</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">thold</span><span class="p">:</span> <span class="n">float</span></em>, <em class="sig-param"><span class="n">max_iter</span><span class="p">:</span> <span class="n">int</span> <span class="o">=</span> <span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/pyrado/algorithms/utils.html#until_thold_exceeded"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pyrado.algorithms.utils.until_thold_exceeded" title="Permalink to this definition">¶</a></dt>
<dd><p>Designed to wrap a function and repeat it until the return value exceeds a threshold.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>thold</strong> – threshold</p></li>
<li><p><strong>max_iter</strong> – maximum number of iterations of the wrapped function, set to <cite>None</cite> to run the loop relentlessly</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>wrapped function</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-pyrado.algorithms">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-pyrado.algorithms" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="domain_randomization.html" class="btn btn-neutral float-right" title="domain_randomization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="examples/3_algorithm.html" class="btn btn-neutral float-left" title="How to create an algorithm" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>